self.importScripts("vendor/crypto-js.js");function t(d){if(!d)return null;var e=d.charAt(0);if("?"==e||"#"==e)d=d.substring(1);var a={};d.split("&").forEach(function(b){var c=b.indexOf("=");0>c?a[decodeURIComponent(b)]="":a[decodeURIComponent(b.substring(0,c))]=decodeURIComponent(b.substring(c+1))});return a}function u(){var d=t(window.location.search),e=t(window.location.hash);e&&(d=d?Object.assign(d,e):e);return d}
function v(d,e){var a=[],b;for(b in d)e?a.push(b.concat("=").concat(d[b])):a.push(encodeURIComponent(b).concat("=").concat(encodeURIComponent(d[b])));return 0<a.length?"?".concat(a.join("&")):""}function w(d){if(!d)return 0;var e=d.indexOf("-");if(0>e)return 0;e++;var a=d.indexOf("/",e);return a<=e?0:parseInt(d.slice(e,a),10)};function x(d){var e=CryptoJS.MD5(d);d=CryptoJS.kdf.OpenSSL.execute(d,8,4,e);d.iv.clamp();d.key.clamp();return d}function y(d){var e=Array(d.sigBytes);d=d.words;for(var a=0,b=0;b<d.length;b++){for(var c=d[b],f=a+4-1;f>=a;f--)f<e.length&&(e[f]=c&255),c>>=8;a+=4;if(a>=e.length)break}return e}
function z(){this.h=0;this.g=null;this.o=function(d,e){this.h=d;e&&e()};this.write=function(d,e){Array.isArray(d)?this.g=this.g?this.g.concat(d):d.concat():(this.g||(this.g=[]),this.g.push(d));e&&e()};this.cancel=function(d){d&&d(!1,!0)};this.i=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var d=0,e=0;e<this.g.length;e++)d+=this.g[e].byteLength;d=new Uint8Array(d);var a=0;for(e=0;e<this.g.length;++e){var b=this.g[e];b instanceof ArrayBuffer&&
(b=new Uint8Array(b));d.set(b,a);a+=b.byteLength}return d}return this.g};this.s=function(){var d=this.i();d instanceof Uint8Array||(d=new Uint8Array(d));return new Blob([d],{type:"application/octet-binary"})};this.download=function(d){var e=this.s();if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,d);else throw Error("Element for download is not specified.");};this.u=function(){return this.h}}
function A(d){this.blob=null;if(d.ia)if(d.ia instanceof Blob)this.blob=d.ia;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.m=1600;d.T&&(this.m=d.T);this.h=0;this.i=this.j=null;this.H=function(e,a){if(e){if(e>=this.g())throw Error("offset can not be bigger than input size.");this.h=e}this.j=new FileReader;this.j.onload=function(b){b=b.target.result;this.i&&this.i(b,this)}.bind(this);a&&a()};this.s=function(){return this.h};this.g=function(){return this.blob.size};
this.A=function(){return this.h>=this.g()};this.o=function(e){if(1!=this.j.readyState){var a=this.h;this.h=e?this.h+e:this.h+this.m;this.j.readAsArrayBuffer(this.blob.slice(a,this.h))}};this.O=function(){this.blob=this.j=null}}
function B(d){if(!d.qa)if(this.getSuperClass&&"Readable"==this.getSuperClass().name)this.super(void 0),this.h=1;else throw Error("writer must be specified in no stream mode.");this.s=this.B=null;this.u=!0;this.g=null;this.o=d.qa;this.iv=this.key=null;this.i=0;this.m=null;this.speed=this.A=this.j=0;d.za&&(this.u=!1);if(d.ea)"function"==typeof d.ea?this.g=d.ea():this.g=d.ea;else throw Error("reader must be specified.");if(d.ba){var e=null;e="string"==typeof d.ba?x(d.ba):d.ba;this.key=e.key;this.iv=
e.iv}else throw Error("keycfg must be specified.");this.start=function(a){if(a){if(this.u)throw Error("Can NOT set offset for encryption.");this.i=a;a-=a%16+16;0>a&&(a=0)}this.g.i=this.F.bind(this);this.g.H(a,function(){var b=16*Math.ceil((this.g.g()+1)/16);this.h||!this.o?this.D():this.o.o(b,this.D.bind(this))}.bind(this))};this.H=function(){Date.now()>this.j&&(this.speed=1E3*(this.g.s()-this.A)/(Date.now()-this.j+1E3),this.j=Date.now()+1E3,this.A=this.g.s());return this.speed};this._read=function(a){1==
this.h?this.h=2:3==this.h&&(this.g.A()?this.push(null):this.g.o(a))};this.push=function(a){return this.readable?(a&&!this.O?this.superCall("push",new Uint8Array(a)):this.superCall("push",a),!0):!1};this.D=function(){this.j=Date.now()+1E3;(this.A=this.i)?this.g.o(16):1==this.h?this.h=3:2==this.h?(this.h=3,this.push([])):this.g.o()};this.F=function(a){try{var b=new CryptoJS.lib.WordArray.init(a);if(!this.m){var c={iv:this.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};this.i&&(c.iv=b,b=null);
this.m=this.u?CryptoJS.algo.AES.createEncryptor(this.key,c):CryptoJS.algo.AES.createDecryptor(this.key,c)}if(b){var f=y(this.m.process(b));this.g.A()&&(f=f.concat(y(this.m.finalize())));if(this.i<this.g.s()){var h=this.i-(this.g.s()-a.byteLength);0<h&&(f=f.slice(h))}else f=null;this.h?this.push(f):f?this.o&&this.o.write(f,function(){this.g.A()?this.ka():this.B?this.B()?this.g.o():this.o.cancel(function(k,l){this.ka(k,l)}.bind(this)):this.g.o()}.bind(this)):this.g.o();f=null}else this.h?2==this.h?
(this.h=3,this.push([])):this.h=3:this.g.o()}catch(k){if(this.h)throw k;this.ka(k)}};this.ka=function(a,b){this.g&&(this.g.O(),this.g=null);this.s&&(a?this.s(a):this.s(!1,b))}};function C(){this.h=!0;this.g=null;this.o=!1;this.B=function(){var d=null;if(this.h)try{d=window.sessionStorage.getItem("login_state")}catch(e){this.h=!1,console.error(e)}return d};this.m=function(d){var e=this.B();return e&&d==e?!0:!1};this.i=function(d,e){if(this.h)try{return window.sessionStorage.setItem(d,e.toString()),!0}catch(a){this.h=!1,console.error(a)}return!1};this.s=function(){if(this.h)try{window.sessionStorage.removeItem("login_state")}catch(d){this.h=!1,console.error(d)}};this.u=function(){var d=
this.j("relay_url");return d?d:""};this.D=function(d){if(window.indexedDB){var e=window.indexedDB.open("zgayard1946");e.onerror=function(){if(d)d("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};e.onupgradeneeded=function(a){a.target.result.createObjectStore("settings",{keyPath:"key"})};e.onsuccess=function(a){var b=a.target.result;a=b.transaction("settings","readwrite");a.oncomplete=function(){b.close();d&&d()};a.objectStore("settings").getAll().onsuccess=
function(c){this.g={};c.target.result.forEach(function(f){this.g[f.key]=f.value}.bind(this));this.o=(c=this.g.drive)&&this.g[c]&&this.g[c].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(d)d("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};this.A=function(){var d=this.j("drive");return d&&(d=this.g[d])?d.refresh_token:null};this.H=function(d){if(this.g){var e=this.j("drive");d?(this.g[e]||(this.g[e]={}),this.g[e].refresh_token=
d):this.g[e]&&delete this.g[e].refresh_token}};this.F=function(d,e){window.indexedDB.open("zgayard1946").onsuccess=function(a){var b=a.target.result;a=b.transaction("settings","readwrite");a.oncomplete=function(){b.close();e&&e()};a=a.objectStore("settings");d&&d(a)}};this.j=function(d){return this.g&&this.g[d]?this.g[d]:null};this.saveData=function(d,e,a){this.g&&(this.g[d]=e);this.F(function(b){b.put({key:d,value:e})}.bind(this),a)}};var D={};function E(d,e,a){this.v=d;this.L=e;this.g=a}function F(d,e){this.O=null;this.sa=e;this.h=null;this.g=d;this.super||(this.super=function(){})}function G(d){null==d.O&&(d.O=d.g.u());return d.O}
function H(d,e){var a="POST",b=d.j().concat(encodeURI(e.N)),c=new XMLHttpRequest;e&&e.da&&(a=e.da);c.open(a,b,!0);e&&e.C?c.setRequestHeader("Authorization",e.C):e&&e.fa?(a="Bearer",e&&e.ga&&(a=e.ga),c.setRequestHeader("Authorization",a+" "+e.fa)):c.setRequestHeader("Authorization",d.h);if(e&&e.aa)for(var f in e.aa)c.setRequestHeader(f,e.aa[f]);e&&e.l&&(c.onload=function(h){h=h.target;4==h.readyState&&(401==h.status&&this.g.o&&!e.Ba?I(this,e):e.l(h))}.bind(d));c.send(e.oa)}
F.prototype.H=function(d){var e=this.g.o,a={},b=u();if(b&&b.token_type&&b.access_token){this.h=b.token_type+" "+b.access_token;this.g.i("access_token",this.h);if(b&&b.state)if(this.g.m(b.state))this.g.s();else{d("Unauthorized access to this url.");return}d()}else if(b&&b.code?a.code=b.code:e&&(a.la=this.g.A()),a.code||a.la){if(b&&b.state)if(this.g.m(b.state))this.g.s();else{d("Unauthorized access to this url.");return}J(this,a,function(c){c&&c.token_type&&c.access_token?(this.h=c.token_type+" "+c.access_token,
this.g.i("access_token",this.h),e&&a.code&&c.refresh_token&&this.g.H(c.refresh_token),c.logout&&this.g.i("logout_url",c.logout),d()):c&&c.error?d("["+c.error+"] "+c.error_description):d("Unknown error occured when doing authorization.")}.bind(this))}else e&&(a.ra=!0),J(this,a,function(c){c&&c.url?(c.state&&(this.g.i("login_state",c.state)||(c.state=this.m())),c.logout&&this.g.i("logout_url",c.logout),window.location.href=c.url.concat("&state=".concat(encodeURIComponent(c.state)))):c&&c.error?d("["+
c.error+"] "+c.error_description):d("Unknown error occured when doing authorization.")}.bind(this))};F.prototype.D=function(d,e){e&&e(!1)};F.prototype.S=function(d){return new K(d,this)};F.prototype.na=function(){};F.prototype.P=function(d){return new L(d,this)};function M(d){return{I:d.status,V:d.responseText}}function N(d,e,a,b,c,f){e={N:e,da:a,l:function(h){var k=M(h),l=!1;b&&h.status!=b&&(l=!0);if(l)if(c&&c.l)c.l(k);else throw Error(JSON.stringify(k));else f(k)}.bind(d)};O(c,e);H(d,e)}
function P(d,e,a,b){N(d,e,"GET",200,a,function(c){b(c.V)})}function O(d,e){d.ga&&(e.ga=d.ga);d.fa&&(e.fa=d.fa);d.C&&(e.C=d.C)}
function J(d,e,a){if(!e)throw Error("Options are not specified when auth onedrive.");var b=new FormData;b.append("drive_type",d.m());e.clientId&&b.append("client_id",e.clientId);e.Da&&b.append("redirect_uri",e.Da);e.Ca&&b.append("client_secret",e.Ca);e.code?b.append("code",e.code):e.la?b.append("refresh_token",e.la):e.ra&&b.append("need_code",e.ra);e=new XMLHttpRequest;e.open("POST",d.sa,!0);e.withCredentials=!0;e.onload=function(c){c=c.target;if(4==c.readyState)if(200==c.status)a&&a(JSON.parse(c.responseText));
else throw Error(c.responseText+" ("+c.status+")");};e.send(b)}function I(d,e){console.log("Retry to send ajax.");e&&(e.Ba=!0,d.H(function(a){a?console.error(a):(e.C=this.h,H(this,e))}.bind(d)))}
function Q(d){d.ha=F;if("function"===typeof Object.create)d.prototype=Object.create(F.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}});else{var e=function(){};e.prototype=F.prototype;d.prototype=new e;d.prototype.constructor=d}d.prototype.getSuperClass||(d.prototype.getSuperClass=function(){return this.constructor.ha});d.prototype.super||(d.prototype.super=function(...a){return this.constructor.ha.call(this,...a)});d.prototype.superCall||(d.prototype.superCall=function(a,
...b){return a?this.constructor.ha.prototype[a].call(this,...b):this.constructor.ha.call(this,...b)})}function R(d,e,a){Q(a);D[d]=new E(d,e,a)}var S=-1,T=-9,U=0;
function K(d,e){this.j=e;this.m=d;this.A="";this.g=this.i=0;this.h=null;if(!this.m||!this.m.X)throw Error("fnm is not specified.");this.o=function(a,b){this.i=a;this.j.A(this.m,a,function(c,f){if(c)this.A=c,b&&b(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,b){var c=null;if(this.h){if(this.h instanceof ArrayBuffer){var f=this.h.byteLength;0<f?(c=new Uint8Array(f+a.byteLength),c.set(new Uint8Array(this.h),0),c.set(new Uint8Array(a),f)):c=new Uint8Array(a)}else c=
0<this.h.length?new Uint8Array(this.h.concat(a)):new Uint8Array(a);this.h=null}else c=new Uint8Array(a);var h=new Blob([c],{type:"application/octet-binary"}),k="bytes "+this.g+"-";this.g+=h.size;k+=this.g-1+"/"+this.i;var l=0,m=function(){var n=new XMLHttpRequest;n.open("PUT",this.A,!0);n.setRequestHeader("Content-Range",k);n.onload=function(p){h=null;p=p.target;if(4==p.readyState){var q=this.j.F(p);if(q==T)throw a=null,Error(p.responseText+" ("+p.status+")");if(q!=S&&q!=U&&q<this.g){var r=a instanceof
ArrayBuffer?a.byteLength:a.length;r-=this.g-q;if(0<r){r=a.slice(r);a=null;if(this.g>=this.i){this.write(r,b);return}this.h=r;this.g=q}else throw a=null,Error("Can NOT continue to upload buffer.");}b&&b(p.responseText)}}.bind(this);n.onerror=function(){1>l?(l++,setTimeout(function(){m()},500)):h=a=null};n.send(h)}.bind(this);m()};this.cancel=function(a){this.j.D(this.A,a)};this.u=function(){return this.i}}
function L(d,e){this.u=e;this.D=d;this.url="";this.name=null;this.F=this.j=this.h=this.size=0;this.S=!1;this.P=16E3;d.T&&(this.P=d.T);this.B=this.m=0;this.i=null;this.H=function(a,b){if(this.S){this.j&&(this.F=this.j,this.j=0);if(a){if(a>=this.g())throw console.log("offset:"+a+",size:"+this.g()),Error("offset can not be bigger than input size.");this.h=a}else this.h=0;b&&b()}else this.u.u(this.D,function(c,f){this.S=!0;if(c){this.size=c.G;this.url=c.v;this.name=c.L;this.B="1"==c.J?1:0;if(a){if(a>=
this.g())throw Error("offset can not be bigger than input size.");this.h=a}b&&b()}else throw Error(f.V+" ("+f.I+")");}.bind(this))};this.s=function(){return this.h};this.g=function(){return this.size};this.A=function(){return this.h>=this.g()};this.o=function(a){a||(a=this.P);this.M(a)};this.O=function(){};this.M=function(a){if(!a||!this.j){if(a)this.j=a;else if(this.j)a=this.j;else throw Error("size must be specified.");if(!this.F){var b=this.h+a-1,c=function(){var f=new XMLHttpRequest;10<=this.m?
(f.open("GET",G(this.u),!0),f.setRequestHeader("Zb-Url",this.url)):f.open("GET",this.url,!0);this.u.na(f,this.D.C);f.setRequestHeader("Range","bytes="+this.h+"-"+b);f.responseType="arraybuffer";f.onload=function(h){if(this.F)this.F=0,this.j&&this.M();else if(this.j=0,h=h.target,4==h.readyState)if(this.m=10>this.m?1:11,200==h.status||206==h.status){2==this.B&&(this.B=1);var k=parseInt(h.getResponseHeader("content-length"),10);k?this.h+=k:this.h=(k=w(h.getResponseHeader("content-range")))?k+1:b+1;200==
h.status&&this.h<this.g()?this.h=this.g():this.h>this.g()&&(this.h=this.g());this.i&&this.i(h.response,this);h.response=null}else if(401==h.status&&1==this.B)console.log("Retry auth."),this.B=2,this.u.H(function(l){l?console.error(l):(this.D.C&&delete this.D.C,c())}.bind(this));else throw Error(h.responseText+" ("+h.status+")");}.bind(this);f.onerror=function(){if(0==this.m&&G(this.u))this.m=10,c();else if(1==this.m||11==this.m)this.m++,setTimeout(function(){c()},500)}.bind(this);f.send()}.bind(this);
c()}}}};R("onedrive","Microsoft OneDrive",function(d,e){this.super(d,e);this.m=function(){return"onedrive"};this.M=function(a){var b="/me/drive/root/children";if(a){if(a.W){var c=function(f){var h={Y:"",l:function(k,l){if(a&&a.l)k?a.l(k):(k=[],l&&k.push(l),a.l(!1,k));else if(k)throw Error(JSON.stringify(k));}};O(a,h);this.i(h,f)}.bind(this);a.U?(b={Y:a.U,l:function(f,h){if(f)if(a&&a.l)a.l(f);else throw Error(JSON.stringify(f));else c(h.Aa.concat("/").concat(h.L).concat("/").concat(a.W))}},O(a,b),this.i(b)):
c("/drive/root:/".concat(a.W));return}a.U&&(b="/me/drive/items/"+a.U+"/children")}P(this,b.concat(v({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),a,function(f){if(a&&a.l){var h=[];f&&JSON.parse(f).value.forEach(function(k){h.push(this.$(k))},this);a.l(!1,h)}}.bind(this))};this.o=function(a){this.i(a)};this.B=function(a){var b="/me/drive/items/".concat(a.Z);N(this,b,"DELETE",204,a,function(){a&&a.l&&a.l(!1)})};this.A=function(a,b,c){b={N:"/me",da:"POST",C:a.C,aa:{"Content-Type":"application/json;charset=UTF-8",
"Cache-Control":"no-cache",Pragma:"no-cache"},l:function(f){f=M(f);var h="";200<=f.I&&299>=f.I&&(h=JSON.parse(f.V).uploadUrl);c(h,f)}.bind(this)};b.N=a.K?"/me/drive/items/"+a.K+":/":b.N+"/drive/root:/";b.N+=a.X;b.N+=":/createUploadSession";b.oa=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:a.X}});H(this,b)};this.F=function(a){if(0<=[200,201].indexOf(a.status))return S;if(0>[202].indexOf(a.status))return T;if((a=JSON.parse(a.responseText).nextExpectedRanges)&&a.length){var b=
a[0].indexOf("-");if(0<b)return parseInt(a[0].substring(0,b),10)}return U};this.D=function(a,b){var c=new XMLHttpRequest;c.open("DELETE",a,!0);c.onload=function(f){f=f.target;if(4==f.readyState){var h={I:f.status,V:f.responseText};200<=f.status&&299>=f.status?b&&b(!1,h):(console.log(f.responseText+" ("+f.status+")"),b&&b(h))}}.bind(this);c.send()};this.u=function(a,b){var c="/me/drive/items/".concat(a.v),f={l:function(h,k){var l=null;k&&!h&&(k=JSON.parse(k),l={v:k["@microsoft.graph.downloadUrl"],
L:k.name,G:k.size});b(l,h)}};a.C&&(f.C=a.C);P(this,c.concat(v({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f,function(h){f.l(!1,h)})};this.j=function(){return"https://graph.microsoft.com/v1.0"};this.i=function(a,b){var c="";c=b?b.startsWith("/me")?b:"/me".concat(b):"/me/drive/items/"+a.Y;N(this,c.concat(v({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,a,function(f){if(a&&a.l)200==f.I?(f=this.$(JSON.parse(f.V)),a.l(!1,f)):404==f.I&&b?a.l(!1):a.l(f);
else if(200!=f.I)throw Error(JSON.stringify(f));}.bind(this))};this.$=function(a){var b={v:a.id,L:a.name,G:a.size,ca:a.lastModifiedDateTime,Aa:a.parentReference.path,R:a.parentReference.id,J:"0"};a.folder?b.J="1":a.file&&(b.J="2");return b}});R("googledrive","Google Drive",function(d,e){this.super(d,e);this.m=function(){return"googledrive"};this.M=function(a){var b=this.i("/files"),c="'"+(a.U?a.U:"root")+"' in parents";a.W&&(c=c.concat(" and name = '"+a.W+"'"));P(this,b.concat(v({fields:"files(id,name,mimeType,parents,modifiedTime,size)",q:c},!0)),a,function(f){if(a&&a.l){var h=[];JSON.parse(f).files.forEach(function(k){h.push(this.$(k))},this);a.l(!1,h)}}.bind(this))};this.o=function(a){var b=this.i("/files/").concat(a.Y);P(this,b.concat(v({fields:"id,name,mimeType,parents,modifiedTime,size"},
!0)),a,function(c){a&&a.l&&(c=this.$(JSON.parse(c)),a.l(!1,c))}.bind(this))};this.B=function(a){var b=this.i("/files/").concat(a.Z);N(this,b,"DELETE",204,a,function(){a&&a.l&&a.l(!1)})};this.A=function(a,b,c){var f=function(k){var l={},m="POST",n="/files?uploadType=resumable";k?(m="PATCH",n="/files/"+k+"?uploadType=resumable"):(l.name=a.X,a.K&&(l.parents=[a.K]));k={N:"/upload".concat(this.i(n)),da:m,C:a.C,aa:{"X-Upload-Content-Length":b,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"},
oa:JSON.stringify(l),l:function(p){var q=M(p),r="";200<=q.I&&299>=q.I&&(r=p.getResponseHeader("location"));c(r,q)}.bind(this)};H(this,k)}.bind(this),h={l:function(k,l){k?c("",k):0<l.length?f(l[0].v):f()},W:a.X,C:a.C};a.K&&(h.U=a.K);this.M(h)};this.F=function(a){if(0<=[200,201].indexOf(a.status))return S;if(0>[308].indexOf(a.status))return T;if(a=a.getResponseHeader("range")){var b=a.indexOf("-");if(0<b)return parseInt(a.slice(b+1),10)+1}return U};this.u=function(a,b){var c=this.i("/files/").concat(a.v),
f={Y:a.v,l:function(h,k){var l=null;k&&!h&&(l=k,l.v=this.j().concat(encodeURI(c)).concat(v({alt:"media"})),this.g.o&&(l.J="1"));b(l,h)}.bind(this)};a.C&&(f.C=a.C);this.o(f)};this.na=function(a,b){b?a.setRequestHeader("Authorization",b):a.setRequestHeader("Authorization",this.h?this.h:"")};this.j=function(){return"https://www.googleapis.com"};this.i=function(a){return"/drive/v3".concat(a)};this.$=function(a){var b={v:a.id,L:a.name,G:a.size,ca:a.modifiedTime,J:"2"};a.parents&&0<a.parents.length&&(b.R=
a.parents[0]);this.s(a.mimeType)&&(b.J="1");return b};this.s=function(a){return"application/vnd.google-apps.folder"==a}});function V(d,e){this.F=e;this.M=d;this.h=null;this.j=this.size=0;this.m=null;this.B=this.u=0;this.D=1600;d.T&&(this.D=d.T);this.i=null;this.H=function(a,b){this.F.u(this.M,function(c,f){if(c)this.size=c.G,this.F.va(this.M.v,function(h){this.h=h;this.h.sort(function(k,l){return k.pa-l.pa});this.S(a);b&&b()}.bind(this));else throw Error(f.V+" ("+f.I+")");}.bind(this))};this.s=function(){return this.j};this.g=function(){return this.size};this.A=function(){return this.h?this.u>=this.h.length:!0};this.o=
function(a){this.m?this.P(a):this.F.ua(this.h[this.u].v,function(b){b=CryptoJS.enc.Base64url.parse(b);this.m=y(b);this.P(a)}.bind(this))};this.O=function(){this.m=this.h=null};this.S=function(a){if(a){if(a>=this.g())throw Error("offset can not be bigger than input size.");this.j=a;var b=0;for(a=0;a<this.h.length&&!(b+=this.h[a].G,this.j<b);a++)this.B=b;if(a<this.h.length)this.u=a;else throw Error("offset can not be bigger than input size.");}else this.u=this.B=this.j=0;this.m=null};this.P=function(a){var b=
this.j-this.B,c=this.m.length-b;a?a<c&&(c=a):this.D<c&&(c=this.D);a=new Uint8Array(this.m.slice(b,b+c));this.j+=c;this.m.length==b+c&&(this.m=null,this.u++,this.B=this.j);this.i&&this.i(a.buffer,this)}}
function W(d,e){this.g=e;this.h=d;this.data={v:"",L:"",G:0,R:"",J:"2"};this.j=this.i=0;this.o=function(a,b){this.i=a;this.data.L=this.h.X;this.h.K&&(this.data.R=this.h.K);this.g.A(this.h,a,function(c,f){if(c)this.data.v=c,b&&b(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,b){var c=null;c=Array.isArray(a)?new CryptoJS.lib.WordArray.init(new Uint8Array(a)):new CryptoJS.lib.WordArray.init(a);this.data.G+=c.sigBytes;a=c.toString(CryptoJS.enc.Base64url);this.j++;
this.g.saveData(this.data.v,this.j,c.sigBytes,a,function(){this.data.G>=this.i?this.g.ya(this.data,b):b&&b()}.bind(this))};this.cancel=function(a){this.g.B({Z:this.data.v,l:function(b){a&&a(b)}})};this.u=function(){return this.i}}
R("idxdb","Loacal Indexed DB",function(d,e){this.super(d,e);this.m=function(){return"idxdb"};this.H=function(a){this.ta(a)};this.M=function(a){a&&a.l&&this.ma(a.l,void 0,a.U,a.W)};this.o=function(a){a&&a.l&&this.ma(function(b,c){c&&0<c.length?a.l(b,c[0]):a.l(b)},a.Y)};this.B=function(a){function b(l){var m=[];h.forEach(function(n){n.ja&&"2"==n.J&&m.push(n.v)});0>m.indexOf(a.Z)&&m.push(a.Z);l.getAllKeys().onsuccess=function(n){n.target.result.forEach(function(p){var q=p.indexOf(":");0<=m.indexOf(p.substring(0,
q))&&(l.delete(p),k+=parseInt(p.substring(p.indexOf("_",q+1)+1),10))})}}function c(l){h.forEach(function(m){m.ja&&l.delete(m.v)})}function f(l){var m;for(m=0;m<h.length;m++)h[m].v==l?h[m].ja=!0:h[m].R==l&&("1"==h[m].J?f(h[m].v):h[m].ja=!0)}var h=[],k=0;this.i(function(l){l.getAll().onsuccess=function(m){m.target.result.forEach(function(n){h.push({v:n.key,L:"",R:n.pid})})}},function(){f(a.Z);this.i(c,function(){this.s(b,function(){a&&a.l&&a.l(!1,k)})}.bind(this))}.bind(this))};this.S=function(a){return new W(a,
this)};this.A=function(a,b,c){c&&(b="",a.K&&(b=a.K),this.wa(b,function(f){c(f,{I:200,V:"nothing"})}))};this.F=function(){return U};this.D=function(){};this.P=function(a){return new V(a,this)};this.u=function(a,b){this.o({Y:a.v,l:function(c,f){b(f,c)}})};this.j=function(){return""};this.ya=function(a,b){a.ca=this.xa();var c={key:a.v,name:a.L,size:a.G,tms:a.ca,type:a.J};a.R&&(c.pid=a.R);this.i(function(f){f.put(c)},b)};this.saveData=function(a,b,c,f,h){this.s(function(k){k.put({key:a+":"+b+"_"+c,data:f})},
h)};this.va=function(a,b){var c=[];this.s(function(f){f.getAllKeys().onsuccess=function(h){h.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,l)==a){var m=k.substring(l+1);l=m.indexOf("_");c.push({v:k,pa:parseInt(m.substring(0,l),10),G:parseInt(m.substring(l+1),10)})}})}},function(){b&&b(c)})};this.ua=function(a,b){if(b){var c="";this.s(function(f){f.get(a).onsuccess=function(h){c=h.target.result.data}},function(){b(c)})}};this.ta=function(a){if(window.indexedDB){var b=window.indexedDB.open("zgalocaldb");
b.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");}.bind(this);b.onupgradeneeded=function(c){c=c.target.result;c.createObjectStore("items",{keyPath:"key"});c.createObjectStore("datas",{keyPath:"key"})}.bind(this);b.onsuccess=function(c){c.target.result.close();a&&a()}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};this.i=function(a,b){window.indexedDB.open("zgalocaldb").onsuccess=function(c){var f=c.target.result;c=f.transaction("items","readwrite");c.oncomplete=function(){f.close();b&&b()}.bind(this);c=c.objectStore("items");a&&a(c)}.bind(this)};this.s=function(a,b){window.indexedDB.open("zgalocaldb").onsuccess=function(c){var f=c.target.result;c=f.transaction("datas","readwrite");c.oncomplete=function(){f.close();b&&b()}.bind(this);c=c.objectStore("datas");a&&a(c)}.bind(this)};this.ma=function(a,b,c,f){if(a){var h=
[];this.i(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var n=!0;b&&(n=b==m.key);n&&c&&(n=c==m.pid);n&&f&&(n=f==m.name);n&&h.push({v:m.key,L:m.name,G:m.size,ca:m.tms,J:m.type,R:m.pid})})}},function(){a(!1,h)})}};this.xa=function(){var a;a||(a=new Date);var b=[],c=[];b.push(a.getFullYear());b.push(a.getMonth()+1);b.push(a.getDate());c.push("0".concat(a.getHours()).slice(-2));c.push("0".concat(a.getMinutes()).slice(-2));c.push("0".concat(a.getSeconds()).slice(-2));
return b.join("-")+" "+c.join(":")};this.wa=function(a,b){var c=-1;this.i(function(f){f.getAllKeys().onsuccess=function(h){h.target.result.forEach(function(k){var l=k.indexOf("_");a&&0<l?k.substring(l+1)==a&&(l=parseInt(k.substring(0,l),10),l>c&&(c=l)):!a&&0>l&&(l=parseInt(k,10),l>c&&(c=l))})}},function(){c++;a?b(c+"_"+a):b(c.toString())})}});function X(d,e,a){this.h=this.g=null;this.A=d;this.i=1;this.u=e;this.j=a;this.o=0;this.m=function(){this.j({type:0,wtype:this.i,size:this.g.g()});var b=new B({za:1==this.i,ba:this.A,ea:this.g,qa:this.h});b.B=function(){var c={type:1,wtype:this.i,begin:this.o,spd:b.H(),posn:this.g.s(),size:this.g.g()};this.j(c);return this.u()?!1:!0}.bind(this);b.s=function(c,f){var h={type:2,wtype:this.i,begin:this.o,posn:this.g.s(),size:this.h.u()};c?h.errr=c.message||c.Ea:f?h.type=3:this.h.s&&(h.blob=this.h.s());
this.j(h)}.bind(this);this.o=Date.now();b.start()};this.s=function(b,c){this.i=1;this.g=b.P({v:c,T:16E5});this.h=new z;this.m()};this.B=function(b,c,f,h){this.i=2;this.g=new A({ia:f,T:16E5});this.h=b.S({X:c,K:h});this.m()}};window=self;self.g=!1;function Y(d,e){return new X(d,function(){return self.g},function(a){2==a.type&&(a.gtoken=e.h?e.h:"");self.postMessage(a)})}
function Z(d){var e=d.type,a=d.cominf,b={iv:CryptoJS.enc.Base64url.parse(a.iv),key:CryptoJS.enc.Base64url.parse(a.key)};self.postMessage({type:0,wtype:e,size:0});var c=new C;c.D(function(f){f&&console.error("IndexedDB is not supported in your browser settings.");if(f=D[a.drvid])switch(f=new f.g(c,"https://zgayard.f5.si/grantauth.php"),f.h=a.gtoken,e){case 1:Y(b,f).s(f,d.downinf.targetId);break;case 2:var h=d.upinf;Y(b,f).B(f,h.fname,h.file,h.ptid)}else self.postMessage({type:2,wtype:e,size:0,errr:"Drive's name is invalid."})})}
self.addEventListener("message",function(d){d=d.data;switch(d.type){case 1:case 2:Z(d);break;default:self.g=!0}});
