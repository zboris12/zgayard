self.importScripts("vendor/crypto-js.js");function t(c){if(!c)return null;var e=c.charAt(0);if("?"==e||"#"==e)c=c.substring(1);var a={};c.split("&").forEach(function(b){var d=b.indexOf("=");0>d?a[decodeURIComponent(b)]="":a[decodeURIComponent(b.substring(0,d))]=decodeURIComponent(b.substring(d+1))});return a}function u(){var c=t(window.location.search),e=t(window.location.hash);e&&(c=c?Object.assign(c,e):e);return c}
function v(c,e){var a=[],b;for(b in c)e?a.push(b.concat("=").concat(c[b])):a.push(encodeURIComponent(b).concat("=").concat(encodeURIComponent(c[b])));return 0<a.length?"?".concat(a.join("&")):""}function w(c){if(!c)return 0;var e=c.indexOf("-");if(0>e)return 0;e++;var a=c.indexOf("/",e);return a<=e?0:parseInt(c.slice(e,a),10)};function x(c){var e=CryptoJS.MD5(c);c=CryptoJS.kdf.OpenSSL.execute(c,8,4,e);c.iv.clamp();c.key.clamp();return c}function y(c){var e=Array(c.sigBytes);c=c.words;for(var a=0,b=0;b<c.length;b++){for(var d=c[b],f=a+4-1;f>=a;f--)f<e.length&&(e[f]=d&255),d>>=8;a+=4;if(a>=e.length)break}return e}
function z(){this.h=0;this.g=null;this.o=function(c,e){this.h=c;e&&e()};this.write=function(c,e){Array.isArray(c)?this.g=this.g?this.g.concat(c):c.concat():(this.g||(this.g=[]),this.g.push(c));e&&e()};this.cancel=function(c){c&&c(!1,!0)};this.i=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var c=0,e=0;e<this.g.length;e++)c+=this.g[e].byteLength;c=new Uint8Array(c);var a=0;for(e=0;e<this.g.length;++e){var b=this.g[e];b instanceof ArrayBuffer&&
(b=new Uint8Array(b));c.set(b,a);a+=b.byteLength}return c}return this.g};this.s=function(){var c=this.i();c instanceof Uint8Array||(c=new Uint8Array(c));return new Blob([c],{type:"application/octet-binary"})};this.download=function(c){var e=this.s();if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,c);else throw Error("Element for download is not specified.");};this.u=function(){return this.h}}
function A(c){this.blob=null;if(c.ja)if(c.ja instanceof Blob)this.blob=c.ja;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.l=1600;c.T&&(this.l=c.T);this.h=0;this.i=this.j=null;this.H=function(e,a){if(e){if(e>=this.g())throw Error("offset can not be bigger than input size.");this.h=e}this.j=new FileReader;this.j.onload=function(b){b=b.target.result;this.i&&this.i(b,this)}.bind(this);a&&a()};this.s=function(){return this.h};this.g=function(){return this.blob.size};
this.A=function(){return this.h>=this.g()};this.o=function(e){if(1!=this.j.readyState){var a=this.h;this.h=e?this.h+e:this.h+this.l;this.j.readAsArrayBuffer(this.blob.slice(a,this.h))}};this.L=function(){this.blob=this.j=null}}
function B(c){if(!c.sa)if(this.getSuperClass&&"Readable"==this.getSuperClass().name)this.super(void 0),this.h=1;else throw Error("writer must be specified in no stream mode.");this.s=this.B=null;this.u=!0;this.g=null;this.o=c.sa;this.iv=this.key=null;this.i=0;this.l=null;this.speed=this.A=this.j=0;c.Ca&&(this.u=!1);if(c.fa)"function"==typeof c.fa?this.g=c.fa():this.g=c.fa;else throw Error("reader must be specified.");if(c.ca){var e=null;e="string"==typeof c.ca?x(c.ca):c.ca;this.key=e.key;this.iv=
e.iv}else throw Error("keycfg must be specified.");this.start=function(a){if(a){if(this.u)throw Error("Can NOT set offset for encryption.");this.i=a;a-=a%16+16;0>a&&(a=0)}this.g.i=this.F.bind(this);this.g.H(a,function(){var b=16*Math.ceil((this.g.g()+1)/16);this.h||!this.o?this.D():this.o.o(b,this.D.bind(this))}.bind(this))};this.H=function(){Date.now()>this.j&&(this.speed=1E3*(this.g.s()-this.A)/(Date.now()-this.j+1E3),this.j=Date.now()+1E3,this.A=this.g.s());return this.speed};this._read=function(a){1==
this.h?this.h=2:3==this.h&&(this.g.A()?this.push(null):this.g.o(a))};this.push=function(a){return this.readable?(a&&!this.L?this.superCall("push",new Uint8Array(a)):this.superCall("push",a),!0):!1};this.D=function(){this.j=Date.now()+1E3;(this.A=this.i)?this.g.o(16):1==this.h?this.h=3:2==this.h?(this.h=3,this.push([])):this.g.o()};this.F=function(a){try{var b=new CryptoJS.lib.WordArray.init(a);if(!this.l){var d={iv:this.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};this.i&&(d.iv=b,b=null);
this.l=this.u?CryptoJS.algo.AES.createEncryptor(this.key,d):CryptoJS.algo.AES.createDecryptor(this.key,d)}if(b){var f=y(this.l.process(b));this.g.A()&&(f=f.concat(y(this.l.finalize())));if(this.i<this.g.s()){var h=this.i-(this.g.s()-a.byteLength);0<h&&(f=f.slice(h))}else f=null;this.h?this.push(f):f?this.o&&this.o.write(f,function(){this.g.A()?this.la():this.B?this.B()?this.g.o():this.o.cancel(function(k,l){this.la(k,l)}.bind(this)):this.g.o()}.bind(this)):this.g.o();f=null}else this.h?2==this.h?
(this.h=3,this.push([])):this.h=3:this.g.o()}catch(k){if(this.h)throw k;this.la(k)}};this.la=function(a,b){this.g&&(this.g.L(),this.g=null);this.s&&(a?this.s(a):this.s(!1,b))}};function C(){this.h=!0;this.g=null;this.o=!1;this.H=function(){var c=null;if(this.h)try{c=window.sessionStorage.getItem("login_state")}catch(e){this.h=!1,console.error(e)}return c};this.u=function(c){var e=this.H();return e&&c==e?!0:!1};this.i=function(c,e){if(this.h)try{return window.sessionStorage.setItem(c,e.toString()),!0}catch(a){this.h=!1,console.error(a)}return!1};this.l=function(c){if(this.h)try{window.sessionStorage.removeItem(c)}catch(e){this.h=!1,console.error(e)}};this.D=function(){var c=
this.j("relay_url");return c?c:""};this.F=function(){var c=null,e=this.A("extra_info");e&&(c=JSON.parse(e));return c&&2==c.length?{pa:c[0],aa:c[1]}:null};this.B=function(c){c?(c="string"===typeof c?c:JSON.stringify([c.pa,c.aa]),this.i("drive_extra",c),this.s("extra_info",c)):(this.l("drive_extra"),this.s("extra_info",null))};this.L=function(c){if(window.indexedDB){var e=window.indexedDB.open("zgayard1946");e.onerror=function(){if(c)c("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};e.onupgradeneeded=function(a){a.target.result.createObjectStore("settings",{keyPath:"key"})};e.onsuccess=function(a){var b=a.target.result;a=b.transaction("settings","readwrite");a.oncomplete=function(){b.close();c&&c()};a.objectStore("settings").getAll().onsuccess=function(d){this.g={};d.target.result.forEach(function(f){this.g[f.key]=f.value}.bind(this));this.o=(d=this.g.drive)&&this.g[d]&&this.g[d].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(c)c("IndexedDB is not supported in your browser settings.");
else throw Error("IndexedDB is not supported in your browser settings.");};this.A=function(c){var e=this.j("drive");return e&&(e=this.g[e])?e[c]:null};this.s=function(c,e){if(this.g){var a=this.j("drive");e?(this.g[a]||(this.g[a]={}),this.g[a][c]=e):this.g[a]&&this.g[a][c]&&delete this.g[a][c]}};this.I=function(c,e){window.indexedDB.open("zgayard1946").onsuccess=function(a){var b=a.target.result;a=b.transaction("settings","readwrite");a.oncomplete=function(){b.close();e&&e()};a=a.objectStore("settings");
c&&c(a)}};this.j=function(c){return this.g&&this.g[c]?this.g[c]:null};this.saveData=function(c,e,a){this.g&&(this.g[c]=e);this.I(function(b){b.put({key:c,value:e})}.bind(this),a)}};var D={};function E(c,e,a){this.v=c;this.N=e;this.g=a}function F(c,e){this.L=null;this.va=e;this.h=null;this.g=c;this.super||(this.super=function(){})}function G(c){null==c.L&&(c.L=c.g.D());return c.L}
function H(c,e){var a="POST",b=c.j().concat(encodeURI(e.O)),d=new XMLHttpRequest;e&&e.ea&&(a=e.ea);d.open(a,b,!0);e&&e.C?d.setRequestHeader("Authorization",e.C):e&&e.ga?(a="Bearer",e&&e.ha&&(a=e.ha),d.setRequestHeader("Authorization",a+" "+e.ga)):d.setRequestHeader("Authorization",c.h);if(e&&e.ba)for(var f in e.ba)d.setRequestHeader(f,e.ba[f]);e&&e.m&&(d.onload=function(h){h=h.target;4==h.readyState&&(401==h.status&&this.g.o&&!e.Ea?I(this,e):e.m(h))}.bind(c));d.send(e.qa)}
F.prototype.H=function(c){var e=this.g.o,a={},b=u();if(b&&b.token_type&&b.access_token){this.h=b.token_type+" "+b.access_token;this.g.i("access_token",this.h);if(b&&b.state)if(this.g.u(b.state))this.g.l("login_state");else{c("Unauthorized access to this url.");return}c()}else{b&&b.code?a.code=b.code:e&&(a.ma=this.g.A("refresh_token"));var d=this.g.F();d&&(a.clientId=d.pa,a.ta=d.aa);if(a.code||a.ma){if(b&&b.state)if(this.g.u(b.state))this.g.l("login_state");else{c("Unauthorized access to this url.");
return}J(this,a,function(f){f&&f.token_type&&f.access_token?(d&&f.client_secret_enc&&(d.aa=f.client_secret_enc,this.g.B(d)),this.h=f.token_type+" "+f.access_token,this.g.i("access_token",this.h),e&&a.code&&f.refresh_token&&this.g.s("refresh_token",f.refresh_token),f.logout&&this.g.i("logout_url",f.logout),c()):f&&f.error?c("["+f.error+"] "+f.error_description):c("Unknown error occured when doing authorization.")}.bind(this))}else e&&(a.ua=!0),J(this,a,function(f){f&&f.url?(d&&f.client_secret_enc&&
(d.aa=f.client_secret_enc,this.g.B(d)),f.state&&(this.g.i("login_state",f.state)||(f.state=this.l())),f.logout&&this.g.i("logout_url",f.logout),window.location.href=f.url.concat("&state=".concat(encodeURIComponent(f.state)))):f&&f.error?c("["+f.error+"] "+f.error_description):c("Unknown error occured when doing authorization.")}.bind(this))}};F.prototype.D=function(c,e){e&&e(!1)};F.prototype.S=function(c){return new K(c,this)};F.prototype.oa=function(){};F.prototype.P=function(c){return new L(c,this)};
function M(c){return{J:c.status,V:c.responseText}}function N(c,e,a,b,d,f){e={O:e,ea:a,m:function(h){var k=M(h),l=!1;b&&h.status!=b&&(l=!0);if(l)if(d&&d.m)d.m(k);else throw Error(JSON.stringify(k));else f(k)}.bind(c)};O(d,e);H(c,e)}function P(c,e,a,b){N(c,e,"GET",200,a,function(d){b(d.V)})}function O(c,e){c.ha&&(e.ha=c.ha);c.ga&&(e.ga=c.ga);c.C&&(e.C=c.C)}
function J(c,e,a){if(!e)throw Error("Options are not specified when auth onedrive.");var b=new FormData;b.append("drive_type",c.l());e.clientId&&b.append("client_id",e.clientId);e.Fa&&b.append("redirect_uri",e.Fa);e.ta&&b.append("client_secret",e.ta);e.code?b.append("code",e.code):e.ma?b.append("refresh_token",e.ma):e.ua&&b.append("need_code",e.ua);e=new XMLHttpRequest;e.open("POST",c.va,!0);e.withCredentials=!0;e.onload=function(d){d=d.target;if(4==d.readyState)if(200==d.status)a&&a(JSON.parse(d.responseText));
else throw Error(d.responseText+" ("+d.status+")");};e.send(b)}function I(c,e){console.log("Retry to send ajax.");e&&(e.Ea=!0,c.H(function(a){a?console.error(a):(e.C=this.h,H(this,e))}.bind(c)))}
function Q(c){c.ia=F;if("function"===typeof Object.create)c.prototype=Object.create(F.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});else{var e=function(){};e.prototype=F.prototype;c.prototype=new e;c.prototype.constructor=c}c.prototype.getSuperClass||(c.prototype.getSuperClass=function(){return this.constructor.ia});c.prototype.super||(c.prototype.super=function(...a){return this.constructor.ia.call(this,...a)});c.prototype.superCall||(c.prototype.superCall=function(a,
...b){return a?this.constructor.ia.prototype[a].call(this,...b):this.constructor.ia.call(this,...b)})}function R(c,e,a){Q(a);D[c]=new E(c,e,a)}var S=-1,T=-9,U=0;
function K(c,e){this.j=e;this.l=c;this.A="";this.g=this.i=0;this.h=null;if(!this.l||!this.l.X)throw Error("fnm is not specified.");this.o=function(a,b){this.i=a;this.j.A(this.l,a,function(d,f){if(d)this.A=d,b&&b(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,b){var d=null;if(this.h){if(this.h instanceof ArrayBuffer){var f=this.h.byteLength;0<f?(d=new Uint8Array(f+a.byteLength),d.set(new Uint8Array(this.h),0),d.set(new Uint8Array(a),f)):d=new Uint8Array(a)}else d=
0<this.h.length?new Uint8Array(this.h.concat(a)):new Uint8Array(a);this.h=null}else d=new Uint8Array(a);var h=new Blob([d],{type:"application/octet-binary"}),k="bytes "+this.g+"-";this.g+=h.size;k+=this.g-1+"/"+this.i;var l=0,m=function(){var n=new XMLHttpRequest;n.open("PUT",this.A,!0);n.setRequestHeader("Content-Range",k);n.onload=function(p){h=null;p=p.target;if(4==p.readyState){var q=this.j.F(p);if(q==T)throw a=null,Error(p.responseText+" ("+p.status+")");if(q!=S&&q!=U&&q<this.g){var r=a instanceof
ArrayBuffer?a.byteLength:a.length;r-=this.g-q;if(0<r){r=a.slice(r);a=null;if(this.g>=this.i){this.write(r,b);return}this.h=r;this.g=q}else throw a=null,Error("Can NOT continue to upload buffer.");}b&&b(p.responseText)}}.bind(this);n.onerror=function(){1>l?(l++,setTimeout(function(){m()},500)):h=a=null};n.send(h)}.bind(this);m()};this.cancel=function(a){this.j.D(this.A,a)};this.u=function(){return this.i}}
function L(c,e){this.u=e;this.D=c;this.url="";this.name=null;this.F=this.j=this.h=this.size=0;this.S=!1;this.P=16E3;c.T&&(this.P=c.T);this.B=this.l=0;this.i=null;this.H=function(a,b){if(this.S){this.j&&(this.F=this.j,this.j=0);if(a){if(a>=this.g())throw console.log("offset:"+a+",size:"+this.g()),Error("offset can not be bigger than input size.");this.h=a}else this.h=0;b&&b()}else this.u.u(this.D,function(d,f){this.S=!0;if(d){this.size=d.G;this.url=d.v;this.name=d.N;this.B="1"==d.K?1:0;if(a){if(a>=
this.g())throw Error("offset can not be bigger than input size.");this.h=a}b&&b()}else throw Error(f.V+" ("+f.J+")");}.bind(this))};this.s=function(){return this.h};this.g=function(){return this.size};this.A=function(){return this.h>=this.g()};this.o=function(a){a||(a=this.P);this.I(a)};this.L=function(){};this.I=function(a){if(!a||!this.j){if(a)this.j=a;else if(this.j)a=this.j;else throw Error("size must be specified.");if(!this.F){var b=this.h+a-1,d=function(){var f=new XMLHttpRequest;10<=this.l?
(f.open("GET",G(this.u),!0),f.setRequestHeader("Zb-Url",this.url)):f.open("GET",this.url,!0);this.u.oa(f,this.D.C);f.setRequestHeader("Range","bytes="+this.h+"-"+b);f.responseType="arraybuffer";f.onload=function(h){if(this.F)this.F=0,this.j&&this.I();else if(this.j=0,h=h.target,4==h.readyState)if(this.l=10>this.l?1:11,200==h.status||206==h.status){2==this.B&&(this.B=1);var k=parseInt(h.getResponseHeader("content-length"),10);k?this.h+=k:this.h=(k=w(h.getResponseHeader("content-range")))?k+1:b+1;200==
h.status&&this.h<this.g()?this.h=this.g():this.h>this.g()&&(this.h=this.g());this.i&&this.i(h.response,this);h.response=null}else if(401==h.status&&1==this.B)console.log("Retry auth."),this.B=2,this.u.H(function(l){l?console.error(l):(this.D.C&&delete this.D.C,d())}.bind(this));else throw Error(h.responseText+" ("+h.status+")");}.bind(this);f.onerror=function(){if(0==this.l&&G(this.u))this.l=10,d();else if(1==this.l||11==this.l)this.l++,setTimeout(function(){d()},500)}.bind(this);f.send()}.bind(this);
d()}}}};R("onedrive","Microsoft OneDrive",function(c,e){this.super(c,e);this.l=function(){return"onedrive"};this.I=function(a){var b="/me/drive/root/children";if(a){if(a.W){var d=function(f){var h={Y:"",m:function(k,l){if(a&&a.m)k?a.m(k):(k=[],l&&k.push(l),a.m(!1,k));else if(k)throw Error(JSON.stringify(k));}};O(a,h);this.i(h,f)}.bind(this);a.U?(b={Y:a.U,m:function(f,h){if(f)if(a&&a.m)a.m(f);else throw Error(JSON.stringify(f));else d(h.Da.concat("/").concat(h.N).concat("/").concat(a.W))}},O(a,b),this.i(b)):
d("/drive/root:/".concat(a.W));return}a.U&&(b="/me/drive/items/"+a.U+"/children")}P(this,b.concat(v({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),a,function(f){if(a&&a.m){var h=[];f&&JSON.parse(f).value.forEach(function(k){h.push(this.$(k))},this);a.m(!1,h)}}.bind(this))};this.o=function(a){this.i(a)};this.B=function(a){var b="/me/drive/items/".concat(a.Z);N(this,b,"DELETE",204,a,function(){a&&a.m&&a.m(!1)})};this.A=function(a,b,d){b={O:"/me",ea:"POST",C:a.C,ba:{"Content-Type":"application/json;charset=UTF-8",
"Cache-Control":"no-cache",Pragma:"no-cache"},m:function(f){f=M(f);var h="";200<=f.J&&299>=f.J&&(h=JSON.parse(f.V).uploadUrl);d(h,f)}.bind(this)};b.O=a.M?"/me/drive/items/"+a.M+":/":b.O+"/drive/root:/";b.O+=a.X;b.O+=":/createUploadSession";b.qa=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:a.X}});H(this,b)};this.F=function(a){if(0<=[200,201].indexOf(a.status))return S;if(0>[202].indexOf(a.status))return T;if((a=JSON.parse(a.responseText).nextExpectedRanges)&&a.length){var b=
a[0].indexOf("-");if(0<b)return parseInt(a[0].substring(0,b),10)}return U};this.D=function(a,b){var d=new XMLHttpRequest;d.open("DELETE",a,!0);d.onload=function(f){f=f.target;if(4==f.readyState){var h={J:f.status,V:f.responseText};200<=f.status&&299>=f.status?b&&b(!1,h):(console.log(f.responseText+" ("+f.status+")"),b&&b(h))}}.bind(this);d.send()};this.u=function(a,b){var d="/me/drive/items/".concat(a.v),f={m:function(h,k){var l=null;k&&!h&&(k=JSON.parse(k),l={v:k["@microsoft.graph.downloadUrl"],
N:k.name,G:k.size});b(l,h)}};a.C&&(f.C=a.C);P(this,d.concat(v({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f,function(h){f.m(!1,h)})};this.j=function(){return"https://graph.microsoft.com/v1.0"};this.i=function(a,b){var d="";d=b?b.startsWith("/me")?b:"/me".concat(b):"/me/drive/items/"+a.Y;N(this,d.concat(v({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,a,function(f){if(a&&a.m)200==f.J?(f=this.$(JSON.parse(f.V)),a.m(!1,f)):404==f.J&&b?a.m(!1):a.m(f);
else if(200!=f.J)throw Error(JSON.stringify(f));}.bind(this))};this.$=function(a){var b={v:a.id,N:a.name,G:a.size,da:a.lastModifiedDateTime,Da:a.parentReference.path,R:a.parentReference.id,K:"0"};a.folder?b.K="1":a.file&&(b.K="2");return b}});R("googledrive","Google Drive",function(c,e){this.super(c,e);this.l=function(){return"googledrive"};this.I=function(a){var b=this.i("/files"),d="'"+(a.U?a.U:"root")+"' in parents";a.W&&(d=d.concat(" and name = '"+a.W+"'"));P(this,b.concat(v({fields:"files(id,name,mimeType,parents,modifiedTime,size)",q:d},!0)),a,function(f){if(a&&a.m){var h=[];JSON.parse(f).files.forEach(function(k){h.push(this.$(k))},this);a.m(!1,h)}}.bind(this))};this.o=function(a){var b=this.i("/files/").concat(a.Y);P(this,b.concat(v({fields:"id,name,mimeType,parents,modifiedTime,size"},
!0)),a,function(d){a&&a.m&&(d=this.$(JSON.parse(d)),a.m(!1,d))}.bind(this))};this.B=function(a){var b=this.i("/files/").concat(a.Z);N(this,b,"DELETE",204,a,function(){a&&a.m&&a.m(!1)})};this.A=function(a,b,d){var f=function(k){var l={},m="POST",n="/files?uploadType=resumable";k?(m="PATCH",n="/files/"+k+"?uploadType=resumable"):(l.name=a.X,a.M&&(l.parents=[a.M]));k={O:"/upload".concat(this.i(n)),ea:m,C:a.C,ba:{"X-Upload-Content-Length":b,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"},
qa:JSON.stringify(l),m:function(p){var q=M(p),r="";200<=q.J&&299>=q.J&&(r=p.getResponseHeader("location"));d(r,q)}.bind(this)};H(this,k)}.bind(this),h={m:function(k,l){k?d("",k):0<l.length?f(l[0].v):f()},W:a.X,C:a.C};a.M&&(h.U=a.M);this.I(h)};this.F=function(a){if(0<=[200,201].indexOf(a.status))return S;if(0>[308].indexOf(a.status))return T;if(a=a.getResponseHeader("range")){var b=a.indexOf("-");if(0<b)return parseInt(a.slice(b+1),10)+1}return U};this.u=function(a,b){var d=this.i("/files/").concat(a.v),
f={Y:a.v,m:function(h,k){var l=null;k&&!h&&(l=k,l.v=this.j().concat(encodeURI(d)).concat(v({alt:"media"})),this.g.o&&(l.K="1"));b(l,h)}.bind(this)};a.C&&(f.C=a.C);this.o(f)};this.oa=function(a,b){b?a.setRequestHeader("Authorization",b):a.setRequestHeader("Authorization",this.h?this.h:"")};this.j=function(){return"https://www.googleapis.com"};this.i=function(a){return"/drive/v3".concat(a)};this.$=function(a){var b={v:a.id,N:a.name,G:a.size,da:a.modifiedTime,K:"2"};a.parents&&0<a.parents.length&&(b.R=
a.parents[0]);this.s(a.mimeType)&&(b.K="1");return b};this.s=function(a){return"application/vnd.google-apps.folder"==a}});function V(c,e){this.F=e;this.I=c;this.h=null;this.j=this.size=0;this.l=null;this.B=this.u=0;this.D=1600;c.T&&(this.D=c.T);this.i=null;this.H=function(a,b){this.F.u(this.I,function(d,f){if(d)this.size=d.G,this.F.ya(this.I.v,function(h){this.h=h;this.h.sort(function(k,l){return k.ra-l.ra});this.S(a);b&&b()}.bind(this));else throw Error(f.V+" ("+f.J+")");}.bind(this))};this.s=function(){return this.j};this.g=function(){return this.size};this.A=function(){return this.h?this.u>=this.h.length:!0};this.o=
function(a){this.l?this.P(a):this.F.xa(this.h[this.u].v,function(b){b=CryptoJS.enc.Base64url.parse(b);this.l=y(b);this.P(a)}.bind(this))};this.L=function(){this.l=this.h=null};this.S=function(a){if(a){if(a>=this.g())throw Error("offset can not be bigger than input size.");this.j=a;var b=0;for(a=0;a<this.h.length&&!(b+=this.h[a].G,this.j<b);a++)this.B=b;if(a<this.h.length)this.u=a;else throw Error("offset can not be bigger than input size.");}else this.u=this.B=this.j=0;this.l=null};this.P=function(a){var b=
this.j-this.B,d=this.l.length-b;a?a<d&&(d=a):this.D<d&&(d=this.D);a=new Uint8Array(this.l.slice(b,b+d));this.j+=d;this.l.length==b+d&&(this.l=null,this.u++,this.B=this.j);this.i&&this.i(a.buffer,this)}}
function W(c,e){this.g=e;this.h=c;this.data={v:"",N:"",G:0,R:"",K:"2"};this.j=this.i=0;this.o=function(a,b){this.i=a;this.data.N=this.h.X;this.h.M&&(this.data.R=this.h.M);this.g.A(this.h,a,function(d,f){if(d)this.data.v=d,b&&b(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,b){var d=null;d=Array.isArray(a)?new CryptoJS.lib.WordArray.init(new Uint8Array(a)):new CryptoJS.lib.WordArray.init(a);this.data.G+=d.sigBytes;a=d.toString(CryptoJS.enc.Base64url);this.j++;
this.g.saveData(this.data.v,this.j,d.sigBytes,a,function(){this.data.G>=this.i?this.g.Ba(this.data,b):b&&b()}.bind(this))};this.cancel=function(a){this.g.B({Z:this.data.v,m:function(b){a&&a(b)}})};this.u=function(){return this.i}}
R("idxdb","Loacal Indexed DB",function(c,e){this.super(c,e);this.l=function(){return"idxdb"};this.H=function(a){this.wa(a)};this.I=function(a){a&&a.m&&this.na(a.m,void 0,a.U,a.W)};this.o=function(a){a&&a.m&&this.na(function(b,d){d&&0<d.length?a.m(b,d[0]):a.m(b)},a.Y)};this.B=function(a){function b(l){var m=[];h.forEach(function(n){n.ka&&"2"==n.K&&m.push(n.v)});0>m.indexOf(a.Z)&&m.push(a.Z);l.getAllKeys().onsuccess=function(n){n.target.result.forEach(function(p){var q=p.indexOf(":");0<=m.indexOf(p.substring(0,
q))&&(l.delete(p),k+=parseInt(p.substring(p.indexOf("_",q+1)+1),10))})}}function d(l){h.forEach(function(m){m.ka&&l.delete(m.v)})}function f(l){var m;for(m=0;m<h.length;m++)h[m].v==l?h[m].ka=!0:h[m].R==l&&("1"==h[m].K?f(h[m].v):h[m].ka=!0)}var h=[],k=0;this.i(function(l){l.getAll().onsuccess=function(m){m.target.result.forEach(function(n){h.push({v:n.key,N:"",R:n.pid})})}},function(){f(a.Z);this.i(d,function(){this.s(b,function(){a&&a.m&&a.m(!1,k)})}.bind(this))}.bind(this))};this.S=function(a){return new W(a,
this)};this.A=function(a,b,d){d&&(b="",a.M&&(b=a.M),this.za(b,function(f){d(f,{J:200,V:"nothing"})}))};this.F=function(){return U};this.D=function(){};this.P=function(a){return new V(a,this)};this.u=function(a,b){this.o({Y:a.v,m:function(d,f){b(f,d)}})};this.j=function(){return""};this.Ba=function(a,b){a.da=this.Aa();var d={key:a.v,name:a.N,size:a.G,tms:a.da,type:a.K};a.R&&(d.pid=a.R);this.i(function(f){f.put(d)},b)};this.saveData=function(a,b,d,f,h){this.s(function(k){k.put({key:a+":"+b+"_"+d,data:f})},
h)};this.ya=function(a,b){var d=[];this.s(function(f){f.getAllKeys().onsuccess=function(h){h.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,l)==a){var m=k.substring(l+1);l=m.indexOf("_");d.push({v:k,ra:parseInt(m.substring(0,l),10),G:parseInt(m.substring(l+1),10)})}})}},function(){b&&b(d)})};this.xa=function(a,b){if(b){var d="";this.s(function(f){f.get(a).onsuccess=function(h){d=h.target.result.data}},function(){b(d)})}};this.wa=function(a){if(window.indexedDB){var b=window.indexedDB.open("zgalocaldb");
b.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");}.bind(this);b.onupgradeneeded=function(d){d=d.target.result;d.createObjectStore("items",{keyPath:"key"});d.createObjectStore("datas",{keyPath:"key"})}.bind(this);b.onsuccess=function(d){d.target.result.close();a&&a()}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};this.i=function(a,b){window.indexedDB.open("zgalocaldb").onsuccess=function(d){var f=d.target.result;d=f.transaction("items","readwrite");d.oncomplete=function(){f.close();b&&b()}.bind(this);d=d.objectStore("items");a&&a(d)}.bind(this)};this.s=function(a,b){window.indexedDB.open("zgalocaldb").onsuccess=function(d){var f=d.target.result;d=f.transaction("datas","readwrite");d.oncomplete=function(){f.close();b&&b()}.bind(this);d=d.objectStore("datas");a&&a(d)}.bind(this)};this.na=function(a,b,d,f){if(a){var h=
[];this.i(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var n=!0;b&&(n=b==m.key);n&&d&&(n=d==m.pid);n&&f&&(n=f==m.name);n&&h.push({v:m.key,N:m.name,G:m.size,da:m.tms,K:m.type,R:m.pid})})}},function(){a(!1,h)})}};this.Aa=function(){var a;a||(a=new Date);var b=[],d=[];b.push(a.getFullYear());b.push(a.getMonth()+1);b.push(a.getDate());d.push("0".concat(a.getHours()).slice(-2));d.push("0".concat(a.getMinutes()).slice(-2));d.push("0".concat(a.getSeconds()).slice(-2));
return b.join("-")+" "+d.join(":")};this.za=function(a,b){var d=-1;this.i(function(f){f.getAllKeys().onsuccess=function(h){h.target.result.forEach(function(k){var l=k.indexOf("_");a&&0<l?k.substring(l+1)==a&&(l=parseInt(k.substring(0,l),10),l>d&&(d=l)):!a&&0>l&&(l=parseInt(k,10),l>d&&(d=l))})}},function(){d++;a?b(d+"_"+a):b(d.toString())})}});function X(c,e,a){this.h=this.g=null;this.A=c;this.i=1;this.u=e;this.j=a;this.o=0;this.l=function(){this.j({type:0,wtype:this.i,size:this.g.g()});var b=new B({Ca:1==this.i,ca:this.A,fa:this.g,sa:this.h});b.B=function(){var d={type:1,wtype:this.i,begin:this.o,spd:b.H(),posn:this.g.s(),size:this.g.g()};this.j(d);return this.u()?!1:!0}.bind(this);b.s=function(d,f){var h={type:2,wtype:this.i,begin:this.o,posn:this.g.s(),size:this.h.u()};d?h.errr=d.message||d.Ga:f?h.type=3:this.h.s&&(h.blob=this.h.s());
this.j(h)}.bind(this);this.o=Date.now();b.start()};this.s=function(b,d){this.i=1;this.g=b.P({v:d,T:16E5});this.h=new z;this.l()};this.B=function(b,d,f,h){this.i=2;this.g=new A({ja:f,T:16E5});this.h=b.S({X:d,M:h});this.l()}};window=self;self.g=!1;function Y(c,e){return new X(c,function(){return self.g},function(a){2==a.type&&(a.gtoken=e.h?e.h:"");self.postMessage(a)})}
function Z(c){var e=c.type,a=c.cominf,b={iv:CryptoJS.enc.Base64url.parse(a.iv),key:CryptoJS.enc.Base64url.parse(a.key)};self.postMessage({type:0,wtype:e,size:0});var d=new C;d.L(function(f){f&&console.error("IndexedDB is not supported in your browser settings.");if(f=D[a.drvid])switch(f=new f.g(d,"https://zgayard.f5.si/grantauth.php"),f.h=a.gtoken,e){case 1:Y(b,f).s(f,c.downinf.targetId);break;case 2:var h=c.upinf;Y(b,f).B(f,h.fname,h.file,h.ptid)}else self.postMessage({type:2,wtype:e,size:0,errr:"Drive's name is invalid."})})}
self.addEventListener("message",function(c){c=c.data;switch(c.type){case 1:case 2:Z(c);break;default:self.g=!0}});
