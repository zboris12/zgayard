const aa={en:"English",ja:"日本語"},ba={bmp:"image/bmp",gif:"image/gif",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png"},ca={avi:"video/x-msvideo",mp4:"video/mp4",mpeg:"video/mpeg"};function da(b,c){var a="",d="";if(c){d=c.indexOf(".");0<=d&&(a=c.substring(0,d).toUpperCase(),c=c.slice(d+1));switch(c.toLowerCase()){case "id":c="#";break;case "class":c="."}d=b}else c=b.charAt(0),"#"==c||"."==c?d=b.slice(1):(c="",a=b.toUpperCase());return{fa:a,u:c,qa:d}}function ea(b,c){return"#"==c.u?b.id==c.qa:"."==c.u?b.classList.contains(c.qa):c.u?b.getAttribute(c.u)==c.qa:!0}
function h(b,c,a){var d=[],e=document;c&&("string"==typeof c?(c=h(c),0<c.length&&(e=c[0])):e=c);a=da(b,a);if(!a.fa)if("#"==a.u)d.push(document.getElementById(a.qa));else if("."==a.u)for(c=e.getElementsByClassName(a.qa),b=0;b<c.length;b++)d.push(c[b]);else a.fa="*";if(a.fa)for(e=e.getElementsByTagName(a.fa.toLowerCase()),b=0;b<e.length;b++)ea(e[b],a)&&d.push(e[b]);return d}
function q(b,c,a){var d=null;b?"string"==typeof b?(b=h(b,c,a),0<b.length&&(d=b[0])):b instanceof Event?d=b.currentTarget||b.srcElement||b.target:d=b:d=window.event.currentTarget||window.event.srcElement||window.event.target;return d}function r(b,c,a,d){var e=null;c?"string"==typeof c?e=q(c):e=c:e=q();d&&(e=e.parentElement);for(b=da(b,a);e&&(e.tagName!=b.fa&&b.fa||!ea(e,b));)e=e.parentElement;return e}function fa(b){return!!(b.offsetWidth||b.offsetHeight||b.getClientRects().length)}
function t(b){(b=q(b))&&b.style.display&&(b.style.display="")}function u(b){if(b=q(b))b.style.display="none"}function v(b,c){if((b=b.nextElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);b&&b.id!=c;)b=b.nextElementSibling;break;default:for(c=c.toUpperCase();b&&b.tagName!=c;)b=b.nextElementSibling}return b}
function ha(b,c,a){if((b=a?b.lastElementChild:b.previousElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);b&&b.id!=c;)b=b.previousElementSibling;break;default:for(c=c.toUpperCase();b&&b.tagName!=c;)b=b.previousElementSibling}return b}function w(b,c){return parseInt(b.getAttribute(c),10)}
function ia(b,c,a){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(b,c);else if(a)a.download=c,a.href=window.URL.createObjectURL(b),a.click();else throw Error("Element for download is not specified.");}function ja(b){if(!b)return null;var c=b.charAt(0);if("?"==c||"#"==c)b=b.substring(1);var a={};b.split("&").forEach(function(d){var e=d.indexOf("=");0>e?a[decodeURIComponent(d)]="":a[decodeURIComponent(d.substring(0,e))]=decodeURIComponent(d.substring(e+1))});return a}
function ka(){var b=ja(window.location.search),c=ja(window.location.hash);c&&(b=b?Object.assign(b,c):c);return b}function x(b,c){var a=[],d;for(d in b)c?a.push(d.concat("=").concat(b[d])):a.push(encodeURIComponent(d).concat("=").concat(encodeURIComponent(b[d])));return 0<a.length?"?".concat(a.join("&")):""}
function z(b,c,a,d){var e=q("svg",b),f=document.createElementNS("http://www.w3.org/2000/svg","use");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#".concat(c));e||(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),b.appendChild(e));e.appendChild(f);a&&(e.style.fill=a);d&&(e.style.stroke=d)}
function B(b){if(b)if(1024>b)var c="B";else 1048576>b?(c="KB",b=Math.round(b/102.4)/10):1073741824>b?(c="MB",b=Math.round(b/104857.6)/10):(c="GB",b=Math.round(b/1.073741824E8)/10);else c="B",b=0;var a=b.toString();b=a.indexOf(".");var d=a.split(""),e=[];0<=b?e.push(a.slice(b)):b=d.length;for(a=0;0<b;)3==a++&&(e.unshift(","),a=1),e.unshift(d[--b]);return e.join("").concat(c)}
function la(b){var c=b%60;b=(b-c)/60;var a=b%60;b=(b-a)/60;var d=[];0<b&&d.push(b.toString(10));d.push("0".concat(a).slice(-2));d.push("0".concat(c).slice(-2));return d.join(":")}function ma(b){if(!b)return 0;var c=b.indexOf("-");if(0>c)return 0;c++;var a=b.indexOf("/",c);return a<=c?0:parseInt(b.slice(c,a),10)};function C(b){var c=CryptoJS.MD5(b);b=CryptoJS.kdf.OpenSSL.execute(b,8,4,c);b.iv.clamp();b.key.clamp();return b}
function na(b,c,a){var d=a;"string"==typeof a&&(d=C(a));if(!(d&&d.iv&&d.key))throw Error("Need iv and key. They can be generated by CryptoJS.kdf.OpenSSL.execute from password and salt.");a={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};Object.assign(a,d);b=b?CryptoJS.algo.AES.createEncryptor(a.key,a):CryptoJS.algo.AES.createDecryptor(a.key,a);c=b.process(c);c.concat(b.finalize());c.clamp();return c}
function oa(b){var c=Array(b.sigBytes);b=b.words;for(var a=0,d=0;d<b.length;d++){for(var e=b[d],f=a+4-1;f>=a;f--)f<c.length&&(c[f]=e&255),e>>=8;a+=4;if(a>=c.length)break}return c}
function pa(){this.h=0;this.g=null;this.j=function(b,c){this.h=b;c&&c()};this.write=function(b,c){Array.isArray(b)?this.g=this.g?this.g.concat(b):b.concat():(this.g||(this.g=[]),this.g.push(b));c&&c()};this.cancel=function(b){b&&b(!1,!0)};this.s=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var b=0,c=0;c<this.g.length;c++)b+=this.g[c].byteLength;b=new Uint8Array(b);var a=0;for(c=0;c<this.g.length;++c){var d=this.g[c];d instanceof ArrayBuffer&&
(d=new Uint8Array(d));b.set(d,a);a+=d.byteLength}return b}return this.g};this.B=function(){var b=this.s();b instanceof Uint8Array||(b=new Uint8Array(b));return new Blob([b],{type:"application/octet-binary"})};this.download=function(b){var c=this.B();ia(c,b,null)};this.C=function(){return this.h}}
function qa(b){this.s=null;if(b._blob)if(b._blob instanceof Blob)this.s=b._blob;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.v=1600;b.X&&(this.v=b.X);this.h=0;this.o=this.m=null;this.H=function(c,a){if(c){if(c>=this.g())throw Error("offset can not be bigger than input size.");this.h=c}this.m=new FileReader;this.m.onload=function(d){d=d.target.result;this.o&&this.o(d,this)}.bind(this);a&&a()};this.B=function(){return this.h};this.g=function(){return this.s.size};
this.C=function(){return this.h>=this.g()};this.j=function(c){if(1!=this.m.readyState){var a=this.h;this.h=c?this.h+c:this.h+this.v;this.m.readAsArrayBuffer(this.s.slice(a,this.h))}};this.O=function(){this.s=this.m=null}}
function ra(b,c){if(!b.Ia)if(this.getSuperClass&&"Readable"==this.getSuperClass().name)this.super(c),this.h=1,c&&c.objectMode&&(this.L=!0);else throw Error("writer must be specified in no stream mode.");this.m=this.H=null;this.C=!0;this.g=null;this.o=b.Ia;this.iv=this.key=null;this.j=0;this.B=null;this.speed=this.v=this.s=0;b.Da&&(this.C=!1);if(b.wa)this.g=b.wa;else throw Error("reader must be specified.");if(b.ea)c=null,c="string"==typeof b.ea?C(b.ea):b.ea,this.key=c.key,this.iv=c.iv;else throw Error("keycfg must be specified.");
this.start=function(a){if(a){if(this.C)throw Error("Can NOT set offset for encryption.");this.j=a;a-=a%16+16;0>a&&(a=0)}this.g.o=this.I.bind(this);this.g.H(a,function(){var d=16*Math.ceil((this.g.g()+1)/16);this.h||!this.o?this.F():this.o.j(d,this.F.bind(this))}.bind(this))};this.O=function(){Date.now()>this.s&&(this.speed=1E3*(this.g.B()-this.v)/(Date.now()-this.s+1E3),this.s=Date.now()+1E3,this.v=this.g.B());return this.speed};this._read=function(a){1==this.h?this.h=2:3==this.h&&(this.g.C()?this.push(null):
this.g.j(a))};this.push=function(a){return this.readable?(a&&!this.L?this.superCall("push",new Uint8Array(a)):this.superCall("push",a),!0):!1};this.F=function(){this.s=Date.now()+1E3;(this.v=this.j)?this.g.j(16):1==this.h?this.h=3:2==this.h?(this.h=3,this.push([])):this.g.j()};this.I=function(a){try{var d=new CryptoJS.lib.WordArray.init(a);if(!this.B){var e={iv:this.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};this.j&&(e.iv=d,d=null);this.B=this.C?CryptoJS.algo.AES.createEncryptor(this.key,
e):CryptoJS.algo.AES.createDecryptor(this.key,e)}if(d){var f=oa(this.B.process(d));this.g.C()&&(f=f.concat(oa(this.B.finalize())));if(this.j<this.g.B()){var g=this.j-(this.g.B()-a.byteLength);0<g&&(f=f.slice(g))}else f=null;this.h?this.push(f):f?this.o&&this.o.write(f,function(){this.g.C()?this.Ja():this.H?this.H()?this.g.j():this.o.cancel(function(k,l){this.Ja(k,l)}.bind(this)):this.g.j()}.bind(this)):this.g.j();f=null}else this.h?2==this.h?(this.h=3,this.push([])):this.h=3:this.g.j()}catch(k){if(this.h)throw k;
this.Ja(k)}};this.Ja=function(a,d){this.g&&(this.g.O(),this.g=null);this.m&&(a?this.m(a):this.m(!1,d))}}function sa(b){const c=zb_require("readable-stream");ra.super_!==c.Readable&&zb_inherits(ra,c.Readable);this.h={highWaterMark:8E5};Object.assign(this.h,void 0);this.info=b;this.g=null;this.createReadStream=function(a){this.La();this.g=new ra(this.info,this.h);var d=0;a&&a.start&&(d=a.start);this.g.start(d);return this.g};this.La=function(){this.g&&(this.g.destroy(),this.g=null)}}
function ta(b,c,a){b.o=function(d){c.write(d,function(){b.C()?a&&a():b.j()})};b.H(0,function(){c.j(b.g(),function(){b.j()})})};function ua(){this.m=!0;this.h=this.A=null;this.o=this.v=!1;this.j=-1;this.L=function(){return null!=this.A};this.O=function(b){if(this.m)try{var c=window.sessionStorage.getItem("language"),a=window.sessionStorage.getItem("relay_url"),d=window.sessionStorage.getItem("drive"),e=window.sessionStorage.getItem("skipLogin");window.sessionStorage.clear();c&&window.sessionStorage.setItem("language",c);a&&!b&&window.sessionStorage.setItem("relay_url",a);d&&!b&&window.sessionStorage.setItem("drive",d);e&&
!b&&window.sessionStorage.setItem("skipLogin",e)}catch(f){this.m=!1,console.error(f)}};this.s=function(b){var c=null;if(this.m)try{c=window.sessionStorage.getItem(b)}catch(a){this.m=!1,console.error(a)}return c};this.ha=function(b){var c=this.s("login_state");return c&&b==c?!0:!1};this.B=function(b,c){if(this.m)try{return window.sessionStorage.setItem(b,c.toString()),!0}catch(a){this.m=!1,console.error(a)}return!1};this.I=function(b){if(this.m)try{window.sessionStorage.removeItem(b)}catch(c){this.m=
!1,console.error(c)}};this.la=function(){var b=this.s("language"),c=this.s("relay_url"),a=this.s("drive"),d=this.s("skipLogin");this.h={};b&&(this.h.language=b,this.R(b));c&&(this.h.sa=c,this.ca(c));a&&(this.h.K=a,this.ta(a));d&&this.ua(d)};this.Aa=function(){var b=this.g("drive");b||(this.h||this.la(),b=this.h.K);return b};this.ta=function(b){return this.S("drive",b)?(this.A[b]||(this.A[b]={}),!0):this.A?!1:!0};this.ua=function(b){b?this.o=this.L():(this.o=!1,this.Ba()&&(this.v=!0));this.B("skipLogin",
this.o)};this.ka=function(b){var c=this.g("language");!c&&b&&this.h&&(c=this.h.language);return c};this.R=function(b){this.S("language",b)};this.W=function(){var b=this.g("relay_url");!b&&this.h&&(b=this.h.sa);return b?b:""};this.ca=function(b){this.S("relay_url",b)};this.Qa=function(b){if(window.indexedDB){var c=window.indexedDB.open("zgayard1946");c.onerror=function(){if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};c.onupgradeneeded=function(a){a.target.result.createObjectStore("settings",{keyPath:"key"})};c.onsuccess=function(a){var d=a.target.result;a=d.transaction("settings","readwrite");a.oncomplete=function(){d.close();b&&b()};a.objectStore("settings").getAll().onsuccess=function(e){this.A={};e.target.result.forEach(function(f){this.A[f.key]=f.value}.bind(this));this.o=(e=this.A.drive)&&this.A[e]&&this.A[e].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(b)b("IndexedDB is not supported in your browser settings.");
else throw Error("IndexedDB is not supported in your browser settings.");};this.Oa=function(b){var c=window.indexedDB.deleteDatabase("zgayard1946");c.onerror=function(){if(b)b("Failed to dropt IndexedDB.");else throw Error("Failed to dropt IndexedDB.");};c.onsuccess=function(){this.O(!0);this.A=null;this.o=!1;b?b():console.log("IndexedDB has been dropped.")}.bind(this)};this.ma=function(){this.v&&this.A&&(this.F(function(b){b.clear().onsuccess=function(){for(var c in this.A)b.put({key:c,value:this.A[c]})}.bind(this)}.bind(this)),
this.v=!1)};this.C=function(b){var c=this.g("drive");return c&&(c=this.A[c])?c[b]:null};this.Ba=function(){var b=this.g("drive");return b&&(b=this.A[b])&&b.refresh_token?(delete b.refresh_token,!0):!1};this.H=function(b,c,a){if(this.A){var d=this.g("drive");if(c)this.A[d]||(this.A[d]={}),this.A[d][b]=c;else if(this.A[d])delete this.A[d][b];else{a&&a instanceof Function&&a();return}a?(b=void 0,a instanceof Function&&(b=a),this.F(function(e){e.put({key:d,value:this.A[d]})}.bind(this),b)):this.v=!0}else a&&
a instanceof Function&&a()};this.ia=function(b){this.O(!0);if(this.A){var c=this.g("drive");delete this.A[c].refresh_token;delete this.A.drive;this.F(function(a){a.put({key:c,value:this.A[c]});a.delete("drive")}.bind(this),b)}else b&&b()};this.Sa=function(b,c){var a=this.g("recent");a||(a=[]);0>this.j&&(a.push({drive:this.g("drive"),root:this.C("root"),played:[]}),this.j=a.length-1);var d=a[this.j];b={fid:b.G,time:b.ga};0<=c&&c<d.played.length?d.played[c]=b:d.played.push(b);this.saveData("recent",
a,void 0)};this.Pa=function(){var b=this.g("recent");if(b&&0>this.j){var c=0;for(c=0;c<b.length;c++){var a=b[c];if(a.drive==this.g("drive")&&a.root==this.C("root")){this.j=c;break}}}if(0<=this.j){var d=[];b[this.j].played.forEach(function(e){d.push({G:e.fid,M:"",ga:e.time})});return d}return null};this.Ra=function(b){var c=this.g("recent");if(c&&!(0>this.j)){var a=c[this.j].played;b<a.length&&(a.splice(b,1),this.saveData("recent",c,void 0))}};this.F=function(b,c){window.indexedDB.open("zgayard1946").onsuccess=
function(a){var d=a.target.result;a=d.transaction("settings","readwrite");a.oncomplete=function(){d.close();c&&c()};a=a.objectStore("settings");b&&b(a)}};this.S=function(b,c){if(c){if(this.B(b,c),this.A&&this.A[b]!=c)return this.A[b]=c,this.v=!0}else if(this.I(b),this.A&&this.A[b])return delete this.A[b],this.v=!0;return!1};this.g=function(b){return this.A&&this.A[b]?this.A[b]:null};this.saveData=function(b,c,a){this.A&&(this.A[b]=c);this.F(function(d){d.put({key:b,value:c})}.bind(this),a)}};var va={};function wa(b,c,a){this.l=b;this.u=c;this.g=a}function E(b,c){this.sa=null;this.ia=c;this.h=null;this.g=b;this.super||(this.super=function(){})}function xa(b){null==b.sa&&(b.sa=b.g.W());return b.sa}
function ya(b,c){var a="POST",d=b.H().concat(encodeURI(c.Y)),e=new XMLHttpRequest;c&&c.va&&(a=c.va);e.open(a,d,!0);c&&c.J?e.setRequestHeader("Authorization",c.J):c&&c.xa?(a="Bearer",c&&c.ya&&(a=c.ya),e.setRequestHeader("Authorization",a+" "+c.xa)):e.setRequestHeader("Authorization",b.h);if(c&&c.na)for(var f in c.na)e.setRequestHeader(f,c.na[f]);c&&c.i&&(e.onload=function(g){g=g.target;4==g.readyState&&(401==g.status&&this.g.o&&!c.Va?za(this,c):c.i(g))}.bind(b));e.send(c.Ca)}
E.prototype.F=function(b,c){if(c&&(this.h=this.g.s("access_token"))){b();return}var a=this.g.o,d={};if((c=ka())&&c.token_type&&c.access_token){this.h=c.token_type+" "+c.access_token;this.g.B("access_token",this.h);if(c&&c.state)if(this.g.ha(c.state))this.g.I("login_state");else{b("Unauthorized access to this url.");return}b()}else if(c&&c.code?d.code=c.code:a&&(d.Ka=this.g.C("refresh_token")),d.code||d.Ka){if(c&&c.state)if(this.g.ha(c.state))this.g.I("login_state");else{b("Unauthorized access to this url.");
return}Aa(this,d,function(e){e&&e.token_type&&e.access_token?(this.h=e.token_type+" "+e.access_token,this.g.B("access_token",this.h),a&&d.code&&e.refresh_token&&this.g.H("refresh_token",e.refresh_token),e.logout&&this.g.B("logout_url",e.logout),b()):e&&e.error?b("["+e.error+"] "+e.error_description):b("Unknown error occured when doing authorization.")}.bind(this))}else a&&(d.Na=!0),Aa(this,d,function(e){e&&e.url?(e.state&&(this.g.B("login_state",e.state)||(e.state=this.m())),e.logout&&this.g.B("logout_url",
e.logout),window.location.href=e.url.concat("&state=".concat(encodeURIComponent(e.state)))):e&&e.error?b("["+e.error+"] "+e.error_description):b("Unknown error occured when doing authorization.")}.bind(this))};
function Ba(){var b=F;b.h=null;b.g.I("access_token");var c=b.g.s("logout_url");if(c)window.location.href=c;else{c=new FormData;c.append("drive_type",b.m());c.append("action","logout");var a=new XMLHttpRequest;a.open("POST",b.ia,!0);a.withCredentials=!0;a.onload=function(d){d=d.target;4==d.readyState&&200==d.status&&(d=JSON.parse(d.responseText))&&d.logout&&(window.location.href=d.logout)};a.send(c)}}function Ca(b){var c=F;if(!b||!b.Z)throw Error("newname is not specified.");c.L(b)}
function Da(b){var c=F;if(!b||!b.D)throw Error("parentid is not specified.");if(!b||!b.Fa)throw Error("oldparentid is not specified.");c.L(b)}E.prototype.W=function(b,c){c&&c(!1)};E.prototype.R=function(b){return new Ea(b,this)};E.prototype.ma=function(){};E.prototype.B=function(b){return new Fa(b,this)};function Ga(b){return{T:b.status,P:b.responseText}}
function G(b,c,a,d,e,f,g,k){c={Y:c,va:a,i:function(l){var m=Ga(l),n=!1;d&&l.status!=d&&(n=!0);if(n)if(e&&e.i)e.i(m);else throw Error(JSON.stringify(m));else k(m)}.bind(b)};Ha(e,c);f&&(c.na=f);g&&(c.Ca=g);ya(b,c)}function H(b,c,a,d){G(b,c,"GET",200,a,null,null,function(e){d(e.P)})}function Ha(b,c){b.ya&&(c.ya=b.ya);b.xa&&(c.xa=b.xa);b.J&&(c.J=b.J)}
function Aa(b,c,a){if(!c)throw Error("Options are not specified when auth onedrive.");var d=new FormData;d.append("drive_type",b.m());c.clientId&&d.append("client_id",c.clientId);c.Za&&d.append("redirect_uri",c.Za);c.Ya&&d.append("client_secret",c.Ya);c.code?d.append("code",c.code):c.Ka?d.append("refresh_token",c.Ka):c.Na&&d.append("need_code",c.Na);c=new XMLHttpRequest;c.open("POST",b.ia,!0);c.withCredentials=!0;c.onload=function(e){e=e.target;if(4==e.readyState)if(200==e.status)a&&a(JSON.parse(e.responseText));
else throw Error(e.responseText+" ("+e.status+")");};c.send(d)}function za(b,c){console.log("Retry to send ajax.");c&&(c.Va=!0,b.F(function(a){a?console.error(a):(c.J=this.h,ya(this,c))}.bind(b)))}
function Ia(b){b.za=E;if("function"===typeof Object.create)b.prototype=Object.create(E.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});else{var c=function(){};c.prototype=E.prototype;b.prototype=new c;b.prototype.constructor=b}b.prototype.getSuperClass||(b.prototype.getSuperClass=function(){return this.constructor.za});b.prototype.super||(b.prototype.super=function(...a){return this.constructor.za.call(this,...a)});b.prototype.superCall||(b.prototype.superCall=function(a,
...d){return a?this.constructor.za.prototype[a].call(this,...d):this.constructor.za.call(this,...d)})}function Ja(b,c,a){Ia(a);va[b]=new wa(b,c,a)}var Ka=-1,La=-9,Ma=0;
function Ea(b,c){this.K=c;this.m=b;this.v="";this.g=this.o=0;this.h=null;if(!this.m||!this.m.aa)throw Error("fnm is not specified.");this.j=function(a,d){this.o=a;this.K.O(this.m,a,function(e,f){if(e)this.v=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,d){var e=null;if(this.h){if(this.h instanceof ArrayBuffer){var f=this.h.byteLength;0<f?(e=new Uint8Array(f+a.byteLength),e.set(new Uint8Array(this.h),0),e.set(new Uint8Array(a),f)):e=new Uint8Array(a)}else e=
0<this.h.length?new Uint8Array(this.h.concat(a)):new Uint8Array(a);this.h=null}else e=new Uint8Array(a);var g=new Blob([e],{type:"application/octet-binary"}),k="bytes "+this.g+"-";this.g+=g.size;k+=this.g-1+"/"+this.o;var l=0,m=function(){var n=new XMLHttpRequest;n.open("PUT",this.v,!0);n.setRequestHeader("Content-Range",k);n.onload=function(p){g=null;p=p.target;if(4==p.readyState){var y=this.K.ca(p);if(y==La)throw a=null,Error(p.responseText+" ("+p.status+")");if(y!=Ka&&y!=Ma&&y<this.g){var A=a instanceof
ArrayBuffer?a.byteLength:a.length;A-=this.g-y;if(0<A){A=a.slice(A);a=null;if(this.g>=this.o){this.write(A,d);return}this.h=A;this.g=y}else throw a=null,Error("Can NOT continue to upload buffer.");}d&&d(p.responseText)}}.bind(this);n.onerror=function(){1>l?(l++,setTimeout(function(){m()},500)):g=a=null};n.send(g)}.bind(this);m()};this.cancel=function(a){this.K.W(this.v,a)};this.C=function(){return this.o}}
function Fa(b,c){this.K=c;this.F=b;this.url="";this.name=null;this.I=this.m=this.h=this.size=0;this.S=!1;this.R=16E3;b.X&&(this.R=b.X);this.v=this.s=0;this.o=null;this.H=function(a,d){if(this.S){this.m&&(this.I=this.m,this.m=0);if(a){if(a>=this.g())throw console.log("offset:"+a+",size:"+this.g()),Error("offset can not be bigger than input size.");this.h=a}else this.h=0;d&&d()}else this.K.I(this.F,function(e,f){this.S=!0;if(e){this.size=e._size;this.url=e.l;this.name=e.u;this.v="1"==e._type?1:0;if(a){if(a>=
this.g())throw Error("offset can not be bigger than input size.");this.h=a}d&&d()}else throw Error(f.P+" ("+f.T+")");}.bind(this))};this.B=function(){return this.h};this.g=function(){return this.size};this.C=function(){return this.h>=this.g()};this.j=function(a){a||(a=this.R);this.L(a)};this.O=function(){};this.L=function(a){if(!a||!this.m){if(a)this.m=a;else if(this.m)a=this.m;else throw Error("size must be specified.");if(!this.I){var d=this.h+a-1,e=function(){var f=new XMLHttpRequest;10<=this.s?
(f.open("GET",xa(this.K),!0),f.setRequestHeader("Zb-Url",this.url)):f.open("GET",this.url,!0);this.K.ma(f,this.F.J);f.setRequestHeader("Range","bytes="+this.h+"-"+d);f.responseType="arraybuffer";f.onload=function(g){if(this.I)this.I=0,this.m&&this.L();else if(this.m=0,g=g.target,4==g.readyState)if(this.s=10>this.s?1:11,200==g.status||206==g.status){2==this.v&&(this.v=1);var k=parseInt(g.getResponseHeader("content-length"),10);k?this.h+=k:this.h=(k=ma(g.getResponseHeader("content-range")))?k+1:d+1;
200==g.status&&this.h<this.g()?this.h=this.g():this.h>this.g()&&(this.h=this.g());this.o&&this.o(g.response,this);g.response=null}else if(401==g.status&&1==this.v)console.log("Retry auth."),this.v=2,this.K.F(function(l){l?console.error(l):(this.F.J&&delete this.F.J,e())}.bind(this));else throw Error(g.responseText+" ("+g.status+")");}.bind(this);f.onerror=function(){if(0==this.s&&xa(this.K))this.s=10,e();else if(1==this.s||11==this.s)this.s++,setTimeout(function(){e()},500)}.bind(this);f.send()}.bind(this);
e()}}}};Ja("onedrive","Microsoft OneDrive",function(b,c){this.super(b,c);this.m=function(){return"onedrive"};this.S=function(a){H(this,"/me/drive",a,function(d){a&&a.i&&(d=JSON.parse(d).quota,a.i(!1,{Ha:d.deleted,Ga:d.total,pa:d.used}))})};this.o=function(a){var d="/me/drive/root/children";if(a){if(a._fname){var e=function(f){var g={$:"",i:function(k,l){if(a&&a.i)k?a.i(k):(k=[],l&&k.push(l),a.i(!1,k));else if(k)throw Error(JSON.stringify(k));}};Ha(a,g);this.j(g,f)}.bind(this);a.D?(d={$:a.D,i:function(f,g){if(f)if(a&&
a.i)a.i(f);else throw Error(JSON.stringify(f));else e(g.Ua.concat("/").concat(g.u).concat("/").concat(a._fname))}},Ha(a,d),this.j(d)):e("/drive/root:/".concat(a._fname));return}a.D&&(d="/me/drive/items/"+a.D+"/children")}H(this,d.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),a,function(f){if(a&&a.i){var g=[];f&&JSON.parse(f).value.forEach(function(k){g.push(this.ba(k))},this);a.i(!1,g)}}.bind(this))};this.s=function(a){this.j(a)};this.C=function(a){if(!a||
!a.M)throw Error("Name of new folder is not specified.");var d="/me/drive/root/children";a.D&&(d="/me/drive/items/"+a.D+"/children");var e=JSON.stringify({name:a.M,folder:{},"@microsoft.graph.conflictBehavior":"fail"});G(this,d,"POST",201,a,{"Content-Type":"application/json;charset=UTF-8"},e,function(f){a&&a.i&&(f=this.ba(JSON.parse(f.P)),a.i(!1,f))}.bind(this))};this.delete=function(a){var d="/me/drive/items/".concat(a.G);G(this,d,"DELETE",204,a,null,null,function(){a&&a.i&&a.i(!1)})};this.O=function(a,
d,e){d={Y:"/me",va:"POST",J:a.J,na:{"Content-Type":"application/json;charset=UTF-8","Cache-Control":"no-cache",Pragma:"no-cache"},i:function(f){f=Ga(f);var g="";200<=f.T&&299>=f.T&&(g=JSON.parse(f.P).uploadUrl);e(g,f)}.bind(this)};d.Y=a.V?"/me/drive/items/"+a.V+":/":d.Y+"/drive/root:/";d.Y+=a.aa;d.Y+=":/createUploadSession";d.Ca=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:a.aa}});ya(this,d)};this.ca=function(a){if(0<=[200,201].indexOf(a.status))return Ka;if(0>[202].indexOf(a.status))return La;
if((a=JSON.parse(a.responseText).nextExpectedRanges)&&a.length){var d=a[0].indexOf("-");if(0<d)return parseInt(a[0].substring(0,d),10)}return Ma};this.W=function(a,d){var e=new XMLHttpRequest;e.open("DELETE",a,!0);e.onload=function(f){f=f.target;if(4==f.readyState){var g={T:f.status,P:f.responseText};200<=f.status&&299>=f.status?d&&d(!1,g):(console.log(f.responseText+" ("+f.status+")"),d&&d(g))}}.bind(this);e.send()};this.I=function(a,d){var e="/me/drive/items/".concat(a.l),f={i:function(g,k){var l=
null;k&&!g&&(k=JSON.parse(k),l={l:k["@microsoft.graph.downloadUrl"],u:k.name,_size:k.size});d(l,g)}};a.J&&(f.J=a.J);H(this,e.concat(x({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f,function(g){f.i(!1,g)})};this.H=function(){return"https://graph.microsoft.com/v1.0"};this.L=function(a){if(!a||!a.G)throw Error("fid is not specified.");var d="/me/drive/items/".concat(a.G),e={};a.Z&&(e.name=a.Z);a.D&&(e.parentReference={id:a.D});e=JSON.stringify(e);if("{}"==e)throw Error("No property to be updated.");
G(this,d,"PATCH",200,a,{"Content-Type":"application/json;charset=UTF-8"},e,function(){a&&a.i&&a.i(!1)})};this.j=function(a,d){var e="";e=d?d.startsWith("/me")?d:"/me".concat(d):"/me/drive/items/"+a.$;G(this,e.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,a,null,null,function(f){if(a&&a.i)200==f.T?(f=this.ba(JSON.parse(f.P)),a.i(!1,f)):404==f.T&&d?a.i(!1):a.i(f);else if(200!=f.T)throw Error(JSON.stringify(f));}.bind(this))};this.ba=function(a){var d=
{l:a.id,u:a.name,_size:a.size,oa:a.lastModifiedDateTime,Ua:a.parentReference.path,_parentId:a.parentReference.id,_type:"0"};a.folder?d._type="1":a.file&&(d._type="2");return d}});Ja("googledrive","Google Drive",function(b,c){this.super(b,c);this.m=function(){return"googledrive"};this.S=function(a){var d=this.j("/about").concat(x({fields:"storageQuota"}));H(this,d,a,function(e){a&&a.i&&(e=JSON.parse(e).storageQuota,a.i(!1,{Ha:e.usageInDriveTrash,Ga:e.limit,pa:e.usage}))})};this.o=function(a){var d=this.j("/files"),e="'"+(a.D?a.D:"root")+"' in parents";a._fname&&(e=e.concat(" and name = '"+a._fname+"'"));H(this,d.concat(x({fields:"files(id,name,mimeType,parents,modifiedTime,size)",
q:e},!0)),a,function(f){if(a&&a.i){var g=[];JSON.parse(f).files.forEach(function(k){g.push(this.ba(k))},this);a.i(!1,g)}}.bind(this))};this.s=function(a){var d=this.j("/files/").concat(a.$);H(this,d.concat(x({fields:"id,name,mimeType,parents,modifiedTime,size"},!0)),a,function(e){a&&a.i&&(e=this.ba(JSON.parse(e)),a.i(!1,e))}.bind(this))};this.C=function(a){if(!a||!a.M)throw Error("Name of new folder is not specified.");var d=this.j("/files");G(this,d,"POST",200,a,{"Content-Type":"application/json;charset=UTF-8"},
JSON.stringify({mimeType:"application/vnd.google-apps.folder",name:a.M,parents:[a.D?a.D:"root"]}),function(e){a&&a.i&&(e=this.ba(JSON.parse(e.P)),a.i(!1,e))}.bind(this))};this.delete=function(a){var d=this.j("/files/").concat(a.G);G(this,d,"DELETE",204,a,null,null,function(){a&&a.i&&a.i(!1)})};this.O=function(a,d,e){var f=function(k){var l={},m="POST",n="/files?uploadType=resumable";k?(m="PATCH",n="/files/"+k+"?uploadType=resumable"):(l.name=a.aa,a.V&&(l.parents=[a.V]));k={Y:"/upload".concat(this.j(n)),
va:m,J:a.J,na:{"X-Upload-Content-Length":d,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"},Ca:JSON.stringify(l),i:function(p){var y=Ga(p),A="";200<=y.T&&299>=y.T&&(A=p.getResponseHeader("location"));e(A,y)}.bind(this)};ya(this,k)}.bind(this),g={i:function(k,l){k?e("",k):0<l.length?f(l[0].l):f()},_fname:a.aa,J:a.J};a.V&&(g.D=a.V);this.o(g)};this.ca=function(a){if(0<=[200,201].indexOf(a.status))return Ka;if(0>[308].indexOf(a.status))return La;if(a=
a.getResponseHeader("range")){var d=a.indexOf("-");if(0<d)return parseInt(a.slice(d+1),10)+1}return Ma};this.I=function(a,d){var e=this.j("/files/").concat(a.l),f={$:a.l,i:function(g,k){var l=null;k&&!g&&(l=k,l.l=this.H().concat(encodeURI(e)).concat(x({alt:"media"})),this.g.o&&(l._type="1"));d(l,g)}.bind(this)};a.J&&(f.J=a.J);this.s(f)};this.ma=function(a,d){d?a.setRequestHeader("Authorization",d):a.setRequestHeader("Authorization",this.h?this.h:"")};this.H=function(){return"https://www.googleapis.com"};
this.L=function(a){var d=!0,e=this.j("/files/").concat(a.G);a.Fa&&a.D&&(e=e.concat(x({addParents:a.D,removeParents:a.Fa})),d=!1);var f={};a.Z&&(f.name=a.Z,d=!1);if(d)throw Error("No property to be updated.");G(this,e,"PATCH",200,a,{"Content-Type":"application/json;charset=UTF-8"},JSON.stringify(f),function(){a&&a.i&&a.i(!1)})};this.j=function(a){return"/drive/v3".concat(a)};this.ba=function(a){var d={l:a.id,u:a.name,_size:a.size,oa:a.modifiedTime,_type:"2"};a.parents&&0<a.parents.length&&(d._parentId=
a.parents[0]);this.v(a.mimeType)&&(d._type="1");return d};this.v=function(a){return"application/vnd.google-apps.folder"==a}});function Na(b,c){this.K=c;this.L=b;this.h=null;this.m=this.size=0;this.R=!1;this.s=null;this.F=this.v=0;this.I=1600;b.X&&(this.I=b.X);this.o=null;this.H=function(a,d){console.log("offset:"+a);this.R?(this.S(a),d&&d()):this.K.I(this.L,function(e,f){if(e)this.size=e._size,this.K.Aa(this.L.l,function(g){this.h=g;this.h.sort(function(k,l){return k.da-l.da});this.S(a);this.R=!0;d&&d()}.bind(this));else throw Error(f.P+" ("+f.T+")");}.bind(this))};this.B=function(){return this.m};this.g=function(){return this.size};
this.C=function(){return this.h?this.v>=this.h.length:!0};this.j=function(a){console.log("read:"+a);this.s?this.W(a):this.K.ua(this.h[this.v].l,function(d){d=CryptoJS.enc.Base64url.parse(d);this.s=oa(d);this.W(a)}.bind(this))};this.O=function(){this.s=this.h=null};this.S=function(a){if(a){if(a>=this.g())throw Error("offset can not be bigger than input size.");this.m=a;var d=0;for(a=0;a<this.h.length&&!(d+=this.h[a]._size,this.m<d);a++)this.F=d;if(a<this.h.length)this.v=a;else throw Error("offset can not be bigger than input size.");
}else this.v=this.F=this.m=0;this.s=null};this.W=function(a){var d=this.m-this.F,e=this.s.length-d;a?a<e&&(e=a):this.I<e&&(e=this.I);a=new Uint8Array(this.s.slice(d,d+e));this.m+=e;this.s.length==d+e&&(this.s=null,this.v++,this.F=this.m);this.o&&this.o(a.buffer,this)}}
function Oa(b,c){this.K=c;this.g=b;this.data={l:"",u:"",_size:0,_parentId:"",_type:"2"};this.o=this.h=0;this.j=function(a,d){this.h=a;this.data.u=this.g.aa;this.g.V&&(this.data._parentId=this.g.V);this.K.O(this.g,a,function(e,f){if(e)this.data.l=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,d){var e=null;e=Array.isArray(a)?new CryptoJS.lib.WordArray.init(new Uint8Array(a)):new CryptoJS.lib.WordArray.init(a);this.data._size+=e.sigBytes;a=e.toString(CryptoJS.enc.Base64url);
this.o++;this.K.saveData(this.data.l,this.o,e.sigBytes,a,function(){this.data._size>=this.h?this.K.la(this.data,d):d&&d()}.bind(this))};this.cancel=function(a){this.K.delete({G:this.data.l,i:function(d){a&&a(d)}})};this.C=function(){return this.h}}
Ja("idxdb","Loacal Indexed DB",function(b,c){this.super(b,c);this.m=function(){return"idxdb"};this.F=function(a){this.ta(a)};this.S=function(a){var d={Ha:0,Ga:0,pa:0};this.v(function(e){e.getAllKeys().onsuccess=function(f){f.target.result.forEach(function(g){g=g.substring(g.indexOf(":")+1);d.pa+=parseInt(g.substring(g.indexOf("_")+1),10)})}},function(){a&&a.i&&a.i(!1,d)})};this.o=function(a){a&&a.i&&this.ha(a.i,void 0,a.D,a._fname)};this.s=function(a){a&&a.i&&this.ha(function(d,e){e&&0<e.length?a.i(d,
e[0]):a.i(d)},a.$)};this.C=function(a){if(!a||!a.M)throw Error("Name of new folder is not specified.");var d={l:"",u:a.M,_size:0,_parentId:"",_type:"1"};a.D&&(d._parentId=a.D);this.ka(d._parentId,function(e){d.l=e;this.la(d,function(){a.i&&a.i(!1,d)})}.bind(this))};this.delete=function(a){function d(l){var m=[];g.forEach(function(n){n.Ea&&"2"==n._type&&m.push(n.l)});0>m.indexOf(a.G)&&m.push(a.G);l.getAllKeys().onsuccess=function(n){n.target.result.forEach(function(p){var y=p.indexOf(":");0<=m.indexOf(p.substring(0,
y))&&(l.delete(p),k+=parseInt(p.substring(p.indexOf("_",y+1)+1),10))})}}function e(l){g.forEach(function(m){m.Ea&&l.delete(m.l)})}function f(l){var m;for(m=0;m<g.length;m++)g[m].l==l?g[m].Ea=!0:g[m]._parentId==l&&("1"==g[m]._type?f(g[m].l):g[m].Ea=!0)}var g=[],k=0;this.j(function(l){l.getAll().onsuccess=function(m){m.target.result.forEach(function(n){g.push({l:n.key,u:"",_parentId:n.pid})})}},function(){f(a.G);this.j(e,function(){this.v(d,function(){a&&a.i&&a.i(!1,k)})}.bind(this))}.bind(this))};
this.R=function(a){return new Oa(a,this)};this.O=function(a,d,e){e&&(d="",a.V&&(d=a.V),this.ka(d,function(f){e(f,{T:200,P:"nothing"})}))};this.ca=function(){return Ma};this.W=function(){};this.B=function(a){return new Na(a,this)};this.I=function(a,d){this.s({$:a.l,i:function(e,f){d(f,e)}})};this.H=function(){return""};this.L=function(a){if(!a||!a.G)throw Error("fid is not specified.");this.j(function(d){d.get(a.G).onsuccess=function(e){if(e=e.target.result){var f=!1;a.Z&&e.name!=a.Z&&(e.name=a.Z,
f=!0);a.D&&e.pid!=a.D&&(e.pid=a.D,f=!0);f&&d.put(e)}}},function(){a&&a.i&&a.i(!1)})};this.la=function(a,d){a.oa=this.Ba();var e={key:a.l,name:a.u,size:a._size,tms:a.oa,type:a._type};a._parentId&&(e.pid=a._parentId);this.j(function(f){f.put(e)},d)};this.saveData=function(a,d,e,f,g){this.v(function(k){k.put({key:a+":"+d+"_"+e,data:f})},g)};this.Aa=function(a,d){var e=[];this.v(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,
l)==a){var m=k.substring(l+1);l=m.indexOf("_");e.push({l:k,da:parseInt(m.substring(0,l),10),_size:parseInt(m.substring(l+1),10)})}})}},function(){d&&d(e)})};this.ua=function(a,d){if(d){var e="";this.v(function(f){f.get(a).onsuccess=function(g){e=g.target.result.data}},function(){d(e)})}};this.ta=function(a){if(window.indexedDB){var d=window.indexedDB.open("zgalocaldb");d.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
}.bind(this);d.onupgradeneeded=function(e){e=e.target.result;e.createObjectStore("items",{keyPath:"key"});e.createObjectStore("datas",{keyPath:"key"})}.bind(this);d.onsuccess=function(e){e.target.result.close();a&&a()}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};this.j=function(a,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("items","readwrite");
e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("items");a&&a(e)}.bind(this)};this.v=function(a,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("datas","readwrite");e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("datas");a&&a(e)}.bind(this)};this.ha=function(a,d,e,f){if(a){var g=[];this.j(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var n=!0;d&&(n=d==m.key);n&&e&&(n=e==
m.pid);n&&f&&(n=f==m.name);n&&g.push({l:m.key,u:m.name,_size:m.size,oa:m.tms,_type:m.type,_parentId:m.pid})})}},function(){a(!1,g)})}};this.Ba=function(){var a;a||(a=new Date);var d=[],e=[];d.push(a.getFullYear());d.push(a.getMonth()+1);d.push(a.getDate());e.push("0".concat(a.getHours()).slice(-2));e.push("0".concat(a.getMinutes()).slice(-2));e.push("0".concat(a.getSeconds()).slice(-2));return d.join("-")+" "+e.join(":")};this.ka=function(a,d){var e=-1;this.j(function(f){f.getAllKeys().onsuccess=
function(g){g.target.result.forEach(function(k){var l=k.indexOf("_");a&&0<l?k.substring(l+1)==a&&(l=parseInt(k.substring(0,l),10),l>e&&(e=l)):0>l&&(l=parseInt(k,10),l>e&&(e=l))})}},function(){e++;a?d(e+"_"+a):d(e.toString())})}});function Pa(b,c){var a=I;this.h=this.g=null;this.v=a;this.j=1;this.C=b;this.m=c;this.o=0;this.s=function(){this.m({_type:0,_wtype:this.j,_size:this.g.g()});var d=new ra({Da:1==this.j,ea:this.v,wa:this.g,Ia:this.h});d.H=function(){var e={_type:1,_wtype:this.j,_begin:this.o,_speed:d.O(),_pos:this.g.B(),_size:this.g.g()};this.m(e);return this.C()?!1:!0}.bind(this);d.m=function(e,f){var g={_type:2,_wtype:this.j,_begin:this.o,_pos:this.g.B(),_size:this.h.C()};e?g._err=e.message||e.$a:f?g._type=3:this.h.B&&
(g._blob=this.h.B());this.m(g)}.bind(this);this.o=Date.now();d.start()};this.B=function(d){var e=F;this.j=1;this.g=e.B({l:d,X:16E5});this.h=new pa;this.s()};this.H=function(d,e,f){var g=F;this.j=2;this.g=new qa({_blob:e,X:16E5});this.h=g.R({aa:d,V:f});this.s()}};var J=null,F=null,K=[],L=0,I=null,M=[],N=0,O=[];function P(b,c){N&&(window.clearTimeout(N),N=0);var a=q("#divMessage");if(0==b)a.style.display||(a.style.opacity="0",N=window.setTimeout(function(){N=0;u(a)},150));else{var d=h("span",a);1==b?(a.className="zb-notice",d[0].innerText="Notice"):(a.className="zb-alert",d[0].innerText="Error");d[1].innerText=c?c:"";a.style.opacity&&(t(a),N=window.setTimeout(function(){N=0;a.style.opacity=""},50))}}
function Q(b){var c="";"string"===typeof b?window.msgs&&b&&window.msgs[b]?c=window.msgs[b]:c=b:b&&(c=JSON.stringify(b));P(2,c)}function R(b){var c=b;window.msgs&&b&&window.msgs[b]&&(c=window.msgs[b]);P(1,c)}function Qa(b){R(b);N=setTimeout(function(){N=0;P(0)},3E3)}
function Ra(b,c){function a(e){Sa--;"error"==e.type&&(Ra.Ma=!0);if(0==Sa){var f=Ra.Ma;delete Ra.Ma;c&&c(f)}e=e.target||e.srcElement;e.hasAttribute("temporary")&&e.remove()}Sa++;var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",b);d.setAttribute("temporary","1");d.addEventListener("load",a);d.addEventListener("error",a);document.body.appendChild(d)}var Sa=0;
function Ta(b){J.L()&&(q("#chkSaveKey").checked?Ua(function(c){var a="";c&&c.lsauth&&(a=na(!0,b,c.lsauth).toString(CryptoJS.enc.Base64url));J.H("key_words",a,!0)}):J.H("key_words",null,!0))}function Va(){J.ia(function(){Ba()})}
function Ua(b){var c=new FormData;c.append("drive_type","localstorage");var a=new XMLHttpRequest;a.open("POST","/grantauth.php",!0);a.withCredentials=!0;a.onload=function(d){var e=d.target;4==e.readyState&&(d=null,200==e.status?(e=JSON.parse(e.responseText))?e.error?Q("["+e.error+"] "+e.error_description):e.lsauth?d=e:Q("lsFailed"):Q("lsFailed"):Q(e.responseText+" ("+e.status+")"),b&&b(d))};a.send(c)}
function Wa(b){var c=q("#divSet"),a=q("#selDrive"),d=q("btnLogout",c,"button.iid");b?(a.disabled=!0,t(d),u(".zb-nav-tools"),u("#divMain")):(a.disabled=!1,u(d));t(c)}
function Xa(b){if(!window.msgs||window.msgs.lang!=b){var c=window.msgs;window.msgs=null;Ra("msg/"+b+".js",function(){window.msgs?(window.msgs.lang=b,J.R(b),Ya()):(console.log("Message file of '"+b+"' is missing."),c?window.msgs=c:Ra("msg/en.js",function(){window.msgs?(window.msgs.lang="en",J.R(window.msgs.lang),Ya()):Q("Message file is missing.")}))})}}
function Ya(){var b=window.msgs;b.lblConfNotice=b.lblConfNotice.replace("{0}","_zgayard_.conf");var c=h("*"),a;for(a=0;a<c.length;a++){var d=c[a],e=null;d.hasAttribute("iid")&&(e=b[d.getAttribute("iid")])&&(d.innerText=e);!e&&d.hasAttribute("vid")&&(e=b[d.getAttribute("vid")])&&(d.value=e);!e&&d.id&&(e=b[d.id]);e&&("button"==d.type?d.value=e:d.innerText=e);d.hasAttribute("tid")&&(e=b[d.getAttribute("tid")])&&(d.title=e)}c=q("#seLang");a="";for(a in aa)d=document.createElement("option"),d.value=a,
d.innerText=aa[a],a==b.lang&&(d.selected=!0),c.appendChild(d)}function Za(b){R("loading");var c=va[b];c?(F=new c.g(J,"/grantauth.php"),F.F(function(a){if(a)J.ia(function(){Q(window.msgs.loginFailed.replace("{0}",a))});else{J.ma();var d=q("img",r("div",q("#spanQuota")));d.src="img/"+b+".png";d.alt=c.u;F.o({i:function(e,f){e?Q(JSON.stringify(e)):0==f.length?S(!0):$a(f[0].l)},_fname:"_zgayard_.conf"})}},!0)):Q("unkDrive")}
function ab(){var b=q("#selDrive"),c=!1;b.disabled||(c=J.ta(b.value));J.ua(q("#chkSkipLogin").checked);J.ca(q("#txtRelay").value);Xa(q("#seLang").value);c?(J.O(),Za(b.value)):J.ma();bb()}function bb(){var b=q("#selDrive");u("#divSet");b.disabled&&(t(".zb-nav-tools"),t("#divMain"))}
function cb(b,c){var a=q("#divPwd"),d="none";b?(a.setAttribute("addroot","1"),d=""):a.removeAttribute("addroot");b=h("*",a);for(a=0;a<b.length;a++){var e=b[a];e.classList.contains("addroot")?e.style.display=d:e.classList.contains("firstep")?"none"!=d&&c?t(e):u(e):e.classList.contains("chgroot")&&("none"==d?t(e):u(e));"password"==e.type&&(e.value="")}db()}
function eb(){if(window.confirm(window.msgs.delConfirm)){R("deleting");var b=q("#selRoot"),c=b.value,a=-1;K.forEach(function(f,g){f.root==c&&(a=g)});var d=function(){if(a==L)window.location.reload();else{var f=h("option",b),g;for(g=0;g<f.length;g++){var k=f[g];if(k.value==c){b.removeChild(k);break}}Qa("delrootDone")}};if(0<=a){var e=function(f){F.delete({i:function(g){g?Q(g.P):(K.splice(a,1),fb(d))},G:f})};F.o({i:function(f,g){f?console.error(f):0==g.length?(K.splice(a,1),fb(d)):e(g[0].l)},_fname:K[a].root})}else d()}}
function S(b){b?"boolean"===typeof b?cb(!0,!0):(u(".zb-nav-tools"),u("#divMain")):cb();t("#divPwd");P(0)}function gb(b){u("#divPwd");b&&0<M.length&&(t(".zb-nav-tools"),t("#divMain"))}function hb(){var b=v(r("div")),c=b.children[0].cloneNode(!0);c.value="";b.appendChild(c)}function db(){var b=q("#divfKey");b=h("file",b,"input.type");var c;for(c=b.length-1;0<c;c--)b[c].remove();b[0].value=""}
function ib(){R("loading");var b=q("#divPwd").hasAttribute("addroot"),c=q("#pwdKey").value,a=h("input",q("#divfKey")),d=[],e=0,f=0;for(e=0;e<a.length;e++){var g=a[e].files;for(f=0;f<g.length;f++)d.push(g[f])}if(c||0<d.length){if(b){a=q("#pwdKeyRe").value;if((c||a)&&c!=a){Q("diffPwd");return}if(!q("#txtRoot").value){Q("noRoot");return}}var k=null;c&&(k=CryptoJS.enc.Utf8.parse(c));if(0<d.length){var l=new FileReader,m=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA512,"zb12");e=0;l.g=function(){l.readAsArrayBuffer(d[e].slice(0,
1023));e++};l.onload=function(n){m.update(new CryptoJS.lib.WordArray.init(n.target.result));e<d.length?l.g():(k?k.concat(m.finalize()):k=m.finalize(),k.clamp(),jb(k,b))};l.g()}else jb(k,b)}else Q("noPwd")}
function jb(b,c){var a=CryptoJS.HmacMD5(b,"zgayard").toString(CryptoJS.enc.Base64url).slice(0,8),d=null;if(c){var e={root:q("#txtRoot").value};q("#chkEncryFname").checked&&(e.encfname=!0);var f=!1;K.forEach(function(l){l.root==e.root&&(f=!0)});f?Q("dupRoot"):(J.H("root",e.root),Ta(b),d=CryptoJS.lib.WordArray.random(1024),I=C(d),e.iv=a.concat(kb(!0,d,b)),L=K.length,K.push(e),lb(e,!0),fb())}else{var g=q("#selRoot").value,k=-1;K.forEach(function(l,m){l.root==g&&(k=m)});0<=k&&K[k].iv&&a==K[k].iv.slice(0,
a.length)?(L=k,J.H("root",g),Ta(b),d=kb(!1,K[L].iv.slice(a.length),b),I=C(d),mb()):fa(q("#divPwd"))?Q("pwdError"):S()}}function kb(b,c,a){a=C(a);var d=null;b?d=c:d=CryptoJS.enc.Base64url.parse(c);c=na(b,d,a);return b?c.toString(CryptoJS.enc.Base64url):c}function fb(b){var c=CryptoJS.enc.Utf8.parse(JSON.stringify(K));c=new Blob([new Uint8Array(oa(c))],{type:"application/octet-binary"});c=new qa({_blob:c,X:262144});var a=F.R({aa:"_zgayard_.conf"});ta(c,a,b||mb)}
function $a(b){var c=new pa;ta(F.B({l:b}),c,function(){var a=new CryptoJS.lib.WordArray.init(c.s());a=JSON.parse(a.toString(CryptoJS.enc.Utf8));Array.isArray(a)?K=a:K.push(a);var d=-1,e=J.C("root"),f=q("#selRoot");f.innerHTML="";K.forEach(function(k,l){var m=!1;e&&k.root==e&&(m=!0);lb(k,m,f);m&&(d=l)});if(0<=d){L=d;var g=J.C("key_words");g?Ua(function(k){k&&k.lsauth&&!k.newkey?(k=na(!1,CryptoJS.enc.Base64url.parse(g),k.lsauth),jb(k)):S()}):S()}else L=0,S()})}
function lb(b,c,a){a=a||q("#selRoot");var d=document.createElement("option");d.value=b.root;d.innerText=b.root;c&&(d.selected=!0);a.appendChild(d)}function nb(){window.confirm(window.msgs.dropConfirm)&&J.Oa(function(b){b?Q(b):Ba()})};var ob=3;function pb(b,c){switch(b){case "new":var a="spanNew";break;case "upload":a="spanUpload";break;case "selfldr":a="spanSelFldr";break;default:return}var d=q("#divModal"),e=q("#spanModal");e.innerText=window.msgs[a];a=h("div",v(e));var f;for(f=0;f<a.length;f++)e=a[f],e.hasAttribute("type")&&(e.getAttribute("type")==b?t(e):u(e));c&&(d.h=c);t(d)}function qb(){var b=r("zb-modal",q(),"div.class");b&&(b.h&&(b.h(),delete b.h),u(b))}
function rb(){function b(f){f&&qb()}var c="",a=h("div",v(q("#spanModal"))),d=0;for(d=0;d<a.length;d++){var e=a[d];if(e.hasAttribute("type")&&fa(e)){c=e.getAttribute("type");break}}switch(c){case "new":tb(b);break;case "upload":c=[];a=q("#upfiles").files;for(d=0;d<a.length;d++)c.push(a[d]);a=q("#upfolder").files;for(d=0;d<a.length;d++)c.push(a[d]);0>=c.length?Q("noFiles"):(b(!0),ub(c));break;case "selfldr":vb(b)}}function wb(b){return q(".zb-main-header",b).children[0]}
function xb(b){return q("zb-main-list",b,"ul.class")}function yb(b){return q("fnm",b,"span.name")}function zb(b){if(K[L].encfname){var c=I;b=CryptoJS.enc.Utf8.parse(b);c=na(!0,b,c).toString(CryptoJS.enc.Base64url)}else c=b;return c}function Ab(b){if(K[L].encfname)try{var c=I,a=CryptoJS.enc.Base64url.parse(b);return na(!1,a,c).toString(CryptoJS.enc.Utf8)}catch(d){console.error(d)}return b}
function Bb(){J=new ua;J.Qa(function(b){b&&Q("IndexedDB is not supported in your browser settings.");b=J.ka();b||(J.la(),b=J.ka(!0));if(!b){b=navigator.language;var c=b.indexOf("-");0<c&&(b=b.substring(0,c))}Xa(b);q("#txtRelay").value=J.W();b=J.Aa();c=q("#selDrive");var a=ka(),d;for(d in va){var e=document.createElement("option");e.value=d;e.innerText=va[d].u;b?b==d&&(e.selected=!0):a&&a.state==va[d].l&&(b=d,e.selected=!0);c.appendChild(e)}J.L()?(J.o&&(q("#chkSkipLogin").checked=!0),J.C("key_words")&&
(q("#chkSaveKey").checked=!0)):(u("#divSkipLogin"),u("#divSaveKey"));b?Za(b):Wa()})}function mb(){gb();t(".zb-nav-tools");t("#divMain");Cb(function(){var b=K[L].root;F.o({_fname:b,i:function(c,a){c?Q(JSON.stringify(c)):a&&0<a.length?(M=[],M.push(a[0]),T(),Db()):F.C({M:b,i:function(d,e){d?Q(JSON.stringify(d)):(M=[],M.push(e),T())}})}})})}
function Eb(b,c){var a=q("#spanQuota");"string"==typeof b&&(b=parseInt(b,10));var d=w(a,"total"),e=w(a,"trash"),f=0;a.hasAttribute("used")&&(f=w(a,"used"));if(c){if(f-=b,a.setAttribute("used",f),0<d){a.setAttribute("trash",e+b);return}}else f+=b,a.setAttribute("used",f);a.innerText=0<d?window.msgs.quotaInfo.replace("{0}",B(d-f-e)):window.msgs.quotaInfoU.replace("{0}",B(f))}
function Cb(b){F.S({i:function(c,a){c?Q(c):(c=q("#spanQuota"),c.setAttribute("total",a.Ga),c.setAttribute("trash",a.Ha),Eb(a.pa),b&&b())}})}function Fb(b){function c(d,e){d=q(d,a,"div.class");e=q("menuHistory",d,e.concat(".iid"));e=r("li",e);b?t(e):u(e)}var a=q("nav");c("zb-nav-tools","span");c("zb-nav-menu","label")}
function Db(){if(O=J.Pa()){var b=q("ul","#divHistory"),c=function(a){if(a>=O.length)0<O.length&&Fb(!0);else{var d=O[a];F.s({$:d.G,i:function(e,f){e||(f._parentId&&(d.M=f._parentId),Gb(a,Ab(f.u),b),c(a+1))}})}};c(0)}}
function Gb(b,c,a){a||(a=q("ul","#divHistory"));b=O[b];var d=null,e=q(b.M,a,"li.parentId");if(null==e){e=q("template",a,"li.class").cloneNode(!0);e.classList.remove("template");var f=h("span",e),g;for(g=0;g<f.length;g++){var k=f[g];switch(k.getAttribute("name")){case "delete":k.addEventListener("click",Hb);break;case "file":k.addEventListener("click",Ib);d=k;break;case "next":k.addEventListener("click",Jb)}}e.setAttribute("parentId",b.M);a.appendChild(e)}else d=q("file",e,"span.name");d.innerText=
c;b.ga&&(c=d,a=d.innerText.concat(" ["),d=a.concat,b=Math.floor(b.ga),e=Math.floor(b/3600),b-=3600*e,f=Math.floor(b/60),b-=60*f,g=[],0<e?(g.push(e.toString()),g.push("0".concat(f).slice(-2))):g.push(f.toString()),g.push("0".concat(b).slice(-2)),c.innerText=d.call(a,g.join(":")).concat("]"))}
function T(b,c,a,d){var e=0;if(!a){if(0>=M.length)return;e=M.length-1;a=M[e]}var f="#divMain";c&&(f="#divModal");var g=0;g=q(f);f=wb(g);var k=xb(g);R("loading");var l=U(k);for(g=0;g<l.length;g++)k.removeChild(l[g]);(g=ha(f,void 0,!0))&&g.classList.contains("template")&&(g=null);b?g&&g.classList.remove("normal"):(g&&(0!=e||c)&&g.classList.add("normal"),Kb(f,a,e));F.o({i:function(m,n){if(m)Q(m);else{var p=[],y=0;n.forEach(function(D){var W=0,sb=p.length;D.u=Ab(D.u);for(V(D)?sb=y++:W=y;W<sb&&!(D.u<p[W].u);)W++;
W<p.length?p.splice(W,0,D):p.push(D)});p.forEach(function(D){c&&!V(D)||Lb(k,D)});if(!c){m=q("#chkAll");var A=r("li",m);q("checkbox",A,"input.type").checked=!1;u(q("chkbox",A,"span.name"));0<n.length?t(m):u(m)}d?d(p):P(0)}},D:a.l})}
function Kb(b,c,a,d){var e=q("template",b,"li.class").cloneNode(!0);q("span",e).innerText=c.u;e.setAttribute("name","folder");e.setAttribute("uid",c.l);e.setAttribute("idx",a);e.addEventListener("click",Mb);e.classList.remove("template");d&&e.classList.add("normal");t(e);b.appendChild(e)}
function Lb(b,c){var a=c.u,d="",e="",f=q("template",b,"li.class").cloneNode(!0);f.classList.remove("template");f.setAttribute("uid",c.l);f.setAttribute("utype",c._type);var g=h("span",f),k;for(k=0;k<g.length;k++){var l=g[k];switch(l.getAttribute("name")){case "fnm":l.innerText=a;l.addEventListener("click",X);break;case "icon":if(V(c))z(l,"folder","#FFD679");else{var m=Nb(a);ba[m]?z(l,"image","#E7FFE7"):ca[m]?z(l,"video","#FFE7F3"):z(l,"file","#FFFFB0")}l.addEventListener("click",Ob);break;case "chkbox":l.addEventListener("click",
Ob);u(l);break;case "edit":l.addEventListener("click",Pb);break;case "size":d||(d=B(c._size));l.innerText=d;break;case "tms":if(!e)if(e=c.oa){e=new Date(e);m=[];var n=[];m.push(e.getFullYear());m.push(e.getMonth()+1);m.push(e.getDate());n.push("0".concat(e.getHours()).slice(-2));n.push("0".concat(e.getMinutes()).slice(-2));n.push("0".concat(e.getSeconds()).slice(-2));e=m.join("-")+" "+n.join(":")}else e="";l.innerText=e}}t(f);b.appendChild(f)}
function Qb(b,c){1!=c&&-1!=c&&(c=q("checkbox",b,"input.type"),c.checked=!c.checked,c=c.checked?1:-1);0<c?t(q("chkbox",b,"span.name")):u(q("chkbox",b,"span.name"))}function Ob(){Qb(r("li"))}function X(b,c,a){var d=null,e=!1;"string"!=typeof b&&(d=r("li"),b=d.getAttribute("uid"),e="selfldr"==r("div",d).getAttribute("type"));if(c||!d)d=Rb(b,c,a),b=d.getAttribute("uid");c={l:b,u:yb(d).innerText,_type:d.getAttribute("utype")};V(d)?e?T(!1,!0,c):(M.push(c),T()):Sb(c.l,c.u)}
function Mb(){for(var b=r("li"),c=r("ul",b),a="selfldr"==r("div",c).getAttribute("type"),d=0,e=v(b);e;)e.tagName==b.tagName&&d++,e=v(e);if(0<d)for(e=0;e<d;e++)c.removeChild(c.lastElementChild);a?T(!0,!0,{u:q("span",b).innerText,l:b.getAttribute("uid")}):(d=w(b,"idx"),d<M.length-1&&M.splice(d+1),T(!0))}function V(b){return"1"==(b instanceof HTMLElement?b.getAttribute("utype"):"string"==typeof b?b:b._type)}function Nb(b){var c=b.lastIndexOf("."),a="";0<=c&&(a=b.slice(c+1));return a.toLowerCase()}
function Tb(){var b=r("li"),c=q("checkbox",b,"input.type");Qb(b);var a=-1;c.checked&&(a=1);b=h("li",r("ul",b));for(c=0;c<b.length;c++)b[c].classList.contains("header")||b[c].classList.contains("template")||Qb(b[c],a)}
function Pb(b){var c=r("span"),a=c.getBoundingClientRect();c=r("li",c);var d=q("#ulIteMenu");d.hasAttribute("ofwid")||d.setAttribute("ofwid",d.offsetWidth);a.right+d.getAttribute("ofwid")>document.body.offsetWidth?d.style.left=a.left-d.getAttribute("ofwid")+"px":d.style.left=a.right+"px";d.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+a.top+"px";d.setAttribute("uid",c.getAttribute("uid"));d.setAttribute("utype",c.getAttribute("utype"));b.ra=ob}
function Rb(b,c,a){if(!b)return null;var d=xb("#divMain");d=U(d);var e;for(e=0;e<d.length&&d[e].getAttribute("uid")!=b;e++);if(e>=d.length)return null;switch(c){case 1:for(;0<=e;){e--;if(0>e){if(a)return null;a=!0;e=d.length-1}if(!V(d[e]))break}break;case 2:for(;e<d.length;){e++;if(e>=d.length){if(a)return null;a=!0;e=0}if(!V(d[e]))break}}return d[e]}
function Ub(b){var c=r("li"),a=r("ul",c),d=a.getAttribute("uid");if(d)switch(q("label",c).getAttribute("iid")){case "menuDownload":V(a)?Q("noDownFolder"):Vb(d);break;case "menuRename":c=q("#divInpName");a=q("input",c);var e=Rb(d);d=yb(e);var f=d.getBoundingClientRect();e=q("edit",e,"span.name").getBoundingClientRect();a.value=d.innerText;c.style.left=f.left+"px";c.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+f.top-2+"px";a.style.width=e.left-f.left+"px";a.style.height=f.height+
2+"px";t(c);a.focus();b.ra=4;break;case "menuMove":Wb(d);break;case "menuDelete":Xb(d)}}function Vb(b){var c=Rb(b);b={u:yb(c).innerText,l:b};Yb([b])}function Wb(b){var c=void 0,a=q("#divModal");if("string"==typeof b)a.setAttribute("uid",b);else if(Zb())a.removeAttribute("uid"),c=b;else return;b=wb(a);a=U(b);var d;for(d=0;d<a.length;d++)b.removeChild(a[d]);T(!1,!0,M[0]);pb("selfldr",c)}
function $b(b){if(13===b.keyCode){if(b.shiftKey||b.ctrlKey||b.altKey)return!0}else return 27===b.keyCode?(u(r("div")),!1):!0;ac();return!1}function ac(){var b=r("div"),c=q("input",b);if(c.value){var a=q("#ulIteMenu").getAttribute("uid"),d=Rb(a);if(d){var e=yb(d);c.value!=e.innerText&&(d=zb(c.value),Ca({i:function(f){f?Q(f.P):(e.innerText=c.value,Qa("renDone"))},G:a,Z:d}))}u(b)}else Q("noNewName")}
function vb(b){var c=q("#divModal"),a=wb(c);a=ha(a,"li",!0).getAttribute("uid");if(a==M[M.length-1].l)b&&b(!1);else{b&&b(!0);var d=[];(b=c.getAttribute("uid"))?d.push({l:b,u:""}):d=Zb();if(0!=d.length){R("moving");var e=0,f={i:function(g){g?Q(g.P):(e++,e<d.length?(f.G=d[e].l,Da(f)):T(!0,!1,void 0,function(){Qa("moveDone")}))},G:d[e].l,D:a,Fa:M[M.length-1].l};Da(f)}}}
function Xb(b){var c=null;b?c=[{l:b,u:""}]:c=Zb();if(c&&confirm(window.msgs.delConfirm)){R("deleting");var a=0,d={i:function(e,f){e?Q(e.P):(f&&Eb(f,!0),a++,a<c.length?(d.G=c[a].l,F.delete(d)):(T(!0),Qa("delDone")))},G:c[a].l};F.delete(d)}}function tb(b){var c=q("#fldnm").value;if(c){var a={i:function(d,e){d?(Q(d.P),b&&b(!1)):(e.u=c,Lb(xb("#divMain"),e),Qa("flDone"),b&&b(!0))},M:zb(c)};0<M.length&&(a.D=M[M.length-1].l);F.C(a)}else Q("noFldName"),b&&b(!1)}
function Zb(b){var c=[],a=U(xb("#divMain")),d;for(d=0;d<a.length;d++)if(q("checkbox",a[d],"input.type").checked){if(b&&V(a[d]))return Q("noDownFolder"),null;c.push({u:yb(a[d]).innerText,l:a[d].getAttribute("uid")})}return 0>=c.length?(Q("noChecks"),null):c}
function Sb(b,c){var a=q("#diViewer"),d=r("zb-viewer",a,"div.class"),e=q("title",d,"span.name"),f=q("span",a),g=q("img",a),k=bc(a);f.innerText=window.msgs.loading;t(f);u(v(f));u(g);e.innerText=c;g.src="";a.setAttribute("uid",b);t(r("zb-modal",d,"div.class"));a=Nb(c);var l=ba[a];if(ca[a])cc(k,b,c),t(k),u(f);else if(l){var m=new pa;b=new ra({Da:!0,ea:I,wa:F.B({l:b,X:16E4}),Ia:m});b.m=function(n,p){n||p?console.log(n||p):(n=m.s(),n instanceof Uint8Array||(n=new Uint8Array(n)),l&&(g.src=window.URL.createObjectURL(new Blob([n],
{type:l})),t(g),u(f)))};b.start()}else f.innerText=window.msgs.cantView,t(v(f))}function dc(b){var c=q(b?b:"#diViewer");c=v(c,"div");var a="";if(b){if(c.style.opacity)return;a="1"}for(;c;)c.style.opacity=a,c=v(c,"div");b&&window.setTimeout(dc,5E3)}function ec(){var b=q("#diViewer").getAttribute("uid");b&&X(b,1)}function fc(){var b=q("#diViewer").getAttribute("uid");b&&X(b,2)}function hc(){bc(q("#diViewer"));qb()}function ic(){var b=q();b&&b.src&&window.URL.revokeObjectURL(b.src)}
function cc(b,c,a){var d=F.B({l:c});const e=zb_require("videostream");b.g=c;b.m=a;b.o=new sa({Da:!0,ea:I,wa:d});b.j=new e(b.o,b)}function bc(b){b=q("video",b);if(b.g){var c=M[M.length-1].l,a=b.m,d;O||(O=[]);for(d=0;d<O.length;d++)if(O[d].M==c){O[d].G=b.g;O[d].ga=b.currentTime;break}d==O.length&&O.push({G:b.g,M:c,ga:b.currentTime});delete b.g;delete b.m;J.Sa(O[d],d);Gb(d,a);Fb(!0)}u(b);b.j&&(b.j.destroy(),b.o.La(),delete b.j,delete b.o);return b}
function jc(b){if((b=b.getAttribute("parentId"))&&O){var c;for(c=0;c<O.length;c++)if(O[c].M==b)return c}return-1}
function Ib(b,c){q("close","#divHistory","span.name").click();b=q(b);b=r("li",b);b=jc(b);if(!(0>b)){b=O[b];var a=b.G,d=b.M,e=b.ga;R("loading");var f=[],g=function(){d?F.s({$:d,i:function(l,m){l||(m.u=Ab(m.u),f.unshift(m),m._parentId==M[0].l?(f.unshift(M[0]),k()):(m._parentId==M[0]._parentId?d=void 0:d=m._parentId,g()))}}):R()},k=function(){var l=wb("#divMain"),m=0,n=h("li",l);for(m=0;m<n.length;m++)n[m].hasAttribute("template")||n[m].remove();for(m=0;m<f.length;m++)Kb(l,f[m],m,!0);M=f;T(!0,!1,void 0,
function(p){var y;for(y=0;y<p.length&&p[y].l!=a;y++);y<p.length&&(c?X(a,2):(e&&q("video","#diViewer").setAttribute("ctime",e),X(a)))})};g()}}function Jb(b){Ib(b,!0)}function kc(b){b=q(b);var c=b.getAttribute("ctime");c&&(b.removeAttribute("ctime"),b.currentTime=c)}function Hb(b){b=q(b);b=r("li",b);var c=jc(b);0>c||(b.remove(),O.splice(c,1),J.Ra(c),0==O.length&&Fb(!1))};const lc=window.Worker?!0:!1;var Y=null;function mc(b){this.h=b;this.g=[];this.m=function(c){return this.h.l==c.l};this.s=function(c){return this.h.u==c};this.o=function(c){var a;for(a=0;a<this.g.length;a++)if(this.g[a].s(c))return this.g[a];return null};this.j=function(c){var a;for(a=0;a<this.g.length;a++)if(this.g[a].m(c))return this.g[a];c=new mc(c);this.g.push(c);return c}}var nc=null;
function U(b,c){var a=[],d=b.getElementsByTagName("li");for(b=0;b<d.length;b++){var e=d[b];if(!e.classList.contains("header")&&!e.classList.contains("template"))if(c){var f=c(e);2!=f&&-2!=f||a.push(e);if(0>f)break}else a.push(e)}return a}function oc(b){b=q(b);u(b);Y?(b=r("li",b),b={_type:9,_rowIdx:w(b,"rowIdx")},Y.postMessage(b)):b.setAttribute("canceled","1")}
function pc(b,c,a){var d=0,e=0;c||(c=q(".zb-qbutton"));!a&&c.hasAttribute("count")&&(a=w(c,"count"));c.hasAttribute("fincount")&&(d=w(c,"fincount"));c.hasAttribute("stopcount")&&(e=w(c,"stopcount"));switch(b){case 1:d++;c.setAttribute("fincount",d);break;case 3:c.setAttribute("haserr","1");case 2:e++,c.setAttribute("stopcount",e)}0<a?q("div",c).style.width=Math.floor(100*d/a)+"%":q("div",c).style.width="0%";a==d+e&&(c.hasAttribute("haserr")?c.classList.add("error"):c.classList.add("done"))}
function qc(b){var c=q(".zb-qbutton"),a=0;c.hasAttribute("count")&&(a=w(c,"count"));a+=b;c.setAttribute("count",a);pc(0,c,a);c.classList.contains("error")&&c.classList.remove("error");c.classList.contains("done")&&c.classList.remove("done");t(c)}
function rc(b){b=r(".zb-queue",q(b));var c=q(".zb-qbutton");b.style.top="100%";if(c.classList.contains("done")||c.classList.contains("error")){u(c);c.removeAttribute("count");c.removeAttribute("fincount");c.removeAttribute("stopcount");c.removeAttribute("haserr");b=q("ul",b);c=U(b);var a;for(a=c.length-1;0<=a;a--)b.removeChild(c[a]);b.removeAttribute("rowCount")}}
function sc(b,c,a){var d=0;b.hasAttribute("rowCount")&&(d=w(b,"rowCount"));var e=q("template",b,"li.class").cloneNode(!0);e.classList.remove("template");e.setAttribute("rowIdx",d);a&&e.setAttribute("downFl",1);b.setAttribute("rowCount",d+1);d=h("span",e);var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "cancel":g.addEventListener("click",oc);break;case "icon":q("label",g).innerText=c;a?z(g,"download"):z(g,"upload");break;case "elTime":ha(g,"label").innerText=window.msgs.elTime;
break;case "esTime":ha(g,"label").innerText=window.msgs.esTime;break;case "speed":g.innerText=window.msgs.waiting}}b.appendChild(e);return e}function tc(b,c){c||(c=q("ul","#divQueue"));c=U(c,function(a){return a.getAttribute("rowIdx")==b?-2:1});return 0<c.length?c[0]:null}
function uc(b,c){var a=null,d=h("span",b),e="";switch(c._type){case 0:e="0%";break;case 1:e=Math.round(100*c._pos/c._size)+"%";break;case 2:e="100%"}var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "icon":a=g;break;case "percent":switch(c._type){case 0:case 1:g.innerText=e;break;case 2:c._err||(g.innerText=e)}break;case "elTime":switch(c._type){case 1:case 2:case 3:g.innerText=la(Math.floor((Date.now()-c._begin)/1E3))}break;case "esTime":switch(c._type){case 1:g.innerText=
la(Math.round((c._size-c._pos)/c._speed))}break;case "speed":switch(c._type){case 1:g.innerText=B(c._speed)+"/s";break;case 2:case 3:c._err||(b.classList.add("done"),g.innerText=window.msgs.avspeed.replace("{0}",B(1E3*c._pos/(Date.now()-c._begin))))}break;case "cancel":switch(c._type){case 0:t(g);break;case 2:case 3:var k=q("svg",g);k.removeChild(k.firstElementChild);c._err||3==c._type?(z(g,"multi"),pc(c._err?3:2)):(z(g,"chkbox",void 0,"#10B981"),pc(1));t(g)}break;default:if((k=r("div",g))&&k.classList.contains("zb-progressbar"))switch(c._type){case 0:case 1:g.style.width=
e;break;case 2:c._err?(b.classList.add("error"),k.innerText=c._err):g.style.width=e}}}return a}function vc(b,c){c=tc(b._rowIdx,c);wc(c,b)}function wc(b,c){var a=!1;switch(c._type){case 0:case 1:uc(b,c);break;case 2:c._finished&&Y&&xc();b=uc(b,c);c._err||(2==c._wtype?Eb(c._size):1==c._wtype&&c._blob&&(b=q("label",b).innerText,ia(c._blob,b,q("#lnkDown"))));window.gc&&window.gc();a=!0;break;case 3:c._finished&&Y&&xc(),uc(b,c),window.gc&&window.gc(),a=!0}return a}
function xc(){var b=Y;nc=Y=null;b.terminate();b.g&&T(!0)}function yc(b){Y||(Y=new Worker("worker.js"),Y.h={_token:F.h?F.h:"",_iv:I.iv.toString(CryptoJS.enc.Base64url),_key:I.key.toString(CryptoJS.enc.Base64url),_drvnm:F.m()},Y.addEventListener("message",function(c){vc(c.data)}));b._cominf=Y.h;2!=b._type||Y.g||(Y.g=!0);Y.postMessage(b)}
function zc(b,c){var a=w(b,"rowIdx"),d=q("cancel",b,"span.name");return new Pa(function(){return d.getAttribute("canceled")?!0:!1},function(e){e._rowIdx=a;wc(b,e)&&c()})}
function Yb(b){var c=q("ul","#divQueue"),a=0;qc(b.length);for(a=0;a<b.length;a++){var d=sc(c,b[a].u,!0);lc?yc({_type:1,_rowIdx:w(d,"rowIdx"),_downinf:{_targetId:b[a].l}}):b[a]._parentId=d.getAttribute("rowIdx")}if(!lc){var e=function(f){var g=tc(parseInt(b[f]._parentId,10),c);zc(g,function(){f++;f<b.length&&e(f)}).B(b[f].l)};e(0)}}
function ub(b){function c(l){var m=d[l];Ac(k,m.Ta,function(n,p,y){n?vc({_type:2,_wtype:2,_rowIdx:m.da,_size:0,_err:JSON.stringify(n)},a):lc?(yc({_type:2,_rowIdx:m.da,_upinf:{_fname:p,_file:m._file,_parentId:y}}),l++,l<d.length&&c(l)):(n=tc(m.da,a),zc(n,function(){l++;l<b.length?c(l):T(!0)}).H(p,m._file,y))})}var a=q("ul","#divQueue"),d=[],e=0;qc(b.length);for(e=0;e<b.length;e++){var f="";f=b[e].webkitRelativePath?b[e].webkitRelativePath:b[e].name;var g=sc(a,f);d.push({Ta:f,_file:b[e],da:w(g,"rowIdx")})}nc||
(nc=new mc(M[0]));var k=nc;for(e=1;e<M.length;e++)k=k.j(M[e]);c(0)}function Ac(b,c,a){var d=c.split("/"),e=zb(d.pop()),f=b;if(0==d.length)a(!1,e,f.h.l);else{var g=!1,k=function(l){function m(A){f=A;l++;l<d.length?k(l):a(!1,e,f.h.l)}var n=d[l],p=zb(n);if(g)F.C({M:p,D:f.h.l,i:function(A,D){A?a(A,e):(D.u=n,m(f.j(D)))}});else{var y=f.o(n);y?m(y):F.o({_fname:p,D:f.h.l,i:function(A,D){A?a(A,e):0==D.length?(g=!0,k(l)):(D[0].u=n,m(f.j(D[0])))}})}};k(0)}};var Z=null;function Bc(b){switch(b){case 1:b=q(".zb-nav-tools");b={U:q("button",b),N:v(b)};break;case 2:b=q("button",q(".zb-main-header","#divMain"));b={U:b,N:v(b)};break;case ob:b={N:q("#ulIteMenu")};break;default:return null}return b}function Cc(b){var c=Bc(b);c&&(c.N.style.display&&(c.N.style.maxHeight="0px"),c.U&&c.U.addEventListener("click",function(a){a.ra=b}))}
function Dc(b,c){var a=Bc(c);a&&(a.N.style.display?a.N.style.maxHeight&&b.ra==c&&(t(a.N),a.N.style.paddingTop="",a.N.style.paddingBottom="",a.U&&(u(a.U.children[0]),t(a.U.children[1])),window.setTimeout(function(){a.N.style.maxHeight=""},50)):a.N.style.maxHeight||b.ra==c&&!a.U||(a.N.style.paddingTop="0px",a.N.style.paddingBottom="0px",a.N.style.maxHeight="0px",window.setTimeout(function(){a.U&&(t(a.U.children[0]),u(a.U.children[1]));u(a.N)},500)))}
function Ec(b){Dc(b,1);Dc(b,2);Dc(b,ob);4!=b.ra&&u("#divInpName")}function Fc(b){b=b.target||b.srcElement;"INPUT"!=b.tagName&&(b=q("input",r("div",b)),b.focus(),b.click())}function Gc(b){var c=r("li",b);switch(b.getAttribute("iid")){case "menuGeneral":c.addEventListener("click",Wa);break;case "menuDrive":c.addEventListener("click",S);break;case "menuHistory":c.addEventListener("click",function(){q("#divHistory").style.top=""})}}
function Hc(){var b=q("label",r("li")),c=b.getAttribute("iid"),a=void 0;(b=v(b))&&(a=function(){b.classList.remove("rotate-90")});switch(c){case "menuNewFldr":b&&b.classList.add("rotate-90");pb("new",a);break;case "menuUpload":b&&b.classList.add("rotate-90");pb("upload",function(){q("#upfiles").value=null;q("#upfolder").value=null;a&&a()});break;case "menuMovefs":b&&b.classList.add("rotate-90");Wb(a);break;case "menuDownfs":(c=Zb(!0))&&Yb(c);break;case "menuDelfs":Xb()}}
window.addEventListener("load",function(){var b=RegExp("android","i").test(navigator.userAgent),c=q("#divMessage"),a=h("span",c);a[a.length-1].children[0].addEventListener("click",function(){P(0)});document.addEventListener("click",Ec);Cc(1);Cc(2);Cc(ob);var d=0;c=0;a=h("span",q(".zb-nav-tools"));for(d=0;d<a.length;d++)Gc(a[d]);a=h("label",q(".zb-nav-menu"));for(d=0;d<a.length;d++)Gc(a[d]);a=h(".zb-settings");for(d=0;d<a.length;d++){var e=h(".checkbox",a[d]);for(c=0;c<e.length;c++)e[c].addEventListener("click",
Fc)}a=h("button",q("#divSet"));for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("iid")){case "btnLogout":c.addEventListener("click",Va);break;case "btnCancel":c.addEventListener("click",bb);break;case "btnOk":c.addEventListener("click",ab)}a=h("span",q("#divPwd"));for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("tid")){case "spanAddRoot":c.addEventListener("click",cb);break;case "spanDeleteRoot":c.addEventListener("click",eb);break;case "spanMoreKey":b?c.addEventListener("click",hb):c.style.display=
"none";break;case "spanClearKey":b?c.addEventListener("click",db):c.style.display="none"}a=h("button",q("#divPwd"));for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",gb);break;case "btnOk":c.addEventListener("click",ib);break;case "btnDropDb":c.addEventListener("click",nb)}c=q("#divModal");c.addEventListener("click",qb);c.children[0].addEventListener("click",function(f){f.stopPropagation()});a=h("button",c);for(d=0;d<a.length;d++)switch(c=a[d],
c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",qb);break;case "btnOk":c.addEventListener("click",rb)}a=h(".zb-main-menu");for(d=0;d<a.length;d++)for(b=h("li",a[d]),c=0;c<b.length;c++)b[c].addEventListener("click",Hc);c=q("#chkAll");c.addEventListener("click",Tb);v(c).addEventListener("click",Tb);a=h("li","#ulIteMenu");for(d=0;d<a.length;d++)a[d].addEventListener("click",Ub);c=q("#divInpName");c.addEventListener("click",function(f){f.stopPropagation()});q("input",c).addEventListener("keyup",
$b);q("span",c).addEventListener("click",ac);c=q("#diViewer");c.addEventListener("click",dc);c.addEventListener("touchstart",function(f){Z||1!=f.changedTouches.length||(f=f.changedTouches[0],Z={l:f.identifier,Wa:f.screenX,Xa:f.screenY})});c.addEventListener("touchend",function(f){if(Z){var g=null,k;for(k=0;k<f.changedTouches.length;k++)if(f.changedTouches[k].identifier==Z.l){g=f.changedTouches[k];break}g&&(f=g.screenX-Z.Wa,g=g.screenY-Z.Xa,10>g&&-10<g&&(50<f?fc():-50>f&&ec()),Z=null)}});q("button",
c).addEventListener("click",function(){Vb(r("div").getAttribute("uid"))});q("img",c).addEventListener("load",ic);c=q("video",c);c.addEventListener("canplay",kc);c.addEventListener("ended",function(){X(r("div").getAttribute("uid"),2,!0)});screen.orientation.addEventListener("change",function(f){"landscape-primary"==f.currentTarget.type?(f=q("#diViewer"),fa(q("video",f))&&r("div",f,void 0,!0).requestFullscreen()):document.fullscreen&&document.exitFullscreen()});document.addEventListener("fullscreenchange",
function(){document.fullscreen?q("#diViewer").classList.add("full"):q("#diViewer").classList.remove("full")});c=r("zb-viewer",c,"div.class");a=h("span",c);for(d=0;d<a.length;d++)switch(a[d].getAttribute("name")){case "close":a[d].addEventListener("click",hc);break;case "previous":a[d].addEventListener("click",ec);break;case "next":a[d].addEventListener("click",fc);break;case "fullscreen":a[d].addEventListener("click",function(){r("div","#diViewer",void 0,!0).requestFullscreen()})}c=r("zb-modal",c,
"div.class");c.addEventListener("click",hc);c.children[0].addEventListener("click",function(f){f.stopPropagation()});q(".zb-qbutton").addEventListener("click",function(){q("#divQueue").style.top=""});q("close","#divQueue","span.name").addEventListener("click",rc);q("close","#divHistory","span.name").addEventListener("click",function(){q("#divHistory").style.top="100%"});Bb()});
