var h;function aa(a){function c(d){return a.next(d)}function b(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(c,b).then(f,e)}f(a.next())})}function n(a){return aa(a())};const ba={en:"English",ja:"日本語"},ca={bmp:"image/bmp",gif:"image/gif",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",webp:"image/webp"},da={aac:"audio/aac",mp3:"audio/mpeg",wav:"audio/wav"},ea={avi:"video/x-msvideo",mp4:"video/mp4",mpeg:"video/mpeg"};function fa(a,c){var b="",d="";if(c){d=c.indexOf(".");0<=d&&(b=c.substring(0,d).toUpperCase(),c=c.slice(d+1));switch(c.toLowerCase()){case "id":c="#";break;case "class":c="."}d=a}else c=a.charAt(0),"#"==c||"."==c?d=a.slice(1):(c="",b=a.toUpperCase());return{ia:b,o:c,qa:d}}function ha(a,c){return"#"==c.o?a.id==c.qa:"."==c.o?a.classList.contains(c.qa):c.o?a.getAttribute(c.o)==c.qa:!0}
function t(a,c,b){var d=[],e=document;c&&("string"==typeof c?(c=t(c),0<c.length&&(e=c[0])):e=c);b=fa(a,b);if(!b.ia)if("#"==b.o)d.push(document.getElementById(b.qa));else if("."==b.o)for(c=e.getElementsByClassName(b.qa),a=0;a<c.length;a++)d.push(c[a]);else b.ia="*";if(b.ia)for(e=e.getElementsByTagName(b.ia.toLowerCase()),a=0;a<e.length;a++)ha(e[a],b)&&d.push(e[a]);return d}
function u(a,c,b){var d=null;a?"string"==typeof a?(a=t(a,c,b),0<a.length&&(d=a[0])):a instanceof Event?d=a.currentTarget||a.srcElement||a.target:d=a:d=window.event.currentTarget||window.event.srcElement||window.event.target;return d}function v(a,c,b,d){var e=null;c?"string"==typeof c?e=u(c):e=c:e=u();d&&(e=e.parentElement);for(a=fa(a,b);e&&(e.tagName!=a.ia&&a.ia||!ha(e,a));)e=e.parentElement;return e}function ia(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)}
function w(a){(a=u(a))&&a.style.display&&(a.style.display="")}function x(a){if(a=u(a))a.style.display="none"}function y(a,c){if((a=a.nextElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);a&&a.id!=c;)a=a.nextElementSibling;break;default:for(c=c.toUpperCase();a&&a.tagName!=c;)a=a.nextElementSibling}return a}
function ja(a,c,b){if((a=b?a.lastElementChild:a.previousElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);a&&a.id!=c;)a=a.previousElementSibling;break;default:for(c=c.toUpperCase();a&&a.tagName!=c;)a=a.previousElementSibling}return a}function z(a,c){return parseInt(a.getAttribute(c),10)}
function ka(a,c,b){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,c);else if(b)b.download=c,b.href=window.URL.createObjectURL(a),b.click();else throw Error("Element for download is not specified.");}function la(a){if(!a)return null;var c=a.charAt(0);if("?"==c||"#"==c)a=a.substring(1);var b={};a.split("&").forEach(function(d){var e=d.indexOf("=");0>e?b[decodeURIComponent(d)]="":b[decodeURIComponent(d.substring(0,e))]=decodeURIComponent(d.substring(e+1))});return b}
function ma(){var a=la(window.location.search),c=la(window.location.hash);c&&(a=a?Object.assign(a,c):c);return a}function A(a,c){var b=[],d;for(d in a)c?b.push(d.concat("=").concat(a[d])):b.push(encodeURIComponent(d).concat("=").concat(encodeURIComponent(a[d])));return 0<b.length?"?".concat(b.join("&")):""}
function C(a,c,b,d){var e=u("svg",a),f=document.createElementNS("http://www.w3.org/2000/svg","use");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#".concat(c));e||(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.appendChild(e));e.appendChild(f);b&&(e.style.fill=b);d&&(e.style.stroke=d)}
function D(a){if(a)if(1024>a)var c="B";else 1048576>a?(c="KB",a=Math.round(a/102.4)/10):1073741824>a?(c="MB",a=Math.round(a/104857.6)/10):(c="GB",a=Math.round(a/1.073741824E8)/10);else c="B",a=0;var b=a.toString();a=b.indexOf(".");var d=b.split(""),e=[];0<=a?e.push(b.slice(a)):a=d.length;for(b=0;0<a;)3==b++&&(e.unshift(","),b=1),e.unshift(d[--a]);return e.join("").concat(c)}
function oa(a){var c=a%60;a=(a-c)/60;var b=a%60;a=(a-b)/60;var d=[];0<a&&d.push(a.toString(10));d.push("0".concat(b).slice(-2));d.push("0".concat(c).slice(-2));return d.join(":")}function pa(a){var c=a.lastIndexOf("."),b="";0<=c&&(b=a.slice(c+1));return b.toLowerCase()}function qa(){return new Promise(function(a){setTimeout(a,500)})};function ra(a){var c=CryptoJS.MD5(a);a=CryptoJS.kdf.OpenSSL.execute(a,8,4,c);a.iv.clamp();a.key.clamp();return a}
function sa(a,c,b){var d=b;"string"==typeof b&&(d=ra(b));if(!(d&&d.iv&&d.key))throw Error("Need iv and key. They can be generated by CryptoJS.kdf.OpenSSL.execute from password and salt.");b={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};Object.assign(b,d);a=a?CryptoJS.algo.AES.createEncryptor(b.key,b):CryptoJS.algo.AES.createDecryptor(b.key,b);c=a.process(c);c.concat(a.finalize());c.clamp();return c}
function ta(a){var c=Array(a.sigBytes);a=a.words;for(var b=0,d=0;d<a.length;d++){for(var e=a[d],f=b+4-1;f>=b;f--)f<c.length&&(c[f]=e&255),e>>=8;b+=4;if(b>=c.length)break}return c}
function ua(){this.h=0;this.g=null;this.i=function(a){const c=this;return n(function*(){c.h=a})};this.write=function(a){const c=this;return n(function*(){Array.isArray(a)?c.g=c.g?c.g.concat(a):a.concat():(c.g||(c.g=[]),c.g.push(a));a=null})};this.cancel=function(){return n(function*(){})};this.u=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var a=0,c=0;c<this.g.length;c++)a+=this.g[c].byteLength;a=new Uint8Array(a);var b=0;for(c=0;c<
this.g.length;++c){var d=this.g[c];d instanceof ArrayBuffer&&(d=new Uint8Array(d));a.set(d,b);b+=d.byteLength}return a}return this.g};this.B=function(){var a=this.u();a instanceof Uint8Array||(a=new Uint8Array(a));return new Blob([a],{type:"application/octet-binary"})};this.download=function(a){var c=this.B();ka(c,a,null)};this.v=function(){return this.h}}
function va(a){this.blob=null;if(a.ya)if(a.ya instanceof Blob)this.blob=a.ya;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.l=1600;a.V&&(this.l=a.V);this.h=0;this.i=null;this.C=function(c){const b=this;return n(function*(){if(c){if(c>=b.g())throw Error("offset can not be bigger than input size.");b.h=c}else b.h=0;b.i=new FileReader})};this.ba=function(){return this.l};this.m=function(){return this.h};this.g=function(){return this.blob.size};this.u=function(){return this.h>=
this.g()};this.J=function(c){return new Promise(function(b){if(1!=this.i.readyState){this.i.onload=function(e){b(e.target.result)}.bind(this);var d=this.h;this.h=c?this.h+c:this.h+this.l;this.i.readAsArrayBuffer(this.blob.slice(d,this.h))}}.bind(this))};this.P=function(){this.blob=this.i=null}}
function wa(a){this.u=!0;this.g=a.bb;this.h=this.l=this.iv=this.key=null;this.m=this.i=0;a.$a&&(this.u=!1);if(!this.g)throw Error("reader must be specified.");if(a.na){var c=null;c="string"==typeof a.na?ra(a.na):a.na;this.key=c.key;this.iv=c.iv}else throw Error("keycfg must be specified.");this.R=function(){const b=this;return n(function*(){if(b.m)return b.m;if(b.u)return b.m=16*Math.ceil((b.g.g()+1)/16),b.m;0==b.g.g()&&(yield b.v());var d=b.g.g()-16,e=yield b.I(d);b.m=d+e.length;return b.m})};this.v=
function(b){const d=this;return n(function*(){var e=b||0;if(b){if(d.u)throw Error("Can NOT set offset for encryption.");b-=b%16+16;0>b&&(b=0)}yield d.g.C(b);var f={iv:d.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};e&&(f.iv=yield d.C(16));d.l=d.u?CryptoJS.algo.AES.createEncryptor(d.key,f):CryptoJS.algo.AES.createDecryptor(d.key,f);d.i=e;d.h=null})};this.I=function(b){const d=this;return n(function*(){var e=d.g.ba(),f=null,g=0<=b?b:d.g.m();if(d.i==g&&d.h){if(e<=d.h.length)return d.i+=e,f=d.h.slice(0,
e),d.h=d.h.slice(e),0==d.h.length&&(d.h=null),f;f=d.h;g+=d.h.length;d.i+=d.h.length;e-=d.h.length}var k=16*Math.ceil((g%16+e)/16);d.l&&d.i==g||(yield d.v(g),k+=16);var l=yield d.C(k);k=ta(d.l.process(l));d.g.u()&&(k=k.concat(ta(d.l.finalize())));g<d.g.m()?(g-=d.g.m()-l.sigBytes,0<g&&(k=k.slice(g)),k.length>e&&(d.h=k.slice(e),k=k.slice(0,e)),d.i+=e):k=null;f?k&&(f=f.concat(k)):k&&(f=k);return f})};this.J=function(){return this.g.m()};this.D=function(){return this.g.u()};this.P=function(){this.g.P();
this.l=this.g=null};this.B=function(){return this.g.B()};this.C=function(b){const d=this;return n(function*(){var e=yield d.g.J(b);return new CryptoJS.lib.WordArray.init(e)})}}
function xa(a){this.g=new wa(a);this.h=a.eb;this.speed=this.m=this.i=0;if(!this.h)throw Error("writer must be specified.");this.start=function(c,b){const d=this;return n(function*(){var e=c||0,f=yield d.g.R();yield d.h.i(f);yield d.g.v(c);d.i=Date.now()+1E3;d.m=e;for(e=d.g.D()?2:0;0==e;)(f=yield d.g.I())&&(yield d.h.write(f)),d.g.D()?e=2:b&&!b()&&(e=1);1==e&&(yield d.h.cancel());d.h=null;d.g.P();d.g=null;return 2==e})};this.l=function(){Date.now()>this.i&&(this.speed=1E3*(this.g.J()-this.m)/(Date.now()-
this.i+1E3),this.i=Date.now()+1E3,this.m=this.g.J());return this.speed}}function ya(a,c){return n(function*(){yield a.C(0);yield c.i(a.g());for(var b=0;0==b;){var d=yield a.J();yield c.write(d);a.u()&&(b=2)}return 1==b?(yield c.cancel(),!1):!0})};function za(){this.u=!0;this.g=this.s=null;this.m=this.J=!1;this.i=-1;this.ba=function(){return null!=this.s};this.R=function(a){if(this.u)try{var c=window.sessionStorage.getItem("language"),b=window.sessionStorage.getItem("relay_url"),d=window.sessionStorage.getItem("drive"),e=window.sessionStorage.getItem("drive_extra"),f=window.sessionStorage.getItem("skipLogin");window.sessionStorage.clear();c&&window.sessionStorage.setItem("language",c);b&&!a&&window.sessionStorage.setItem("relay_url",b);d&&
!a&&window.sessionStorage.setItem("drive",d);e&&!a&&window.sessionStorage.setItem("drive_extra",e);f&&!a&&window.sessionStorage.setItem("skipLogin",f)}catch(g){this.u=!1,console.error(g)}};this.l=function(a){var c=null;if(this.u)try{c=window.sessionStorage.getItem(a)}catch(b){this.u=!1,console.error(b)}return c};this.Sa=function(a){var c=this.l("login_state");return c&&a==c?!0:!1};this.B=function(a,c){if(this.u)try{return window.sessionStorage.setItem(a,c.toString()),!0}catch(b){this.u=!1,console.error(b)}return!1};
this.D=function(a){if(this.u)try{window.sessionStorage.removeItem(a)}catch(c){this.u=!1,console.error(c)}};this.Wa=function(){var a=this.l("language"),c=this.l("relay_url"),b=this.l("drive"),d=this.l("drive_extra"),e=this.l("skipLogin");this.g={};a&&(this.g.language=a,this.Y(a));c&&(this.g.ua=c,this.Ra(c));b&&(this.g.H=b,this.Ya(b));d&&(this.g.gb=d,this.P(d));e&&this.Za(e)};this.kb=function(){var a=this.h("drive");a||(this.g||this.Wa(),a=this.g.H);return a};this.Ya=function(a){return this.Z("drive",
a)?(this.s[a]||(this.s[a]={}),!0):this.s?!1:!0};this.Za=function(a){a?this.m=this.ba():(this.m=!1,this.lb()&&(this.J=!0));this.B("skipLogin",this.m)};this.Va=function(a){var c=this.h("language");!c&&a&&this.g&&(c=this.g.language);return c};this.Y=function(a){this.Z("language",a)};this.Qa=function(){var a=this.h("relay_url");!a&&this.g&&(a=this.g.ua);return a?a:""};this.Ra=function(a){this.Z("relay_url",a)};this.Ua=function(){var a=null,c=this.v("extra_info");!c&&this.g&&this.g.gb&&(c=this.g.gb);c&&
(a=JSON.parse(c));return a&&2==a.length?{za:a[0],ga:a[1]}:null};this.P=function(a){a?(a="string"===typeof a?a:JSON.stringify([a.za,a.ga]),this.B("drive_extra",a),this.C("extra_info",a)):(this.D("drive_extra"),this.C("extra_info",null))};this.ob=function(a){if(window.indexedDB){var c=window.indexedDB.open("zgayard1946");c.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};c.onupgradeneeded=function(b){b.target.result.createObjectStore("settings",
{keyPath:"key"})};c.onsuccess=function(b){var d=b.target.result;b=d.transaction("settings","readwrite");b.oncomplete=function(){d.close();a&&a()};b.objectStore("settings").getAll().onsuccess=function(e){this.s={};e.target.result.forEach(function(f){this.s[f.key]=f.value}.bind(this));this.m=(e=this.s.drive)&&this.s[e]&&this.s[e].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};this.mb=function(a){var c=window.indexedDB.deleteDatabase("zgayard1946");c.onerror=function(){if(a)a("Failed to dropt IndexedDB.");else throw Error("Failed to dropt IndexedDB.");};c.onsuccess=function(){this.R(!0);this.s=null;this.m=!1;a?a():console.log("IndexedDB has been dropped.")}.bind(this)};this.Xa=function(){this.J&&this.s&&(this.I(function(a){a.clear().onsuccess=function(){for(var c in this.s)a.put({key:c,value:this.s[c]})}.bind(this)}.bind(this)),this.J=!1)};this.v=function(a){var c=this.h("drive");
return c&&(c=this.s[c])?c[a]:null};this.lb=function(){var a=this.h("drive");return a&&(a=this.s[a])&&a.refresh_token?(delete a.refresh_token,!0):!1};this.C=function(a,c,b){if(this.s){var d=this.h("drive");if(c)this.s[d]||(this.s[d]={}),this.s[d][a]=c;else if(this.s[d]&&this.s[d][a])delete this.s[d][a];else{b&&b instanceof Function&&b();return}b?(a=void 0,b instanceof Function&&(a=b),this.I(function(e){e.put({key:d,value:this.s[d]})}.bind(this),a)):this.J=!0}else b&&b instanceof Function&&b()};this.Ta=
function(a){this.R(!0);if(this.s){var c=this.h("drive");delete this.s[c].refresh_token;delete this.s.drive;this.I(function(b){b.put({key:c,value:this.s[c]});b.delete("drive")}.bind(this),a)}else a&&a()};this.qb=function(a,c){var b=this.h("recent");b||(b=[]);0>this.i&&(b.push({drive:this.h("drive"),root:this.v("root"),played:[]}),this.i=b.length-1);var d=b[this.i];a={fid:a.G,time:a.ka};0<=c&&c<d.played.length?d.played[c]=a:d.played.push(a);this.saveData("recent",b,void 0)};this.nb=function(){var a=
this.h("recent");this.i=-1;if(a){var c=0;for(c=0;c<a.length;c++){var b=a[c];if(b.drive==this.h("drive")&&b.root==this.v("root")){this.i=c;break}}}if(0<=this.i){var d=[];a[this.i].played.forEach(function(e){d.push({G:e.fid,L:"",ka:e.time})});return d}return null};this.pb=function(a){var c=this.h("recent");if(c&&!(0>this.i)){var b=c[this.i].played;a<b.length&&(b.splice(a,1),this.saveData("recent",c,void 0))}};this.I=function(a,c){window.indexedDB.open("zgayard1946").onsuccess=function(b){var d=b.target.result;
b=d.transaction("settings","readwrite");b.oncomplete=function(){d.close();c&&c()};b=b.objectStore("settings");a&&a(b)}};this.Z=function(a,c){if(c){if(this.B(a,c),this.s&&this.s[a]!=c)return this.s[a]=c,this.J=!0}else if(this.D(a),this.s&&this.s[a])return delete this.s[a],this.J=!0;return!1};this.h=function(a){return this.s&&this.s[a]?this.s[a]:null};this.saveData=function(a,c,b){this.s&&(this.s[a]=c);this.I(function(d){d.put({key:a,value:c})}.bind(this),b)}};var Aa={};function Ba(a,c,b){this.j=a;this.o=c;this.g=b}Ba.prototype.B=function(){return this.o};function Ca(a,c){this.ua=null;this.v=c;this.h=null;this.g=a;this.ma||(this.ma=function(){})}function Da(a){null==a.ua&&(a.ua=a.g.Qa());return a.ua}
function Ea(a,c){return n(function*(){var b="POST",d=a.l().concat(encodeURI(c.W)),e=new Headers;if(c&&c.F)e.append("Authorization",c.F);else if(c&&c.Ca){var f="Bearer";c&&c.Da&&(f=c.Da);e.append("Authorization",f+" "+c.Ca)}else e.append("Authorization",a.h);if(c&&c.Aa)for(var g of c.Aa.entries())e.append(g[0],g[1]);c&&c.Ba&&(b=c.Ba);b=yield fetch(d,{method:b,body:c.Ia,headers:e});401==b.status&&a.g.m&&!c.tb&&(b=yield Fa(a,c));return b})}h=Ca.prototype;
h.Fa=function(a){const c=this;return n(function*(){if(a&&(c.h=c.g.l("access_token"),c.h))return null;var b=c.g.m,d={},e=ma();if(e&&e.token_type&&e.access_token){c.h=e.token_type+" "+e.access_token;c.g.B("access_token",c.h);if(e&&e.state)if(c.g.Sa(e.state))c.g.D("login_state");else return"Unauthorized access to this url.";return null}e&&e.code?d.code=e.code:b&&(d.Pa=c.g.v("refresh_token"));var f=c.g.Ua();f&&(d.clientId=f.za,d.fb=f.ga);if(d.code||d.Pa){if(e&&e.state)if(c.g.Sa(e.state))c.g.D("login_state");
else return"Unauthorized access to this url.";if((e=yield Ga(c,d))&&e.token_type&&e.access_token)return f&&e.client_secret_enc&&(f.ga=e.client_secret_enc,c.g.P(f)),c.h=e.token_type+" "+e.access_token,c.g.B("access_token",c.h),b&&d.code&&e.refresh_token&&c.g.C("refresh_token",e.refresh_token),e.logout&&c.g.B("logout_url",e.logout),null}else if(b&&(d.ib=!0),(e=yield Ga(c,d))&&e.url)return f&&e.client_secret_enc&&(f.ga=e.client_secret_enc,c.g.P(f)),e.state&&(c.g.B("login_state",e.state)||(e.state=c.m())),
e.logout&&c.g.B("logout_url",e.logout),window.location.href=e.url.concat("&state=".concat(encodeURIComponent(e.state))),"redirect";return e&&e.error?"["+e.error+"] "+e.error_description:"Unknown error occured when doing authorization."})};
h.Oa=function(){const a=this;n(function*(){a.h=null;a.g.D("access_token");var c=a.g.l("logout_url");c?window.location.href=c:(c=new FormData,c.append("drive_type",a.m()),c.append("action","logout"),c=yield fetch(a.v,{method:"POST",credentials:"include",body:c}),c.ok&&(c=yield c.text(),(c=JSON.parse(c))&&c.logout&&(window.location.href=c.logout)))})};h.xa=function(){return n(function*(){})};h.X=function(){return n(function*(){})};h.ca=function(){return n(function*(){})};h.la=function(){return n(function*(){})};
function Ha(a){return n(function*(){if(!a||!a.$)throw Error("newname is not specified.");return yield E.va(a)})}function Ia(a){return n(function*(){if(!a||!a.A)throw Error("parentid is not specified.");if(!a||!a.Ka)throw Error("oldparentid is not specified.");return yield E.va(a)})}h.delete=function(){return n(function*(){})};h.ta=function(){return n(function*(){})};h.Ea=function(){return n(function*(){})};h.Na=function(){return n(function*(){})};h.Ha=function(a){return new Ja(a,this)};h.sa=function(){return n(function*(){})};
h.jb=function(){};h.wa=function(a){return new Ka(a,this)};function La(a){return n(function*(){return{cb:a.status,ea:yield a.text()}})}function G(a,c,b,d,e,f,g){return n(function*(){var k={W:c,Ba:b};Ma(e,k);f&&(k.Aa=f);g&&(k.Ia=g);k=yield Ea(a,k);var l=yield La(k);if(d&&k.status!=d)throw Error(JSON.stringify(l));return l})}function H(a,c,b){return n(function*(){return(yield G(a,c,"GET",200,b,null,null)).ea})}function Ma(a,c){a.Da&&(c.Da=a.Da);a.Ca&&(c.Ca=a.Ca);a.F&&(c.F=a.F)}h.va=function(){return n(function*(){})};
function Ga(a,c){return n(function*(){if(!c)throw Error("Options are not specified when auth onedrive.");var b=new FormData;b.append("drive_type",a.m());c.clientId&&b.append("client_id",c.clientId);c.yb&&b.append("redirect_uri",c.yb);c.fb&&b.append("client_secret",c.fb);c.code?b.append("code",c.code):c.Pa?b.append("refresh_token",c.Pa):c.ib&&b.append("need_code",c.ib);b=yield fetch(a.v,{method:"POST",body:b,credentials:"include"});if(200==b.status)return yield b.json();var d=yield b.text();throw Error(d+
" ("+b.status+")");})}function Fa(a,c){return n(function*(){console.log("Retry to send ajax.");if(c)c.tb=!0;else return null;var b=yield a.Fa();if(b)return console.error(b),null;c.F=a.h;return yield Ea(a,c)})}
function Na(a){a.Ga=Ca;if("function"===typeof Object.create)a.prototype=Object.create(Ca.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});else{var c=function(){};c.prototype=Ca.prototype;a.prototype=new c;a.prototype.constructor=a}a.prototype.xb||(a.prototype.xb=function(){return this.constructor.Ga});a.prototype.ma||(a.prototype.ma=function(...b){return this.constructor.Ga.call(this,...b)});a.prototype.zb||(a.prototype.zb=function(b,...d){return b?this.constructor.Ga.prototype[b].call(this,
...d):this.constructor.Ga.call(this,...d)})}function Oa(a,c,b){Na(b);Aa[a]=new Ba(a,c,b)}var Pa=-1,Qa=-9,Ra=0;
function Ja(a,c){this.H=c;this.l=a;this.C="";this.g=this.m=0;this.h=null;if(!this.l||!this.l.da)throw Error("fnm is not specified.");this.i=function(b){const d=this;return n(function*(){d.m=b;d.C=yield d.H.ta(d.l,b)})};this.write=function(b){const d=this;return n(function*(){var e=null;if(d.h){if(d.h instanceof ArrayBuffer){var f=d.h.byteLength;0<f?(e=new Uint8Array(f+b.byteLength),e.set(new Uint8Array(d.h),0),e.set(new Uint8Array(b),f)):e=new Uint8Array(b)}else e=0<d.h.length?new Uint8Array(d.h.concat(b)):
new Uint8Array(b);d.h=null}else e=new Uint8Array(b);var g=new Blob([e],{type:"application/octet-binary"}),k="bytes "+d.g+"-";d.g+=g.size;k+=d.g-1+"/"+d.m;var l=0,m=function(){const p=this;return n(function*(){var q=new Headers;q.append("Content-Range",k);try{var r=yield fetch(p.C,{method:"PUT",headers:q,body:g});q="";if(r.ok){var B=yield p.H.Ea(r);if(B==Qa)throw b=null,q=yield r.text(),Error(q+" ("+r.status+")");if(B!=Pa&&B!=Ra&&B<p.g)if(r=0,r=b instanceof ArrayBuffer?b.byteLength:b.length,r-=p.g-
B,0<r){var F=b.slice(r);b=null;p.g>=p.m?yield p.write(F):(p.h=F,p.g=B)}else throw b=null,Error("Can NOT continue to upload buffer.");}else throw b=null,q=yield r.text(),Error(q+" ("+r.status+")");}catch(L){1>l?(l++,yield qa(),yield m()):g=b=null}})}.bind(d);yield m()})};this.cancel=function(){const b=this;return n(function*(){yield b.H.Na(b.C)})};this.v=function(){return this.m}}
function Ka(a,c){this.H=c;this.D=a;this.url="";this.name=null;this.I=this.i=this.h=this.size=0;this.Z=!1;this.R=16E3;a.V&&(this.R=a.V);this.v=this.l=0;this.C=function(b){const d=this;return n(function*(){if(d.Z)if(d.i&&(d.I=d.i,d.i=0),b){if(b>=d.g())throw console.log("offset:"+b+",size:"+d.g()),Error("offset can not be bigger than input size.");d.h=b}else d.h=0;else{var e=yield d.H.sa(d.D);d.Z=!0;if(e){if(d.size=e.O||0,d.url=e.j,d.name=e.o,d.v="1"==e.N?1:0,b){if(b>=d.g())throw Error("offset can not be bigger than input size.");
d.h=b}}else throw Error("Failed to prepare reader.");}})};this.B=function(){return this.name};this.ba=function(){return this.R};this.m=function(){return this.h};this.g=function(){return this.size};this.u=function(){return this.h>=this.g()};this.J=function(b){const d=this;return n(function*(){b||(b=d.R);return yield d.Y(b)})};this.P=function(){};this.Y=function(b){const d=this;return n(function*(){if(b&&d.i)return null;if(b)d.i=b;else if(d.i)b=d.i;else throw Error("size must be specified.");if(d.I)return null;
var e=d.h+b-1,f=function(){const g=this;return n(function*(){var k=g.url,l=new Headers;10<=g.l&&(k=Da(g.H),l.append("Zb-Url",g.url));g.H.jb(l,g.D.F);l.append("Range","bytes="+g.h+"-"+e);try{var m=yield fetch(k,{method:"GET",headers:l});if(g.I){if(g.I=0,g.i)return yield g.Y()}else{g.i=0;g.l=10>g.l?1:11;if(200==m.status||206==m.status){2==g.v&&(g.v=1);var p=parseInt(m.headers.get("content-length"),10);if(p)g.h+=p;else{var q=m.headers.get("content-range");if(q){var r=q.indexOf("-");if(0>r)var B=0;else{r++;
var F=q.indexOf("/",r);B=F<=r?0:parseInt(q.slice(r,F),10)}}else B=0;g.h=B?B+1:e+1}200==m.status&&g.h<g.g()?g.h=g.g():g.h>g.g()&&(g.h=g.g());return yield m.arrayBuffer()}if(401==m.status&&1==g.v){console.log("Retry auth.");g.v=2;var L=yield g.H.Fa();if(L)console.error(L);else return g.D.F&&delete g.D.F,yield f()}else{var na=yield m.text();throw Error(na+" ("+m.status+")");}}}catch(Oc){if(0==g.l&&Da(g.H))return g.l=10,yield f();if(1==g.l||11==g.l)return g.l++,yield qa(),yield f()}})}.bind(d);return yield f()})}}
;Oa("onedrive","Microsoft OneDrive",function(a,c){this.ma(a,c);this.m=function(){return"onedrive"};this.xa=function(b){const d=this;return n(function*(){var e=yield H(d,"/me/drive",b);e=JSON.parse(e).quota;return{Ma:e.deleted,La:e.total,pa:e.used}})};this.X=function(b){const d=this;return n(function*(){var e="/me/drive/root/children";if(b){if(b.U){e=function(k){const l=this;return n(function*(){var m={aa:""};Ma(b,m);m=yield l.i(m,k);var p=[];m&&p.push(m);return p})}.bind(d);if(b.A){var f={aa:b.A};
Ma(b,f);if(f=yield d.i(f))return yield e(f.sb.concat("/").concat(f.o).concat("/").concat(b.U))}else return yield e("/drive/root:/".concat(b.U));return null}b.A&&(e="/me/drive/items/"+b.A+"/children")}e=yield H(d,e.concat(A({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),b);var g=[];e&&JSON.parse(e).value.forEach(function(k){g.push(this.fa(k))},d);return g})};this.ca=function(b){const d=this;return n(function*(){return yield d.i(b)})};this.la=function(b){const d=this;
return n(function*(){if(!b||!b.L)throw Error("Name of new folder is not specified.");var e=new Headers;e.append("Content-Type","application/json;charset=UTF-8");var f="/me/drive/root/children";b.A&&(f="/me/drive/items/"+b.A+"/children");var g=JSON.stringify({name:b.L,folder:{},"@microsoft.graph.conflictBehavior":"fail"});e=yield G(d,f,"POST",201,b,e,g);return d.fa(JSON.parse(e.ea))})};this.delete=function(b){const d=this;return n(function*(){var e="/me/drive/items/".concat(b.G);yield G(d,e,"DELETE",
204,b,null,null);return 0})};this.ta=function(b){const d=this;return n(function*(){var e={W:"/me",Ba:"POST",F:b.F,Aa:new Headers({"Content-Type":"application/json;charset=UTF-8","Cache-Control":"no-cache",Pragma:"no-cache"})};e.W=b.T?"/me/drive/items/"+b.T+":/":e.W+"/drive/root:/";e.W+=b.da;e.W+=":/createUploadSession";e.Ia=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:b.da}});e=yield Ea(d,e);var f=yield La(e),g="";e.ok&&(g=JSON.parse(f.ea).uploadUrl);return g})};this.Ea=
function(b){return n(function*(){if(0<=[200,201].indexOf(b.status))return Pa;if(0>[202].indexOf(b.status))return Qa;var d=yield b.text();if((d=JSON.parse(d).nextExpectedRanges)&&d.length){var e=d[0].indexOf("-");if(0<e)return parseInt(d[0].substring(0,e),10)}return Ra})};this.Na=function(b){return n(function*(){var d=yield fetch(b,{method:"DELETE"});if(!d.ok)throw(yield d.text())+" ("+d.status+")";})};this.sa=function(b){const d=this;return n(function*(){var e="/me/drive/items/".concat(b.j),f={};
b.F&&(f.F=b.F);e=yield H(d,e.concat(A({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f);f=null;e&&(e=JSON.parse(e),f={j:e["@microsoft.graph.downloadUrl"],o:e.name,O:e.size});return f})};this.l=function(){return"https://graph.microsoft.com/v1.0"};this.va=function(b){const d=this;return n(function*(){if(!b||!b.G)throw Error("fid is not specified.");var e=new Headers;e.append("Content-Type","application/json;charset=UTF-8");var f="/me/drive/items/".concat(b.G),g={};b.$&&(g.name=b.$);b.A&&(g.parentReference=
{id:b.A});g=JSON.stringify(g);if("{}"==g)throw Error("No property to be updated.");yield G(d,f,"PATCH",200,b,e,g);return 0})};this.i=function(b,d){const e=this;return n(function*(){var f=d?d.startsWith("/me")?d:"/me".concat(d):"/me/drive/items/"+b.aa;f=yield G(e,f.concat(A({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,b,null,null);if(200==f.cb)return e.fa(JSON.parse(f.ea));if(404==f.cb&&d)return null;throw Error(JSON.stringify(f));})};this.fa=function(b){var d=
{j:b.id,o:b.name,O:b.size,oa:b.lastModifiedDateTime,sb:b.parentReference.path,K:b.parentReference.id,N:"0"};b.folder?d.N="1":b.file&&(d.N="2");return d}});Oa("googledrive","Google Drive",function(a,c){this.ma(a,c);this.m=function(){return"googledrive"};this.xa=function(b){const d=this;return n(function*(){var e=d.i("/about").concat(A({fields:"storageQuota"}));e=yield H(d,e,b);e=JSON.parse(e).storageQuota;return{Ma:e.usageInDriveTrash,La:e.limit,pa:e.usage}})};this.X=function(b){const d=this;return n(function*(){var e=d.i("/files"),f="'"+(b.A?b.A:"root")+"' in parents";b.U&&(f=f.concat(" and name = '"+b.U+"'"));e=yield H(d,e.concat(A({fields:"files(id,name,mimeType,parents,modifiedTime,size)",
q:f},!0)),b);var g=[];JSON.parse(e).files.forEach(function(k){g.push(this.fa(k))},d);return g})};this.ca=function(b){const d=this;return n(function*(){var e=d.i("/files/").concat(b.aa);e=yield H(d,e.concat(A({fields:"id,name,mimeType,parents,modifiedTime,size"},!0)),b);return d.fa(JSON.parse(e))})};this.la=function(b){const d=this;return n(function*(){if(!b||!b.L)throw Error("Name of new folder is not specified.");var e=new Headers;e.append("Content-Type","application/json;charset=UTF-8");var f=d.i("/files");
e=yield G(d,f,"POST",200,b,e,JSON.stringify({mimeType:"application/vnd.google-apps.folder",name:b.L,parents:[b.A?b.A:"root"]}));return d.fa(JSON.parse(e.ea))})};this.delete=function(b){const d=this;return n(function*(){var e=d.i("/files/").concat(b.G);yield G(d,e,"DELETE",204,b,null,null);return 0})};this.ta=function(b,d){const e=this;return n(function*(){var f={U:b.da,F:b.F};b.T&&(f.A=b.T);f=yield e.X(f);return 0<f.length?yield e.u(b,d,f[0].j):yield e.u(b,d)})};this.Ea=function(b){return n(function*(){if(0<=
[200,201].indexOf(b.status))return Pa;if(0>[308].indexOf(b.status))return Qa;var d=b.headers.get("range");if(d){var e=d.indexOf("-");if(0<e)return parseInt(d.slice(e+1),10)+1}return Ra})};this.sa=function(b){const d=this;return n(function*(){var e=d.i("/files/").concat(b.j),f={aa:b.j};b.F&&(f.F=b.F);if(f=yield d.ca(f))f.j=d.l().concat(encodeURI(e)).concat(A({alt:"media"})),d.g.m&&(f.N="1");return f})};this.jb=function(b,d){d?b.append("Authorization",d):b.append("Authorization",this.h?this.h:"")};
this.l=function(){return"https://www.googleapis.com"};this.va=function(b){const d=this;return n(function*(){var e=!0,f=new Headers;f.append("Content-Type","application/json;charset=UTF-8");var g=d.i("/files/").concat(b.G);b.Ka&&b.A&&(g=g.concat(A({addParents:b.A,removeParents:b.Ka})),e=!1);var k={};b.$&&(k.name=b.$,e=!1);if(e)throw Error("No property to be updated.");yield G(d,g,"PATCH",200,b,f,JSON.stringify(k));return 0})};this.u=function(b,d,e){const f=this;return n(function*(){var g={},k="POST",
l="/files?uploadType=resumable";e?(k="PATCH",l="/files/"+e+"?uploadType=resumable"):(g.name=b.da,b.T&&(g.parents=[b.T]));g={W:"/upload".concat(f.i(l)),Ba:k,F:b.F,Aa:new Headers({"X-Upload-Content-Length":d,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"}),Ia:JSON.stringify(g)};g=yield Ea(f,g);if(g.ok)return g.headers.get("location")||"";g=yield La(g);throw Error(g.ea);})};this.i=function(b){return"/drive/v3".concat(b)};this.fa=function(b){var d=
{j:b.id,o:b.name,O:b.size,oa:b.modifiedTime,N:"2"};b.parents&&0<b.parents.length&&(d.K=b.parents[0]);this.B(b.mimeType)&&(d.N="1");return d};this.B=function(b){return"application/vnd.google-apps.folder"==b}});function Sa(a,c){this.H=c;this.R=a;this.h=null;this.i=this.size=0;this.l=null;this.I=this.v=0;this.D=1600;a.V&&(this.D=a.V);this.C=function(b){const d=this;return n(function*(){var e=yield d.H.sa(d.R);if(e)d.size=e.O||0,e=yield d.H.I(d.R.j),d.h=e,d.h.sort(function(f,g){return f.ha-g.ha}),d.Y(b);else throw Error("Failed to prepare reader.");})};this.ba=function(){return this.D};this.m=function(){return this.i};this.g=function(){return this.size};this.u=function(){return this.h?this.v>=this.h.length:
!0};this.J=function(b){const d=this;return n(function*(){if(!d.l){var e=yield d.H.D(d.h[d.v].j);e=CryptoJS.enc.Base64url.parse(e);d.l=ta(e)}return yield d.Z(b)})};this.P=function(){this.l=this.h=null};this.Y=function(b){if(b){if(b>=this.g())throw Error("offset can not be bigger than input size.");this.i=b;var d=0;for(b=0;b<this.h.length&&!(d+=this.h[b].O,this.i<d);b++)this.I=d;if(b<this.h.length)this.v=b;else throw Error("offset can not be bigger than input size.");}else this.v=this.I=this.i=0;this.l=
null};this.Z=function(b){const d=this;return n(function*(){var e=d.i-d.I,f=d.l.length-e;b?b<f&&(f=b):d.D<f&&(f=d.D);var g=new Uint8Array(d.l.slice(e,e+f));d.i+=f;d.l.length==e+f&&(d.l=null,d.v++,d.I=d.i);return g.buffer})}}
function Ta(a,c){this.H=c;this.g=a;this.data={j:"",o:"",O:0,K:"",N:"2"};this.m=this.h=0;this.i=function(b){const d=this;return n(function*(){d.h=b;d.data.o=d.g.da;d.g.T&&(d.data.K=d.g.T);d.data.j=yield d.H.ta(d.g,b)})};this.write=function(b){const d=this;return n(function*(){var e=Array.isArray(b)?new CryptoJS.lib.WordArray.init(new Uint8Array(b)):new CryptoJS.lib.WordArray.init(b);d.data.O+=e.sigBytes;var f=e.toString(CryptoJS.enc.Base64url);d.m++;yield d.H.saveData(d.data.j,d.m,e.sigBytes,f);d.data.O>=
d.h&&(yield d.H.J(d.data))})};this.cancel=function(){const b=this;return n(function*(){yield b.H.delete({G:b.data.j})})};this.v=function(){return this.h}}
Oa("idxdb","Loacal Indexed DB",function(a,c){this.ma(a,c);this.m=function(){return"idxdb"};this.Fa=function(){return new Promise(function(b){this.wb(b)})};this.Oa=function(){n(function*(){location.reload()})};this.xa=function(){const b=this;return n(function*(){var d={Ma:0,La:0,pa:0};yield b.i(function(e){e.getAll().onsuccess=function(f){f.target.result.forEach(function(g){"2"==g.type&&(d.pa+=parseInt(g.size,10))})}});return d})};this.X=function(b){const d=this;return n(function*(){return yield d.B(void 0,
b.A,b.U)})};this.ca=function(b){const d=this;return n(function*(){var e=yield d.B(b.aa);return e&&0<e.length?e[0]:null})};this.la=function(b){const d=this;return n(function*(){if(!b||!b.L)throw Error("Name of new folder is not specified.");var e={j:"",o:b.L,O:0,K:"",N:"1"};b.A&&(e.K=b.A);e.j=yield d.C(e.K);yield d.J(e);return e})};this.delete=function(b){const d=this;return n(function*(){function e(k){var l;for(l=0;l<f.length;l++)f[l].j==k?f[l].Ja=!0:f[l].K==k&&("1"==f[l].N?e(f[l].j):f[l].Ja=!0)}
var f=[],g=0;yield d.i(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){f.push({j:m.key,o:"",K:m.pid})})}});e(b.G);yield d.i(function(k){f.forEach(function(l){l.Ja&&k.delete(l.j)})});yield d.u(function(k){var l=[];f.forEach(function(m){m.Ja&&"2"==m.N&&l.push(m.j)});0>l.indexOf(b.G)&&l.push(b.G);k.getAllKeys().onsuccess=function(m){m.target.result.forEach(function(p){var q=p.indexOf(":");0<=l.indexOf(p.substring(0,q))&&(k.delete(p),g+=parseInt(p.substring(p.indexOf("_",
q+1)+1),10))})}});return g})};this.Ha=function(b){return new Ta(b,this)};this.ta=function(b){const d=this;return n(function*(){var e="";b.T&&(e=b.T);return yield d.C(e)})};this.Ea=function(){return n(function*(){return Ra})};this.Na=function(){return n(function*(){})};this.wa=function(b){return new Sa(b,this)};this.sa=function(b){const d=this;return n(function*(){return yield d.ca({aa:b.j})})};this.l=function(){return""};this.va=function(b){const d=this;return n(function*(){if(!b||!b.G)throw Error("fid is not specified.");
yield d.i(function(e){e.get(b.G).onsuccess=function(f){if(f=f.target.result){var g=!1;b.$&&f.name!=b.$&&(f.name=b.$,g=!0);b.A&&f.pid!=b.A&&(f.pid=b.A,g=!0);g&&e.put(f)}}});return 0})};this.J=function(b){const d=this;return n(function*(){b.oa=d.P();var e={key:b.j,name:b.o,size:b.O,tms:b.oa,type:b.N};b.K&&(e.pid=b.K);yield d.i(function(f){f.put(e)})})};this.saveData=function(b,d,e,f){const g=this;return n(function*(){yield g.u(function(k){k.put({key:b+":"+d+"_"+e,data:f})})})};this.I=function(b){const d=
this;return n(function*(){var e=[];yield d.u(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,l)==b){var m=k.substring(l+1);l=m.indexOf("_");e.push({j:k,ha:parseInt(m.substring(0,l),10),O:parseInt(m.substring(l+1),10)})}})}});return e})};this.D=function(b){const d=this;return n(function*(){var e="";yield d.u(function(f){f.get(b).onsuccess=function(g){e=g.target.result.data}});return e})};this.wb=function(b){if(window.indexedDB){var d=
window.indexedDB.open("zgalocaldb");d.onerror=function(){if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");}.bind(this);d.onupgradeneeded=function(e){e=e.target.result;e.createObjectStore("items",{keyPath:"key"});e.createObjectStore("datas",{keyPath:"key"})}.bind(this);d.onsuccess=function(e){e.target.result.close();b&&b()}.bind(this)}else if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};this.i=function(b){return new Promise(function(d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("items","readwrite");e.oncomplete=function(){f.close();d()}.bind(this);e=e.objectStore("items");b&&b(e)}.bind(this)})};this.u=function(b){return new Promise(function(d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("datas","readwrite");e.oncomplete=function(){f.close();d()}.bind(this);e=e.objectStore("datas");
b&&b(e)}.bind(this)}.bind(this))};this.B=function(b,d,e){const f=this;return n(function*(){var g=[];yield f.i(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var p=!0;b&&(p=b==m.key);p&&d&&(p=d==m.pid);p&&e&&(p=e==m.name);p&&g.push({j:m.key,o:m.name,O:m.size,oa:m.tms,N:m.type,K:m.pid})})}});return g})};this.P=function(){var b;b||(b=new Date);var d=[],e=[];d.push(b.getFullYear());d.push(b.getMonth()+1);d.push(b.getDate());e.push("0".concat(b.getHours()).slice(-2));
e.push("0".concat(b.getMinutes()).slice(-2));e.push("0".concat(b.getSeconds()).slice(-2));return d.join("-")+" "+e.join(":")};this.C=function(b){const d=this;return n(function*(){var e=-1;yield d.i(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf("_");b&&0<l?k.substring(l+1)==b&&(l=parseInt(k.substring(0,l),10),l>e&&(e=l)):!b&&0>l&&(l=parseInt(k,10),l>e&&(e=l))})}});e++;return b?e+"_"+b:e.toString()})}});function Ua(a,c){var b=I;this.h=this.g=null;this.C=b;this.i=1;this.v=a;this.l=c;this.m=0;this.u=function(){this.l({type:0,wtype:this.i,size:this.g.g()});var d=new xa({$a:1==this.i,na:this.C,bb:this.g,eb:this.h}),e=function(){var g={type:1,wtype:this.i,begin:this.m,spd:d.l(),posn:this.g.m(),size:this.g.g()};this.l(g);return this.v()?!1:!0}.bind(this),f=function(g,k){var l={type:2,wtype:this.i,begin:this.m,posn:this.g.m(),size:this.h.v()};g?l.errr=g.message||g.Ab:k?this.h.B&&(l.blob=this.h.B()):l.type=
3;this.l(l)}.bind(this);this.m=Date.now();d.start(0,e).then(function(g){f(void 0,g)}).catch(function(g){f(g)})};this.B=function(d){var e=E;this.i=1;this.g=e.wa({j:d,V:16E5});this.h=new ua;this.u()};this.J=function(d,e,f){var g=E;this.i=2;this.g=new va({ya:e,V:16E5});this.h=g.Ha({da:d,T:f});this.u()}};var J=null,E=null,K=[],M=0,I=null,N=[],O=0,P=[];function Q(a,c){O&&(window.clearTimeout(O),O=0);var b=u("#divMessage");if(0==a)b.style.display||(b.style.opacity="0",O=window.setTimeout(function(){O=0;x(b)},150));else{var d=t("span",b);1==a?(b.className="zb-notice",d[0].innerText="Notice"):(b.className="zb-alert",d[0].innerText="Error");d[1].innerText=c?c:"";b.style.opacity&&(w(b),O=window.setTimeout(function(){O=0;b.style.opacity=""},50))}}
function R(a){var c="";"string"===typeof a?window.msgs&&a&&window.msgs[a]?c=window.msgs[a]:c=a:a&&(c=JSON.stringify(a));Q(2,c)}function S(a){var c=a;window.msgs&&a&&window.msgs[a]&&(c=window.msgs[a]);Q(1,c)}function Va(a){S(a);O=setTimeout(function(){O=0;Q(0)},3E3)}
function Wa(a,c){function b(e){Xa--;"error"==e.type&&(Wa.hb=!0);if(0==Xa){var f=Wa.hb;delete Wa.hb;c&&c(f)}e=e.target||e.srcElement;e.hasAttribute("temporary")&&e.remove()}Xa++;var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",a);d.setAttribute("temporary","1");d.addEventListener("load",b);d.addEventListener("error",b);document.body.appendChild(d)}var Xa=0;
function Ya(a){J.ba()&&(u("#chkSaveKey").checked?Za().then(function(c){var b="";c&&c.lsauth&&(b=sa(!0,a,c.lsauth).toString(CryptoJS.enc.Base64url));J.C("key_words",b,!0)}).catch(function(c){R(c)}):J.C("key_words",null,!0))}function $a(){J.Ta(function(){E.Oa()})}
function Za(){return n(function*(){var a=new FormData;a.append("drive_type","localstorage");a=yield fetch("https://zgayard.f5.si/grantauth.php",{method:"POST",body:a,credentials:"include"});if(200==a.status)if(a=yield a.json()){if(a.error)throw"["+a.error+"] "+a.error_description;if(!a.lsauth)throw"lsFailed";}else throw"lsFailed";else throw(yield a.text())+" ("+a.status+")";return a})}
function ab(a){var c=u("#divSet"),b=u("#selDrive"),d=u("btnLogout",c,"button.iid");a?(b.disabled=!0,w(d),x(".zb-nav-tools"),x("#divMain")):(b.disabled=!1,x(d));w(c)}
function bb(a){if(!window.msgs||window.msgs.lang!=a){var c=window.msgs;window.msgs=null;Wa("msg/"+a+".js",function(){window.msgs?(window.msgs.lang=a,J.Y(a),cb()):(console.log("Message file of '"+a+"' is missing."),c?window.msgs=c:Wa("msg/en.js",function(){window.msgs?(window.msgs.lang="en",J.Y(window.msgs.lang),cb()):R("Message file is missing.")}))})}}
function cb(){var a=window.msgs;a.lblConfNotice=a.lblConfNotice.replace("{0}","_zgayard_.conf");var c=t("*"),b;for(b=0;b<c.length;b++){var d=c[b],e=null;d.hasAttribute("iid")&&(e=a[d.getAttribute("iid")])&&(d.innerText=e);!e&&d.hasAttribute("vid")&&(e=a[d.getAttribute("vid")])&&(d.value=e);!e&&d.id&&(e=a[d.id]);e&&("button"==d.type?d.value=e:d.innerText=e);d.hasAttribute("tid")&&(e=a[d.getAttribute("tid")])&&(d.title=e)}c=u("#seLang");b="";for(b in ba)d=document.createElement("option"),d.value=b,
d.innerText=ba[b],b==a.lang&&(d.selected=!0),c.appendChild(d)}function db(a){S("loading");var c=Aa[a];c?(E=new c.g(J,"https://zgayard.f5.si/grantauth.php"),E.Fa(!0).then(function(b){if(b)"redirect"!=b&&J.Ta(function(){R(window.msgs.loginFailed.replace("{0}",b))});else{J.Xa();var d=u("img",v("div",u("#spanQuota")));d.src="img/"+a+".png";d.alt=c.B();E.X({U:"_zgayard_.conf"}).then(function(e){0==e.length?T(!0):eb(e[0].j)}).catch(function(e){R(JSON.stringify(e))})}})):R("unkDrive")}
function fb(){if(u("#chkAgreeTos").checked){var a="",c="";if(u("#chkOwnSecret").checked&&(a=u("#txtClientId").value,c=u("#txtClientSecret").value,!a||!c)){R("noClientIdS");return}var b=u("#selDrive"),d=!1;b.disabled||(d=J.Ya(b.value));var e=null;u("#chkOwnSecret").checked&&(e={za:a,ga:c});J.P(e);J.Za(u("#chkSkipLogin").checked);J.Ra(u("#txtRelay").value);bb(u("#seLang").value);d?(J.R(),db(b.value)):J.Xa();gb()}else R("noAgreeTos")}
function gb(){var a=u("#selDrive");x("#divSet");a.disabled&&(w(".zb-nav-tools"),w("#divMain"))}function hb(a,c){var b=u("#divPwd"),d=!1;a?(b.setAttribute("addroot","1"),d=!0):b.removeAttribute("addroot");a=t("*",b);for(b=0;b<a.length;b++){var e=a[b];e.classList.contains("addroot")?d?w(e):x(e):e.classList.contains("firstep")?d&&c?w(e):x(e):e.classList.contains("chgroot")&&(d?x(e):w(e));"password"==e.type&&(e.value="")}ib()}
function jb(){if(window.confirm(window.msgs.delConfirm)){S("deleting");var a=u("#selRoot"),c=a.value,b=-1;K.forEach(function(g,k){g.root==c&&(b=k)});var d=function(){if(b==M)window.location.reload();else{var g=t("option",a),k;for(k=0;k<g.length;k++){var l=g[k];if(l.value==c){a.removeChild(l);break}}Va("delrootDone")}};if(0<=b){var e=function(){K.splice(b,1);kb(d)},f=function(g){E.delete({G:g}).then(e).catch(function(k){R(k)})};E.X({U:K[b].root}).then(function(g){0==g.length?e():f(g[0].j)}).catch(function(g){console.error(g)})}else d()}}
function T(a){a?"boolean"===typeof a?hb(!0,!0):(hb(),x(".zb-nav-tools"),x("#divMain")):hb();w("#divPwd");Q(0)}function lb(a){x("#divPwd");a&&0<N.length&&(w(".zb-nav-tools"),w("#divMain"))}function mb(){var a=y(v("div")),c=a.children[0].cloneNode(!0);c.value="";a.appendChild(c)}function ib(){var a=u("#divfKey");a=t("file",a,"input.type");var c;for(c=a.length-1;0<c;c--)a[c].remove();a[0].value=""}
function nb(){S("loading");var a=u("#divPwd").hasAttribute("addroot"),c=u("#pwdKey").value,b=t("input",u("#divfKey")),d=[],e=0,f=0;for(e=0;e<b.length;e++){var g=b[e].files;for(f=0;f<g.length;f++)d.push(g[f])}if(c||0<d.length){if(a){b=u("#pwdKeyRe").value;if((c||b)&&c!=b){R("diffPwd");return}if(!u("#txtRoot").value){R("noRoot");return}}var k=null;c&&(k=CryptoJS.enc.Utf8.parse(c));if(0<d.length){var l=new FileReader,m=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA512,"zb12");e=0;l.g=function(){l.readAsArrayBuffer(d[e].slice(0,
1023));e++};l.onload=function(p){m.update(new CryptoJS.lib.WordArray.init(p.target.result));e<d.length?l.g():(k?k.concat(m.finalize()):k=m.finalize(),k.clamp(),ob(k,a))};l.g()}else ob(k,a)}else R("noPwd")}
function ob(a,c){var b=CryptoJS.HmacMD5(a,"zgayard").toString(CryptoJS.enc.Base64url).slice(0,8),d=null;if(c){var e={root:u("#txtRoot").value};u("#chkEncryFname").checked&&(e.encfname=!0);var f=!1;K.forEach(function(l){l.root==e.root&&(f=!0)});f?R("dupRoot"):(J.C("root",e.root),Ya(a),d=CryptoJS.lib.WordArray.random(1024),I=ra(d),e.iv=b.concat(pb(!0,d,a)),M=K.length,K.push(e),qb(e,!0),kb())}else{var g=u("#selRoot").value,k=-1;K.forEach(function(l,m){l.root==g&&(k=m)});0<=k&&K[k].iv&&b==K[k].iv.slice(0,
b.length)?(M=k,J.C("root",g),Ya(a),d=pb(!1,K[M].iv.slice(b.length),a),I=ra(d),rb()):ia(u("#divPwd"))?R("pwdError"):T()}}function pb(a,c,b){b=ra(b);var d=null;a?d=c:d=CryptoJS.enc.Base64url.parse(c);c=sa(a,d,b);return a?c.toString(CryptoJS.enc.Base64url):c}function kb(a){var c=CryptoJS.enc.Utf8.parse(JSON.stringify(K));c=new Blob([new Uint8Array(ta(c))],{type:"application/octet-binary"});c=new va({ya:c,V:262144});var b=E.Ha({da:"_zgayard_.conf"});ya(c,b).then(a||rb)}
function eb(a){var c=new ua;ya(E.wa({j:a}),c).then(function(){var b=new CryptoJS.lib.WordArray.init(c.u());b=JSON.parse(b.toString(CryptoJS.enc.Utf8));Array.isArray(b)?K=b:K.push(b);var d=-1,e=J.v("root"),f=u("#selRoot");f.innerHTML="";K.forEach(function(k,l){var m=!1;e&&k.root==e&&(m=!0);qb(k,m,f);m&&(d=l)});if(0<=d){M=d;var g=J.v("key_words");g?Za().then(function(k){k&&k.lsauth&&!k.newkey?(k=sa(!1,CryptoJS.enc.Base64url.parse(g),k.lsauth),ob(k)):T()}).catch(function(k){R(k)}):T()}else M=0,T()})}
function qb(a,c,b){b=b||u("#selRoot");var d=document.createElement("option");d.value=a.root;d.innerText=a.root;c&&(d.selected=!0);b.appendChild(d)}function sb(){window.confirm(window.msgs.dropConfirm)&&J.mb(function(a){a?R(a):E.Oa()})};var tb=3;function ub(a,c){switch(a){case "new":var b="spanNew";break;case "upload":b="spanUpload";break;case "selfldr":b="spanSelFldr";break;default:return}var d=u("#divModal"),e=u("#spanModal");e.innerText=window.msgs[b];b=t("div",y(e));var f;for(f=0;f<b.length;f++)e=b[f],e.hasAttribute("type")&&(e.getAttribute("type")==a?w(e):x(e));c&&(d.g=c);w(d)}function vb(a){if(a=v("zb-modal",u(a),"div.class"))a.g&&(a.g(),delete a.g),x(a)}
function wb(a){function c(g){g&&vb(a)}var b="",d=t("div",y(u("#spanModal"))),e=0;for(e=0;e<d.length;e++){var f=d[e];if(f.hasAttribute("type")&&ia(f)){b=f.getAttribute("type");break}}switch(b){case "new":xb(c);break;case "upload":b=[];d=u("#upfiles").files;for(e=0;e<d.length;e++)b.push(d[e]);d=u("#upfolder").files;for(e=0;e<d.length;e++)b.push(d[e]);0>=b.length?R("noFiles"):(c(!0),yb(b));break;case "selfldr":zb(c)}}function Ab(a){return u(".zb-main-header",a).children[0]}
function Bb(a){return u("zb-main-list",a,"ul.class")}function Cb(a){return u("fnm",a,"span.name")}function Db(a){if(K[M].encfname){var c=I;a=CryptoJS.enc.Utf8.parse(a);c=sa(!0,a,c).toString(CryptoJS.enc.Base64url)}else c=a;return c}function Eb(a){if(K[M].encfname)try{var c=I,b=CryptoJS.enc.Base64url.parse(a);return sa(!1,b,c).toString(CryptoJS.enc.Utf8)}catch(d){console.error(d)}return a}
function Fb(){J=new za;J.ob(function(a){a&&R("IndexedDB is not supported in your browser settings.");a=J.Va();a||(J.Wa(),a=J.Va(!0));if(!a){a=navigator.language;var c=a.indexOf("-");0<c&&(a=a.substring(0,c))}bb(a);u("#txtRelay").value=J.Qa();a=J.kb();if(c=J.Ua())u("#chkOwnSecret").click(),u("#txtClientId").value=c.za,u("#txtClientSecret").value=c.ga;c=u("#selDrive");var b=ma(),d;for(d in Aa){var e=document.createElement("option");e.value=d;e.innerText=Aa[d].B();a?a==d&&(e.selected=!0):b&&b.state==
Aa[d].j&&(a=d,e.selected=!0);c.appendChild(e)}J.ba()?(J.m&&(u("#chkSkipLogin").checked=!0),J.v("key_words")&&(u("#chkSaveKey").checked=!0)):(x("#divSkipLogin"),x("#divSaveKey"));a?db(a):ab()})}
function rb(){[Ab("#divMain"),u("ul","#divHistory")].forEach(function(a){var c=t("li",a);for(a=0;a<c.length;a++)c[a].classList.contains("template")||c[a].remove()});Gb(!1);lb();w(".zb-nav-tools");w("#divMain");Hb(function(){var a=K[M].root;E.X({U:a}).then(function(c){c&&0<c.length?(N=[],N.push(c[0]),Ib(),U(),Jb()):E.la({L:a}).then(function(b){N=[];N.push(b);Ib();U()}).catch(function(b){R(JSON.stringify(b))})}).catch(function(c){R(JSON.stringify(c))})})}
function Kb(a,c){var b=u("#spanQuota");"string"==typeof a&&(a=parseInt(a,10));var d=z(b,"total"),e=z(b,"trash"),f=0;b.hasAttribute("used")&&(f=z(b,"used"));if(c){if(f-=a,b.setAttribute("used",f),0<d){b.setAttribute("trash",e+a);return}}else f+=a,b.setAttribute("used",f);b.innerText=0<d?window.msgs.quotaInfo.replace("{0}",D(d-f-e)):window.msgs.quotaInfoU.replace("{0}",D(f))}
function Hb(a){E.xa({}).then(function(c){var b=u("#spanQuota");b.setAttribute("total",c.La);b.setAttribute("trash",c.Ma);Kb(c.pa);a&&a()}).catch(function(c){R(c)})}function Gb(a){function c(d,e){d=u(d,b,"div.class");e=u("menuHistory",d,e.concat(".iid"));e=v("li",e);a?w(e):x(e)}var b=u("nav");c("zb-nav-tools","span");c("zb-nav-menu","label")}
function Jb(){if(P=J.nb()){var a=u("ul","#divHistory"),c=function(b){if(b>=P.length)0<P.length&&Gb(!0);else{var d=P[b];E.ca({aa:d.G}).then(function(e){e.K&&(d.L=e.K);Lb(b,Eb(e.o),a);c(b+1)}).catch(function(){})}};c(0)}}
function Lb(a,c,b){b||(b=u("ul","#divHistory"));a=P[a];var d=null,e=u(a.L,b,"li.parentId");if(null==e){e=u("template",b,"li.class").cloneNode(!0);e.classList.remove("template");var f=t("span",e),g;for(g=0;g<f.length;g++){var k=f[g];switch(k.getAttribute("name")){case "delete":k.addEventListener("click",Mb);break;case "file":k.addEventListener("click",Nb);d=k;break;case "next":k.addEventListener("click",Ob)}}e.setAttribute("parentId",a.L);b.appendChild(e)}else d=u("file",e,"span.name");d.innerText=
c;a.ka&&(c=d,b=d.innerText.concat(" ["),d=b.concat,a=Math.floor(a.ka),e=Math.floor(a/3600),a-=3600*e,f=Math.floor(a/60),a-=60*f,g=[],0<e?(g.push(e.toString()),g.push("0".concat(f).slice(-2))):g.push(f.toString()),g.push("0".concat(a).slice(-2)),c.innerText=d.call(b,g.join(":")).concat("]"))}
function U(a,c,b,d){var e=0;if(!b){if(0>=N.length)return;e=N.length-1;b=N[e]}var f="#divMain";c&&(f="#divModal");var g=0;g=u(f);f=Ab(g);var k=Bb(g);S("loading");var l=V(k);for(g=0;g<l.length;g++)k.removeChild(l[g]);(g=ja(f,void 0,!0))&&g.classList.contains("template")&&(g=null);a?g&&g.classList.remove("normal"):(g&&(0!=e||c)&&g.classList.add("normal"),Pb(f,b,e));E.X({A:b.j}).then(function(m){var p=[],q=0;m.forEach(function(F){var L=0,na=p.length;F.o=Eb(F.o);for(W(F)?na=q++:L=q;L<na&&!(F.o<p[L].o);)L++;
L<p.length?p.splice(L,0,F):p.push(F)});p.forEach(function(F){c&&!W(F)||Qb(k,F)});if(!c){var r=u("#chkAll"),B=v("li",r);u("checkbox",B,"input.type").checked=!1;x(u("chkbox",B,"span.name"));0<m.length?w(r):x(r)}d?d(p):Q(0)}).catch(function(m){R(m)})}
function Pb(a,c,b,d){var e=u("template",a,"li.class").cloneNode(!0);u("span",e).innerText=c.o;e.setAttribute("name","folder");e.setAttribute("uid",c.j);e.setAttribute("idx",b);e.addEventListener("click",Rb);e.classList.remove("template");d&&e.classList.add("normal");w(e);a.appendChild(e)}
function Qb(a,c){var b=c.o,d="",e="",f=u("template",a,"li.class").cloneNode(!0);f.classList.remove("template");f.setAttribute("uid",c.j);f.setAttribute("utype",c.N);var g=t("span",f),k;for(k=0;k<g.length;k++){var l=g[k];switch(l.getAttribute("name")){case "fnm":l.innerText=b;l.addEventListener("click",X);break;case "icon":if(W(c))C(l,"folder","#FFD679");else{var m=pa(b);ca[m]?C(l,"image","#E7FFE7"):ea[m]?C(l,"video","#FFE7F3"):da[m]?C(l,"audio","#DBFBFD"):C(l,"file","#FFFFB0")}l.addEventListener("click",
Sb);break;case "chkbox":l.addEventListener("click",Sb);x(l);break;case "edit":l.addEventListener("click",Tb);break;case "size":d||(d=D(c.O));l.innerText=d;break;case "tms":if(!e)if(e=c.oa){e=new Date(e);m=[];var p=[];m.push(e.getFullYear());m.push(e.getMonth()+1);m.push(e.getDate());p.push("0".concat(e.getHours()).slice(-2));p.push("0".concat(e.getMinutes()).slice(-2));p.push("0".concat(e.getSeconds()).slice(-2));e=m.join("-")+" "+p.join(":")}else e="";l.innerText=e}}w(f);a.appendChild(f)}
function Ub(a,c){var b=u("checkbox",a,"input.type");1==c?b.checked=!0:-1==c?b.checked=!1:(b.checked=!b.checked,c=b.checked?1:-1);0<c?w(u("chkbox",a,"span.name")):x(u("chkbox",a,"span.name"))}function Sb(){Ub(v("li"))}function X(a,c,b){var d=null,e=!1;"string"!=typeof a&&(d=v("li"),a=d.getAttribute("uid"),e="selfldr"==v("div",d).getAttribute("type"));if(c||!d)d=Vb(a,c,b),a=d.getAttribute("uid");c={j:a,o:Cb(d).innerText,N:d.getAttribute("utype")};W(d)?e?U(!1,!0,c):(N.push(c),U()):Wb(c.j,c.o)}
function Rb(){for(var a=v("li"),c=v("ul",a),b="selfldr"==v("div",c).getAttribute("type"),d=0,e=y(a);e;)e.tagName==a.tagName&&d++,e=y(e);if(0<d)for(e=0;e<d;e++)c.removeChild(c.lastElementChild);b?U(!0,!0,{o:u("span",a).innerText,j:a.getAttribute("uid")}):(d=z(a,"idx"),d<N.length-1&&N.splice(d+1),U(!0))}function W(a){return"1"==(a instanceof HTMLElement?a.getAttribute("utype"):"string"==typeof a?a:a.N)}
function Xb(){var a=v("li"),c=u("checkbox",a,"input.type");Ub(a);var b=-1;c.checked&&(b=1);a=t("li",v("ul",a));for(c=0;c<a.length;c++)a[c].classList.contains("header")||a[c].classList.contains("template")||Ub(a[c],b)}
function Tb(a){var c=v("span"),b=c.getBoundingClientRect();c=v("li",c);var d=u("#ulIteMenu");if(d.hasAttribute("ofwid"))var e=parseInt(d.getAttribute("ofwid"),10);else d.style.display="block",e=d.offsetWidth,d.setAttribute("ofwid",e);d.style.left=b.right+e>document.body.offsetWidth?b.left-e+"px":b.right+"px";d.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+b.top+"px";d.setAttribute("uid",c.getAttribute("uid"));d.setAttribute("utype",c.getAttribute("utype"));a.ra=tb}
function Vb(a,c,b){if(!a)return null;var d=Bb("#divMain");d=V(d);var e;for(e=0;e<d.length&&d[e].getAttribute("uid")!=a;e++);if(e>=d.length)return null;switch(c){case 1:for(;0<=e;){e--;if(0>e){if(b)return null;b=!0;e=d.length-1}if(!W(d[e]))break}break;case 2:for(;e<d.length;){e++;if(e>=d.length){if(b)return null;b=!0;e=0}if(!W(d[e]))break}}return d[e]}
function Yb(a){var c=v("li"),b=v("ul",c),d=b.getAttribute("uid");if(d)switch(u("label",c).getAttribute("iid")){case "menuDownload":W(b)?R("noDownFolder"):Zb(d);break;case "menuRename":c=u("#divInpName");b=u("input",c);var e=Vb(d);d=Cb(e);var f=d.getBoundingClientRect();e=u("edit",e,"span.name").getBoundingClientRect();b.value=d.innerText;c.style.left=f.left+"px";c.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+f.top-2+"px";b.style.width=e.left-f.left+"px";b.style.height=f.height+
2+"px";w(c);b.focus();a.ra=4;break;case "menuMove":$b(d);break;case "menuDelete":ac(d)}}function Zb(a){var c=Vb(a);a={o:Cb(c).innerText,j:a};bc([a])}function $b(a){var c=void 0,b=u("#divModal");if("string"==typeof a)b.setAttribute("uid",a);else if(cc())b.removeAttribute("uid"),c=a;else return;a=Ab(b);b=V(a);var d;for(d=0;d<b.length;d++)a.removeChild(b[d]);U(!1,!0,N[0]);ub("selfldr",c)}
function dc(a){if(13===a.keyCode){if(a.shiftKey||a.ctrlKey||a.altKey)return!0}else return 27===a.keyCode?(x(v("div")),!1):!0;ec();return!1}function ec(){var a=v("div"),c=u("input",a);if(c.value){var b=u("#ulIteMenu").getAttribute("uid"),d=Vb(b);if(d){var e=Cb(d);c.value!=e.innerText&&(d=Db(c.value),Ha({G:b,$:d}).then(function(){e.innerText=c.value;Va("renDone")}).catch(function(f){R(f)}))}x(a)}else R("noNewName")}
function zb(a){var c=u("#divModal"),b=Ab(c),d=ja(b,"li",!0).getAttribute("uid");if(d==N[N.length-1].j)a&&a(!1);else{a&&a(!0);var e=[];(a=c.getAttribute("uid"))?e.push({j:a,o:""}):e=cc();0!=e.length&&(S("moving"),function(){return n(function*(){var f;for(f=0;f<e.length;f++)yield Ia({G:e[f].j,A:d,Ka:N[N.length-1].j})})}().then(function(){U(!0,!1,void 0,function(){Va("moveDone")})}).catch(function(f){R(f)}))}}
function ac(a){var c=null;a?c=[{j:a,o:""}]:c=cc();c&&confirm(window.msgs.delConfirm)&&(S("deleting"),function(){return n(function*(){var b;for(b=0;b<c.length;b++){var d=yield E.delete({G:c[b].j});d&&Kb(d,!0)}})}().then(function(){U(!0,!1,void 0,function(){Va("delDone")})}).catch(function(b){R(b)}))}
function xb(a){var c=u("#fldnm").value;if(c){var b=u("#chkFInto").checked,d={L:Db(c)};0<N.length&&(d.A=N[N.length-1].j);E.la(d).then(function(e){e.o=c;if(b){var f=void 0;a&&(f=function(){a(!0);Q(0)});N.push(e);U(!1,!1,void 0,f)}else a&&(Qb(Bb("#divMain"),e),a(!0),Va("flDone"))}).catch(function(e){R(e.ea);a&&a(!1)})}else R("noFldName"),a&&a(!1)}
function cc(a){var c=[],b=V(Bb("#divMain")),d;for(d=0;d<b.length;d++)if(u("checkbox",b[d],"input.type").checked){if(a&&W(b[d]))return R("noDownFolder"),null;c.push({o:Cb(b[d]).innerText,j:b[d].getAttribute("uid")})}return 0>=c.length?(R("noChecks"),null):c}
function Wb(a,c){var b=u("#diViewer"),d=v("zb-viewer",b,"div.class"),e=u("title",d,"span.name"),f=u("span",b),g=u("img",b),k=fc(b);f.innerText=window.msgs.loading;w(f);x(y(f));x(g);e.innerText=c;g.src="";b.setAttribute("uid",a);w(v("zb-modal",d,"div.class"));b=pa(c);var l=ca[b];b=ea[b];if(navigator.serviceWorker&&navigator.serviceWorker.controller&&b)k.fid=a,k.h=c,k.src="sw/"+a,w(k),x(f);else if(l){var m=new ua,p=function(q,r){q||!r?console.log(q||!r):(q=m.u(),q instanceof Uint8Array||(q=new Uint8Array(q)),
l&&(g.src=window.URL.createObjectURL(new Blob([q],{type:l})),w(g),x(f)))};(new xa({$a:!0,na:I,bb:E.wa({j:a,V:16E4}),eb:m})).start().then(function(q){p(void 0,q)}).catch(function(q){p(q)})}else f.innerText=window.msgs.cantView,w(y(f))}function hc(a){var c=u(a?a:"#diViewer");c=y(c,"div");var b="";if(a){if(c.style.opacity)return;b="1"}for(;c;)c.style.opacity=b,c=y(c,"div");a&&window.setTimeout(hc,5E3)}function ic(){var a=u("#diViewer").getAttribute("uid");a&&X(a,1)}
function jc(){var a=u("#diViewer").getAttribute("uid");a&&X(a,2)}function kc(a){fc(u("#diViewer"));vb(a)}function lc(){var a=u();a&&a.src&&window.URL.revokeObjectURL(a.src)}
function fc(a){a=u("video",a);var c=a.currentTime;a.src&&(a.removeAttribute("src"),a.load());if(a.fid){navigator.serviceWorker&&navigator.serviceWorker.controller.postMessage({action:3,fid:a.fid});var b=N[N.length-1].j,d=a.h,e;P||(P=[]);for(e=0;e<P.length;e++)if(P[e].L==b){P[e].G=a.fid;P[e].ka=c;break}e==P.length&&P.push({G:a.fid,L:b,ka:c});delete a.fid;delete a.h;J.qb(P[e],e);Lb(e,d);Gb(!0)}x(a);return a}
function mc(a){if((a=a.getAttribute("parentId"))&&P){var c;for(c=0;c<P.length;c++)if(P[c].L==a)return c}return-1}
function Nb(a,c){u("close","#divHistory","span.name").click();a=u(a);a=v("li",a);a=mc(a);if(!(0>a)){a=P[a];var b=a.G,d=a.L,e=a.ka;S("loading");var f=[],g=function(){d?d==N[0].j?(f.unshift(N[0]),k()):E.ca({aa:d}).then(function(l){l.o=Eb(l.o);f.unshift(l);l.K==N[0].K?d=void 0:d=l.K;g()}).catch(function(){}):S("cantPlayRecent")},k=function(){var l=Ab("#divMain"),m=0,p=t("li",l);for(m=0;m<p.length;m++)p[m].classList.contains("template")||p[m].remove();for(m=0;m<f.length;m++)Pb(l,f[m],m,!0);N=f;U(!0,!1,
void 0,function(q){Q(0);var r;for(r=0;r<q.length&&q[r].j!=b;r++);r<q.length&&(c?X(b,2):(e&&u("video","#diViewer").setAttribute("ctime",e),X(b)))})};g()}}function Ob(a){Nb(a,!0)}function nc(a){a=u(a);var c=a.getAttribute("ctime");c&&(a.removeAttribute("ctime"),a.currentTime=c)}function Mb(a){a=u(a);a=v("li",a);var c=mc(a);0>c||(a.remove(),P.splice(c,1),J.pb(c),0==P.length&&Gb(!1))};const oc=window.Worker?!0:!1;var Y=null;function pc(a){this.h=a;this.g=[];this.l=function(c){return this.h.j==c.j};this.u=function(c){return this.h.o==c};this.m=function(c){var b;for(b=0;b<this.g.length;b++)if(this.g[b].u(c))return this.g[b];return null};this.i=function(c){var b;for(b=0;b<this.g.length;b++)if(this.g[b].l(c))return this.g[b];c=new pc(c);this.g.push(c);return c}}var qc=null;
function V(a,c){var b=[],d=a.getElementsByTagName("li");for(a=0;a<d.length;a++){var e=d[a];if(!e.classList.contains("header")&&!e.classList.contains("template"))if(c){var f=c(e);2!=f&&-2!=f||b.push(e);if(0>f)break}else b.push(e)}return b}function rc(a){a=u(a);x(a);Y?(a=v("li",a),a={type:9,rowIdx:z(a,"rowIdx")},Y.postMessage(a)):a.setAttribute("canceled","1")}
function sc(a,c,b){var d=0,e=0;c||(c=u(".zb-qbutton"));!b&&c.hasAttribute("count")&&(b=z(c,"count"));c.hasAttribute("fincount")&&(d=z(c,"fincount"));c.hasAttribute("stopcount")&&(e=z(c,"stopcount"));switch(a){case 1:d++;c.setAttribute("fincount",d);break;case 3:c.setAttribute("haserr","1");case 2:e++,c.setAttribute("stopcount",e)}0<b?u("div",c).style.width=Math.floor(100*d/b)+"%":u("div",c).style.width="0%";b==d+e&&(c.hasAttribute("haserr")?c.classList.add("error"):c.classList.add("done"))}
function tc(a){var c=u(".zb-qbutton"),b=0;c.hasAttribute("count")&&(b=z(c,"count"));b+=a;c.setAttribute("count",b);sc(0,c,b);c.classList.contains("error")&&c.classList.remove("error");c.classList.contains("done")&&c.classList.remove("done");w(c)}
function uc(a){a=v(".zb-queue",u(a));var c=u(".zb-qbutton");a.style.top="100%";if(c.classList.contains("done")||c.classList.contains("error")){x(c);c.removeAttribute("count");c.removeAttribute("fincount");c.removeAttribute("stopcount");c.removeAttribute("haserr");a=u("ul",a);c=V(a);var b;for(b=c.length-1;0<=b;b--)a.removeChild(c[b]);a.removeAttribute("rowCount")}}
function vc(a,c,b){var d=0;a.hasAttribute("rowCount")&&(d=z(a,"rowCount"));var e=u("template",a,"li.class").cloneNode(!0);e.classList.remove("template");e.setAttribute("rowIdx",d);b&&e.setAttribute("downFl",1);a.setAttribute("rowCount",d+1);d=t("span",e);var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "cancel":g.addEventListener("click",rc);break;case "icon":u("label",g).innerText=c;b?C(g,"download"):C(g,"upload");break;case "elTime":ja(g,"label").innerText=window.msgs.elTime;
break;case "esTime":ja(g,"label").innerText=window.msgs.esTime;break;case "speed":g.innerText=window.msgs.waiting}}a.appendChild(e);return e}function wc(a,c){c||(c=u("ul","#divQueue"));c=V(c,function(b){return b.getAttribute("rowIdx")==a?-2:1});return 0<c.length?c[0]:null}function xc(a,c){var b=0;if(1==a)b=1;else if(2!=a)return;a=t("svg",".zb-qbutton")[b];c?a.classList.add("pulse"):a.classList.remove("pulse")}
function yc(a,c){var b=null,d=t("span",a),e="";switch(c.type){case 0:e="0%";xc(c.wtype,!0);break;case 1:e=Math.round(100*c.posn/c.size)+"%";break;case 2:e="100%";case 3:xc(c.wtype)}var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "icon":b=g;break;case "percent":switch(c.type){case 0:case 1:g.innerText=e;break;case 2:c.errr||(g.innerText=e)}break;case "elTime":switch(c.type){case 1:case 2:case 3:g.innerText=oa(Math.floor((Date.now()-c.begin)/1E3))}break;case "esTime":switch(c.type){case 1:g.innerText=
oa(Math.round((c.size-c.posn)/c.spd))}break;case "speed":switch(c.type){case 1:g.innerText=D(c.spd)+"/s";break;case 2:case 3:c.errr||(a.classList.add("done"),g.innerText=window.msgs.avspeed.replace("{0}",D(1E3*c.posn/(Date.now()-c.begin))))}break;case "cancel":switch(c.type){case 0:w(g);break;case 2:case 3:var k=u("svg",g);k.removeChild(k.firstElementChild);c.errr||3==c.type?(C(g,"multi"),sc(c.errr?3:2)):(C(g,"chkbox",void 0,"#10B981"),sc(1));w(g)}break;default:if((k=v("div",g))&&k.classList.contains("zb-progressbar"))switch(c.type){case 0:case 1:g.style.width=
e;break;case 2:c.errr?(a.classList.add("error"),k.innerText=c.errr):g.style.width=e}}}return b}function zc(a,c){c=wc(a.rowIdx,c);Ac(c,a)}function Ac(a,c){var b=!1;switch(c.type){case 0:case 1:yc(a,c);break;case 2:c.fined&&Y&&Bc();a=yc(a,c);c.errr||(2==c.wtype?Kb(c.size):1==c.wtype&&c.blob&&(a=u("label",a).innerText,ka(c.blob,a,u("#lnkDown"))));window.gc&&window.gc();b=!0;break;case 3:c.fined&&Y&&Bc(),yc(a,c),window.gc&&window.gc(),b=!0}return b}
function Bc(){var a=Y;qc=Y=null;a.terminate();a.g&&U(!0)}function Cc(a){Y||(Y=new Worker("worker.js"),Y.h={gtoken:E.h?E.h:"",iv:I.iv.toString(CryptoJS.enc.Base64url),key:I.key.toString(CryptoJS.enc.Base64url),drvid:E.m(),encfname:K[M].encfname?!0:!1},Y.addEventListener("message",function(c){zc(c.data)}));a.cominf=Y.h;2!=a.type||Y.g||(Y.g=!0);Y.postMessage(a)}
function Dc(a,c){var b=z(a,"rowIdx"),d=u("cancel",a,"span.name");return new Ua(function(){return d.getAttribute("canceled")?!0:!1},function(e){e.rowIdx=b;Ac(a,e)&&c()})}function bc(a){var c=u("ul","#divQueue"),b=0;tc(a.length);for(b=0;b<a.length;b++){var d=vc(c,a[b].o,!0);oc?Cc({type:1,rowIdx:z(d,"rowIdx"),downinf:{targetId:a[b].j}}):a[b].K=d.getAttribute("rowIdx")}if(!oc){var e=function(f){var g=wc(parseInt(a[f].K,10),c);Dc(g,function(){f++;f<a.length&&e(f)}).B(a[f].j)};e(0)}}
function yb(a){function c(l){var m=d[l];Ec(k,m.rb,function(p,q,r){p?zc({type:2,wtype:2,rowIdx:m.ha,size:0,errr:JSON.stringify(p)},b):oc?(Cc({type:2,rowIdx:m.ha,upinf:{fname:q,file:m.ab,ptid:r}}),l++,l<d.length&&c(l)):(p=wc(m.ha,b),Dc(p,function(){l++;l<a.length?c(l):U(!0)}).J(q,m.ab,r))})}var b=u("ul","#divQueue"),d=[],e=0;tc(a.length);for(e=0;e<a.length;e++){var f="";f=a[e].webkitRelativePath?a[e].webkitRelativePath:a[e].name;var g=vc(b,f);d.push({rb:f,ab:a[e],ha:z(g,"rowIdx")})}qc||(qc=new pc(N[0]));
var k=qc;for(e=1;e<N.length;e++)k=k.i(N[e]);c(0)}function Ec(a,c,b){var d=c.split("/"),e=Db(d.pop()),f=a;if(0==d.length)b(!1,e,f.h.j);else{var g=!1,k=function(l){function m(B){f=B;l++;l<d.length?k(l):b(!1,e,f.h.j)}var p=d[l],q=Db(p);if(g)E.la({L:q,A:f.h.j}).then(function(B){B.o=p;m(f.i(B))}).catch(function(B){b(B,e)});else{var r=f.m(p);r?m(r):E.X({U:q,A:f.h.j}).then(function(B){0==B.length?(g=!0,k(l)):(B[0].o=p,m(f.i(B[0])))}).catch(function(B){b(B,e)})}};k(0)}};function Fc(a){return n(function*(){var c=a.data;switch(c.action){case 1:c.cominf={gtoken:E.h?E.h:"",iv:I.iv.toString(CryptoJS.enc.Base64url),key:I.key.toString(CryptoJS.enc.Base64url),drvid:E.m(),encfname:K[M].encfname?!0:!1};navigator.serviceWorker.controller.postMessage(c);break;case 2:c.msg&&(console.error(c.msg),R(c.msg))}})}
function Ib(){n(function*(){if(navigator.serviceWorker){yield navigator.serviceWorker.register("sw.js");yield navigator.serviceWorker.ready;navigator.serviceWorker.addEventListener("message",Fc);var a=u("btnUnregSw",void 0,"button.iid");w(a);return!0}return!1})}
function Gc(){return n(function*(){if(!navigator.serviceWorker)return console.error("no service worker"),!1;var a=yield navigator.serviceWorker.getRegistration();if(!a)return console.error("no service worker registration"),!1;if(!window.confirm(window.msgs.unswConfirm))return!1;(a=yield a.unregister())&&console.debug("service worker uninstalled.");var c=u("btnUnregSw",void 0,"button.iid");x(c);return a})};var Z=null;function Hc(a){switch(a){case 1:a=u(".zb-nav-tools");a={S:u("button",a),M:y(a)};break;case 2:a=u("button",u(".zb-main-header","#divMain"));a={S:a,M:y(a)};break;case tb:a={M:u("#ulIteMenu")};break;default:return null}return a}function Ic(a){var c=Hc(a);c&&(c.M.style.display="none",c.M.style.maxHeight="0px",c.S&&c.S.addEventListener("click",function(b){b.ra=a}))}
function Jc(a,c){var b=Hc(c);b&&(b.M.style.display?b.M.style.maxHeight&&a.ra==c&&(w(b.M),b.S&&(x(b.S.children[0]),w(b.S.children[1])),window.setTimeout(function(){b.M.style.maxHeight="";b.M.style.paddingTop="";b.M.style.paddingBottom=""},50)):b.M.style.maxHeight||a.ra==c&&!b.S||(b.M.style.paddingBottom="0px",b.M.style.maxHeight="0px",window.setTimeout(function(){b.S&&(w(b.S.children[0]),x(b.S.children[1]));b.M.style.paddingTop="0px";x(b.M)},500)))}
function Kc(a){Jc(a,1);Jc(a,2);Jc(a,tb);4!=a.ra&&x("#divInpName")}function Lc(a){a=a.target||a.srcElement;"INPUT"!=a.tagName&&(a=u("input",v("div",a)),a.focus(),a.click())}function Mc(a){var c=v("li",a);switch(a.getAttribute("iid")){case "menuGeneral":c.addEventListener("click",ab);break;case "menuDrive":c.addEventListener("click",T);break;case "menuHistory":c.addEventListener("click",function(){u("#divHistory").style.top=""})}}
function Nc(){var a=u("label",v("li")),c=a.getAttribute("iid"),b=void 0;(a=y(a))&&(b=function(){a.classList.remove("rotate-90")});switch(c){case "menuNewFldr":a&&a.classList.add("rotate-90");ub("new",b);break;case "menuUpload":a&&a.classList.add("rotate-90");ub("upload",function(){u("#upfiles").value=null;u("#upfolder").value=null;b&&b()});break;case "menuMovefs":a&&a.classList.add("rotate-90");$b(b);break;case "menuDownfs":(c=cc(!0))&&bc(c);break;case "menuDelfs":ac()}}
window.addEventListener("load",function(){var a=RegExp("android","i").test(navigator.userAgent),c=u("#divMessage"),b=t("span",c);b[b.length-1].children[0].addEventListener("click",function(){Q(0)});document.addEventListener("click",Kc);Ic(1);Ic(2);Ic(tb);var d=0;c=0;b=t("span",u(".zb-nav-tools"));for(d=0;d<b.length;d++)Mc(b[d]);b=t("label",u(".zb-nav-menu"));for(d=0;d<b.length;d++)Mc(b[d]);b=t(".zb-settings");for(d=0;d<b.length;d++){var e=t(".checkbox",b[d]);for(c=0;c<e.length;c++)e[c].addEventListener("click",
Lc)}u("#chkOwnSecret").addEventListener("click",function(f){f=f.target||f.srcElement;var g=t(".ownsecret","#divSet"),k;for(k=0;k<g.length;k++)f.checked?w(g[k]):x(g[k])});c=u("#divSet");b=t("button",c);for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnLogout":c.addEventListener("click",$a);break;case "btnCancel":c.addEventListener("click",gb);break;case "btnOk":c.addEventListener("click",fb)}b=t("span",u("#divPwd"));for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("tid")){case "spanAddRoot":c.addEventListener("click",
hb);break;case "spanDeleteRoot":c.addEventListener("click",jb);break;case "spanMoreKey":a?c.addEventListener("click",mb):c.style.display="none";break;case "spanClearKey":a?c.addEventListener("click",ib):c.style.display="none"}b=t("button",u("#divPwd"));for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",lb);break;case "btnOk":c.addEventListener("click",nb);break;case "btnDropDb":c.addEventListener("click",sb);break;case "btnUnregSw":c.addEventListener("click",
Gc)}c=u("#divModal");c.addEventListener("click",vb);c.children[0].addEventListener("click",function(f){f.stopPropagation()});b=t("button",c);for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",vb);break;case "btnOk":c.addEventListener("click",wb)}b=t(".zb-main-menu");for(d=0;d<b.length;d++)for(a=t("li",b[d]),c=0;c<a.length;c++)a[c].addEventListener("click",Nc);c=u("#chkAll");c.addEventListener("click",Xb);y(c).addEventListener("click",Xb);b=t("li",
"#ulIteMenu");for(d=0;d<b.length;d++)b[d].addEventListener("click",Yb);c=u("#divInpName");c.addEventListener("click",function(f){f.stopPropagation()});u("input",c).addEventListener("keyup",dc);u("span",c).addEventListener("click",ec);c=u("#diViewer");c.addEventListener("click",hc);c.addEventListener("touchstart",function(f){Z||1!=f.changedTouches.length||(f=f.changedTouches[0],Z={j:f.identifier,ub:f.screenX,vb:f.screenY})});c.addEventListener("touchend",function(f){if(Z){var g=null,k;for(k=0;k<f.changedTouches.length;k++)if(f.changedTouches[k].identifier==
Z.j){g=f.changedTouches[k];break}g&&(f=g.screenX-Z.ub,g=g.screenY-Z.vb,10>g&&-10<g&&(50<f?ic():-50>f&&jc()));Z=null}});u("button",c).addEventListener("click",function(){Zb(v("div").getAttribute("uid"))});u("img",c).addEventListener("load",lc);c=u("video",c);c.addEventListener("canplay",nc);c.addEventListener("ended",function(){X(v("div").getAttribute("uid"),2,!0)});document.addEventListener("fullscreenchange",function(){document.fullscreen?u("#diViewer").classList.add("full"):u("#diViewer").classList.remove("full")});
c=v("zb-viewer",c,"div.class");b=t("span",c);for(d=0;d<b.length;d++)switch(b[d].getAttribute("name")){case "close":b[d].addEventListener("click",kc);break;case "previous":b[d].addEventListener("click",ic);break;case "next":b[d].addEventListener("click",jc);break;case "fullscreen":b[d].addEventListener("click",function(){v("div","#diViewer",void 0,!0).requestFullscreen()})}c=v("zb-modal",c,"div.class");c.addEventListener("click",kc);c.children[0].addEventListener("click",function(f){f.stopPropagation()});
u(".zb-qbutton").addEventListener("click",function(){u("#divQueue").style.top=""});u("close","#divQueue","span.name").addEventListener("click",uc);u("close","#divHistory","span.name").addEventListener("click",function(){u("#divHistory").style.top="100%"});Fb()});
