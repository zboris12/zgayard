const aa={en:"English",ja:"日本語"},ba={bmp:"image/bmp",gif:"image/gif",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png"},ca={avi:"video/x-msvideo",mp4:"video/mp4",mpeg:"video/mpeg"};function da(b,c){var a="",d="";if(c){d=c.indexOf(".");0<=d&&(a=c.substring(0,d).toUpperCase(),c=c.slice(d+1));switch(c.toLowerCase()){case "id":c="#";break;case "class":c="."}d=b}else c=b.charAt(0),"#"==c||"."==c?d=b.slice(1):(c="",a=b.toUpperCase());return{ma:a,u:c,wa:d}}function ea(b,c){return"#"==c.u?b.id==c.wa:"."==c.u?b.classList.contains(c.wa):c.u?b.getAttribute(c.u)==c.wa:!0}
function h(b,c,a){var d=[],e=document;c&&("string"==typeof c?(c=h(c),0<c.length&&(e=c[0])):e=c);a=da(b,a);if(!a.ma)if("#"==a.u)d.push(document.getElementById(a.wa));else if("."==a.u)for(c=e.getElementsByClassName(a.wa),b=0;b<c.length;b++)d.push(c[b]);else a.ma="*";if(a.ma)for(e=e.getElementsByTagName(a.ma.toLowerCase()),b=0;b<e.length;b++)ea(e[b],a)&&d.push(e[b]);return d}
function q(b,c,a){var d=null;b?"string"==typeof b?(b=h(b,c,a),0<b.length&&(d=b[0])):b instanceof Event?d=b.currentTarget||b.srcElement||b.target:d=b:d=window.event.currentTarget||window.event.srcElement||window.event.target;return d}function r(b,c,a,d){var e=null;c?"string"==typeof c?e=q(c):e=c:e=q();d&&(e=e.parentElement);for(b=da(b,a);e&&(e.tagName!=b.ma&&b.ma||!ea(e,b));)e=e.parentElement;return e}function fa(b){return!!(b.offsetWidth||b.offsetHeight||b.getClientRects().length)}
function t(b){(b=q(b))&&b.style.display&&(b.style.display="")}function u(b){if(b=q(b))b.style.display="none"}function v(b,c){if((b=b.nextElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);b&&b.id!=c;)b=b.nextElementSibling;break;default:for(c=c.toUpperCase();b&&b.tagName!=c;)b=b.nextElementSibling}return b}
function ha(b,c,a){if((b=a?b.lastElementChild:b.previousElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);b&&b.id!=c;)b=b.previousElementSibling;break;default:for(c=c.toUpperCase();b&&b.tagName!=c;)b=b.previousElementSibling}return b}function w(b,c){return parseInt(b.getAttribute(c),10)}
function ia(b,c,a){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(b,c);else if(a)a.download=c,a.href=window.URL.createObjectURL(b),a.click();else throw Error("Element for download is not specified.");}function ja(b){if(!b)return null;var c=b.charAt(0);if("?"==c||"#"==c)b=b.substring(1);var a={};b.split("&").forEach(function(d){var e=d.indexOf("=");0>e?a[decodeURIComponent(d)]="":a[decodeURIComponent(d.substring(0,e))]=decodeURIComponent(d.substring(e+1))});return a}
function ka(){var b=ja(window.location.search),c=ja(window.location.hash);c&&(b=b?Object.assign(b,c):c);return b}function x(b,c){var a=[],d;for(d in b)c?a.push(d.concat("=").concat(b[d])):a.push(encodeURIComponent(d).concat("=").concat(encodeURIComponent(b[d])));return 0<a.length?"?".concat(a.join("&")):""}
function y(b,c,a,d){var e=q("svg",b),f=document.createElementNS("http://www.w3.org/2000/svg","use");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#".concat(c));e||(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),b.appendChild(e));e.appendChild(f);a&&(e.style.fill=a);d&&(e.style.stroke=d)}
function B(b){if(b)if(1024>b)var c="B";else 1048576>b?(c="KB",b=Math.round(b/102.4)/10):1073741824>b?(c="MB",b=Math.round(b/104857.6)/10):(c="GB",b=Math.round(b/1.073741824E8)/10);else c="B",b=0;var a=b.toString();b=a.indexOf(".");var d=a.split(""),e=[];0<=b?e.push(a.slice(b)):b=d.length;for(a=0;0<b;)3==a++&&(e.unshift(","),a=1),e.unshift(d[--b]);return e.join("").concat(c)}
function la(b){var c=b%60;b=(b-c)/60;var a=b%60;b=(b-a)/60;var d=[];0<b&&d.push(b.toString(10));d.push("0".concat(a).slice(-2));d.push("0".concat(c).slice(-2));return d.join(":")}function ma(b){if(!b)return 0;var c=b.indexOf("-");if(0>c)return 0;c++;var a=b.indexOf("/",c);return a<=c?0:parseInt(b.slice(c,a),10)};function C(b){var c=CryptoJS.MD5(b);b=CryptoJS.kdf.OpenSSL.execute(b,8,4,c);b.iv.clamp();b.key.clamp();return b}
function na(b,c,a){var d=a;"string"==typeof a&&(d=C(a));if(!(d&&d.iv&&d.key))throw Error("Need iv and key. They can be generated by CryptoJS.kdf.OpenSSL.execute from password and salt.");a={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};Object.assign(a,d);b=b?CryptoJS.algo.AES.createEncryptor(a.key,a):CryptoJS.algo.AES.createDecryptor(a.key,a);c=b.process(c);c.concat(b.finalize());c.clamp();return c}
function oa(b){var c=Array(b.sigBytes);b=b.words;for(var a=0,d=0;d<b.length;d++){for(var e=b[d],f=a+4-1;f>=a;f--)f<c.length&&(c[f]=e&255),e>>=8;a+=4;if(a>=c.length)break}return c}
function pa(){this.h=0;this.g=null;this.j=function(b,c){this.h=b;c&&c()};this.write=function(b,c){Array.isArray(b)?this.g=this.g?this.g.concat(b):b.concat():(this.g||(this.g=[]),this.g.push(b));c&&c()};this.cancel=function(b){b&&b(!1,!0)};this.s=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var b=0,c=0;c<this.g.length;c++)b+=this.g[c].byteLength;b=new Uint8Array(b);var a=0;for(c=0;c<this.g.length;++c){var d=this.g[c];d instanceof ArrayBuffer&&
(d=new Uint8Array(d));b.set(d,a);a+=d.byteLength}return b}return this.g};this.A=function(){var b=this.s();b instanceof Uint8Array||(b=new Uint8Array(b));return new Blob([b],{type:"application/octet-binary"})};this.download=function(b){var c=this.A();ia(c,b,null)};this.C=function(){return this.h}}
function qa(b){this.blob=null;if(b.Aa)if(b.Aa instanceof Blob)this.blob=b.Aa;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.s=1600;b.$&&(this.s=b.$);this.h=0;this.o=this.m=null;this.H=function(c,a){if(c){if(c>=this.g())throw Error("offset can not be bigger than input size.");this.h=c}this.m=new FileReader;this.m.onload=function(d){d=d.target.result;this.o&&this.o(d,this)}.bind(this);a&&a()};this.A=function(){return this.h};this.g=function(){return this.blob.size};
this.C=function(){return this.h>=this.g()};this.j=function(c){if(1!=this.m.readyState){var a=this.h;this.h=c?this.h+c:this.h+this.s;this.m.readAsArrayBuffer(this.blob.slice(a,this.h))}};this.R=function(){this.blob=this.m=null}}
function ra(b,c){if(!b.Oa)if(this.getSuperClass&&"Readable"==this.getSuperClass().name)this.super(c),this.h=1,c&&c.objectMode&&(this.M=!0);else throw Error("writer must be specified in no stream mode.");this.m=this.H=null;this.C=!0;this.g=null;this.o=b.Oa;this.iv=this.key=null;this.j=0;this.A=null;this.speed=this.B=this.s=0;b.Ja&&(this.C=!1);if(b.la)"function"==typeof b.la?this.g=b.la():this.g=b.la;else throw Error("reader must be specified.");if(b.ka)c=null,c="string"==typeof b.ka?C(b.ka):b.ka,this.key=
c.key,this.iv=c.iv;else throw Error("keycfg must be specified.");this.start=function(a){if(a){if(this.C)throw Error("Can NOT set offset for encryption.");this.j=a;a-=a%16+16;0>a&&(a=0)}this.g.o=this.I.bind(this);this.g.H(a,function(){var d=16*Math.ceil((this.g.g()+1)/16);this.h||!this.o?this.F():this.o.j(d,this.F.bind(this))}.bind(this))};this.R=function(){Date.now()>this.s&&(this.speed=1E3*(this.g.A()-this.B)/(Date.now()-this.s+1E3),this.s=Date.now()+1E3,this.B=this.g.A());return this.speed};this._read=
function(a){1==this.h?this.h=2:3==this.h&&(this.g.C()?this.push(null):this.g.j(a))};this.push=function(a){return this.readable?(a&&!this.M?this.superCall("push",new Uint8Array(a)):this.superCall("push",a),!0):!1};this.F=function(){this.s=Date.now()+1E3;(this.B=this.j)?this.g.j(16):1==this.h?this.h=3:2==this.h?(this.h=3,this.push([])):this.g.j()};this.I=function(a){try{var d=new CryptoJS.lib.WordArray.init(a);if(!this.A){var e={iv:this.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};this.j&&
(e.iv=d,d=null);this.A=this.C?CryptoJS.algo.AES.createEncryptor(this.key,e):CryptoJS.algo.AES.createDecryptor(this.key,e)}if(d){var f=oa(this.A.process(d));this.g.C()&&(f=f.concat(oa(this.A.finalize())));if(this.j<this.g.A()){var g=this.j-(this.g.A()-a.byteLength);0<g&&(f=f.slice(g))}else f=null;this.h?this.push(f):f?this.o&&this.o.write(f,function(){this.g.C()?this.Pa():this.H?this.H()?this.g.j():this.o.cancel(function(k,l){this.Pa(k,l)}.bind(this)):this.g.j()}.bind(this)):this.g.j();f=null}else this.h?
2==this.h?(this.h=3,this.push([])):this.h=3:this.g.j()}catch(k){if(this.h)throw k;this.Pa(k)}};this.Pa=function(a,d){this.g&&(this.g.R(),this.g=null);this.m&&(a?this.m(a):this.m(!1,d))}}
function sa(b){const c=zb_require("readable-stream");ra.super_!==c.Readable&&zb_inherits(ra,c.Readable);this.h={highWaterMark:8E5};Object.assign(this.h,void 0);this.info=b;this.g=null;this.createReadStream=function(a){this.Sa();this.g=new ra(this.info,this.h);var d=0;a&&a.start&&(d=a.start);this.g.start(d);return this.g};this.Sa=function(){this.g&&(this.g.destroy(),this.g=null)}}
function ta(b,c,a){b.o=function(d){c.write(d,function(){b.C()?a&&a():b.j()})};b.H(0,function(){c.j(b.g(),function(){b.j()})})};function ua(){this.m=!0;this.h=this.v=null;this.o=this.B=!1;this.j=-1;this.M=function(){return null!=this.v};this.R=function(b){if(this.m)try{var c=window.sessionStorage.getItem("language"),a=window.sessionStorage.getItem("relay_url"),d=window.sessionStorage.getItem("drive"),e=window.sessionStorage.getItem("skipLogin");window.sessionStorage.clear();c&&window.sessionStorage.setItem("language",c);a&&!b&&window.sessionStorage.setItem("relay_url",a);d&&!b&&window.sessionStorage.setItem("drive",d);e&&
!b&&window.sessionStorage.setItem("skipLogin",e)}catch(f){this.m=!1,console.error(f)}};this.s=function(b){var c=null;if(this.m)try{c=window.sessionStorage.getItem(b)}catch(a){this.m=!1,console.error(a)}return c};this.ha=function(b){var c=this.s("login_state");return c&&b==c?!0:!1};this.A=function(b,c){if(this.m)try{return window.sessionStorage.setItem(b,c.toString()),!0}catch(a){this.m=!1,console.error(a)}return!1};this.I=function(b){if(this.m)try{window.sessionStorage.removeItem(b)}catch(c){this.m=
!1,console.error(c)}};this.qa=function(){var b=this.s("language"),c=this.s("relay_url"),a=this.s("drive"),d=this.s("skipLogin");this.h={};b&&(this.h.language=b,this.U(b));c&&(this.h.ya=c,this.ga(c));a&&(this.h.K=a,this.sa(a));d&&this.za(d)};this.Fa=function(){var b=this.g("drive");b||(this.h||this.qa(),b=this.h.K);return b};this.sa=function(b){return this.V("drive",b)?(this.v[b]||(this.v[b]={}),!0):this.v?!1:!0};this.za=function(b){b?this.o=this.M():(this.o=!1,this.Ga()&&(this.B=!0));this.A("skipLogin",
this.o)};this.pa=function(b){var c=this.g("language");!c&&b&&this.h&&(c=this.h.language);return c};this.U=function(b){this.V("language",b)};this.fa=function(){var b=this.g("relay_url");!b&&this.h&&(b=this.h.ya);return b?b:""};this.ga=function(b){this.V("relay_url",b)};this.Wa=function(b){if(window.indexedDB){var c=window.indexedDB.open("zgayard1946");c.onerror=function(){if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};c.onupgradeneeded=function(a){a.target.result.createObjectStore("settings",{keyPath:"key"})};c.onsuccess=function(a){var d=a.target.result;a=d.transaction("settings","readwrite");a.oncomplete=function(){d.close();b&&b()};a.objectStore("settings").getAll().onsuccess=function(e){this.v={};e.target.result.forEach(function(f){this.v[f.key]=f.value}.bind(this));this.o=(e=this.v.drive)&&this.v[e]&&this.v[e].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(b)b("IndexedDB is not supported in your browser settings.");
else throw Error("IndexedDB is not supported in your browser settings.");};this.Ha=function(b){var c=window.indexedDB.deleteDatabase("zgayard1946");c.onerror=function(){if(b)b("Failed to dropt IndexedDB.");else throw Error("Failed to dropt IndexedDB.");};c.onsuccess=function(){this.R(!0);this.v=null;this.o=!1;b?b():console.log("IndexedDB has been dropped.")}.bind(this)};this.ra=function(){this.B&&this.v&&(this.F(function(b){b.clear().onsuccess=function(){for(var c in this.v)b.put({key:c,value:this.v[c]})}.bind(this)}.bind(this)),
this.B=!1)};this.C=function(b){var c=this.g("drive");return c&&(c=this.v[c])?c[b]:null};this.Ga=function(){var b=this.g("drive");return b&&(b=this.v[b])&&b.refresh_token?(delete b.refresh_token,!0):!1};this.H=function(b,c,a){if(this.v){var d=this.g("drive");if(c)this.v[d]||(this.v[d]={}),this.v[d][b]=c;else if(this.v[d])delete this.v[d][b];else{a&&a instanceof Function&&a();return}a?(b=void 0,a instanceof Function&&(b=a),this.F(function(e){e.put({key:d,value:this.v[d]})}.bind(this),b)):this.B=!0}else a&&
a instanceof Function&&a()};this.oa=function(b){this.R(!0);if(this.v){var c=this.g("drive");delete this.v[c].refresh_token;delete this.v.drive;this.F(function(a){a.put({key:c,value:this.v[c]});a.delete("drive")}.bind(this),b)}else b&&b()};this.Ya=function(b,c){var a=this.g("recent");a||(a=[]);0>this.j&&(a.push({drive:this.g("drive"),root:this.C("root"),played:[]}),this.j=a.length-1);var d=a[this.j];b={fid:b.G,time:b.na};0<=c&&c<d.played.length?d.played[c]=b:d.played.push(b);this.saveData("recent",
a,void 0)};this.Va=function(){var b=this.g("recent");this.j=-1;if(b){var c=0;for(c=0;c<b.length;c++){var a=b[c];if(a.drive==this.g("drive")&&a.root==this.C("root")){this.j=c;break}}}if(0<=this.j){var d=[];b[this.j].played.forEach(function(e){d.push({G:e.fid,N:"",na:e.time})});return d}return null};this.Xa=function(b){var c=this.g("recent");if(c&&!(0>this.j)){var a=c[this.j].played;b<a.length&&(a.splice(b,1),this.saveData("recent",c,void 0))}};this.F=function(b,c){window.indexedDB.open("zgayard1946").onsuccess=
function(a){var d=a.target.result;a=d.transaction("settings","readwrite");a.oncomplete=function(){d.close();c&&c()};a=a.objectStore("settings");b&&b(a)}};this.V=function(b,c){if(c){if(this.A(b,c),this.v&&this.v[b]!=c)return this.v[b]=c,this.B=!0}else if(this.I(b),this.v&&this.v[b])return delete this.v[b],this.B=!0;return!1};this.g=function(b){return this.v&&this.v[b]?this.v[b]:null};this.saveData=function(b,c,a){this.v&&(this.v[b]=c);this.F(function(d){d.put({key:b,value:c})}.bind(this),a)}};var va={};function wa(b,c,a){this.l=b;this.u=c;this.g=a}function E(b,c){this.ya=null;this.pa=c;this.h=null;this.g=b;this.super||(this.super=function(){})}function xa(b){null==b.ya&&(b.ya=b.g.fa());return b.ya}
function ya(b,c){var a="POST",d=b.B().concat(encodeURI(c.aa)),e=new XMLHttpRequest;c&&c.Ba&&(a=c.Ba);e.open(a,d,!0);c&&c.J?e.setRequestHeader("Authorization",c.J):c&&c.Ca?(a="Bearer",c&&c.Da&&(a=c.Da),e.setRequestHeader("Authorization",a+" "+c.Ca)):e.setRequestHeader("Authorization",b.h);if(c&&c.ta)for(var f in c.ta)e.setRequestHeader(f,c.ta[f]);c&&c.i&&(e.onload=function(g){g=g.target;4==g.readyState&&(401==g.status&&this.g.o&&!c.ab?za(this,c):c.i(g))}.bind(b));e.send(c.Ia)}
E.prototype.H=function(b,c){if(c&&(this.h=this.g.s("access_token"))){b();return}var a=this.g.o,d={};if((c=ka())&&c.token_type&&c.access_token){this.h=c.token_type+" "+c.access_token;this.g.A("access_token",this.h);if(c&&c.state)if(this.g.ha(c.state))this.g.I("login_state");else{b("Unauthorized access to this url.");return}b()}else if(c&&c.code?d.code=c.code:a&&(d.Qa=this.g.C("refresh_token")),d.code||d.Qa){if(c&&c.state)if(this.g.ha(c.state))this.g.I("login_state");else{b("Unauthorized access to this url.");
return}Aa(this,d,function(e){e&&e.token_type&&e.access_token?(this.h=e.token_type+" "+e.access_token,this.g.A("access_token",this.h),a&&d.code&&e.refresh_token&&this.g.H("refresh_token",e.refresh_token),e.logout&&this.g.A("logout_url",e.logout),b()):e&&e.error?b("["+e.error+"] "+e.error_description):b("Unknown error occured when doing authorization.")}.bind(this))}else a&&(d.Ua=!0),Aa(this,d,function(e){e&&e.url?(e.state&&(this.g.A("login_state",e.state)||(e.state=this.m())),e.logout&&this.g.A("logout_url",
e.logout),window.location.href=e.url.concat("&state=".concat(encodeURIComponent(e.state)))):e&&e.error?b("["+e.error+"] "+e.error_description):b("Unknown error occured when doing authorization.")}.bind(this))};
E.prototype.ha=function(){this.h=null;this.g.I("access_token");var b=this.g.s("logout_url");if(b)window.location.href=b;else{b=new FormData;b.append("drive_type",this.m());b.append("action","logout");var c=new XMLHttpRequest;c.open("POST",this.pa,!0);c.withCredentials=!0;c.onload=function(a){a=a.target;4==a.readyState&&200==a.status&&(a=JSON.parse(a.responseText))&&a.logout&&(window.location.href=a.logout)};c.send(b)}};
function Ba(b){var c=F;if(!b||!b.ba)throw Error("newname is not specified.");c.M(b)}function Ca(b){var c=F;if(!b||!b.D)throw Error("parentid is not specified.");if(!b||!b.La)throw Error("oldparentid is not specified.");c.M(b)}E.prototype.fa=function(b,c){c&&c(!1)};E.prototype.U=function(b){return new Da(b,this)};E.prototype.sa=function(){};E.prototype.A=function(b){return new Ea(b,this)};function Fa(b){return{W:b.status,S:b.responseText}}
function G(b,c,a,d,e,f,g,k){c={aa:c,Ba:a,i:function(l){var m=Fa(l),n=!1;d&&l.status!=d&&(n=!0);if(n)if(e&&e.i)e.i(m);else throw Error(JSON.stringify(m));else k(m)}.bind(b)};Ga(e,c);f&&(c.ta=f);g&&(c.Ia=g);ya(b,c)}function H(b,c,a,d){G(b,c,"GET",200,a,null,null,function(e){d(e.S)})}function Ga(b,c){b.Da&&(c.Da=b.Da);b.Ca&&(c.Ca=b.Ca);b.J&&(c.J=b.J)}
function Aa(b,c,a){if(!c)throw Error("Options are not specified when auth onedrive.");var d=new FormData;d.append("drive_type",b.m());c.clientId&&d.append("client_id",c.clientId);c.fb&&d.append("redirect_uri",c.fb);c.eb&&d.append("client_secret",c.eb);c.code?d.append("code",c.code):c.Qa?d.append("refresh_token",c.Qa):c.Ua&&d.append("need_code",c.Ua);c=new XMLHttpRequest;c.open("POST",b.pa,!0);c.withCredentials=!0;c.onload=function(e){e=e.target;if(4==e.readyState)if(200==e.status)a&&a(JSON.parse(e.responseText));
else throw Error(e.responseText+" ("+e.status+")");};c.send(d)}function za(b,c){console.log("Retry to send ajax.");c&&(c.ab=!0,b.H(function(a){a?console.error(a):(c.J=this.h,ya(this,c))}.bind(b)))}
function Ha(b){b.Ea=E;if("function"===typeof Object.create)b.prototype=Object.create(E.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});else{var c=function(){};c.prototype=E.prototype;b.prototype=new c;b.prototype.constructor=b}b.prototype.getSuperClass||(b.prototype.getSuperClass=function(){return this.constructor.Ea});b.prototype.super||(b.prototype.super=function(...a){return this.constructor.Ea.call(this,...a)});b.prototype.superCall||(b.prototype.superCall=function(a,
...d){return a?this.constructor.Ea.prototype[a].call(this,...d):this.constructor.Ea.call(this,...d)})}function Ia(b,c,a){Ha(a);va[b]=new wa(b,c,a)}var Ja=-1,Ka=-9,La=0;
function Da(b,c){this.K=c;this.m=b;this.B="";this.g=this.o=0;this.h=null;if(!this.m||!this.m.da)throw Error("fnm is not specified.");this.j=function(a,d){this.o=a;this.K.R(this.m,a,function(e,f){if(e)this.B=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,d){var e=null;if(this.h){if(this.h instanceof ArrayBuffer){var f=this.h.byteLength;0<f?(e=new Uint8Array(f+a.byteLength),e.set(new Uint8Array(this.h),0),e.set(new Uint8Array(a),f)):e=new Uint8Array(a)}else e=
0<this.h.length?new Uint8Array(this.h.concat(a)):new Uint8Array(a);this.h=null}else e=new Uint8Array(a);var g=new Blob([e],{type:"application/octet-binary"}),k="bytes "+this.g+"-";this.g+=g.size;k+=this.g-1+"/"+this.o;var l=0,m=function(){var n=new XMLHttpRequest;n.open("PUT",this.B,!0);n.setRequestHeader("Content-Range",k);n.onload=function(p){g=null;p=p.target;if(4==p.readyState){var z=this.K.ga(p);if(z==Ka)throw a=null,Error(p.responseText+" ("+p.status+")");if(z!=Ja&&z!=La&&z<this.g){var A=a instanceof
ArrayBuffer?a.byteLength:a.length;A-=this.g-z;if(0<A){A=a.slice(A);a=null;if(this.g>=this.o){this.write(A,d);return}this.h=A;this.g=z}else throw a=null,Error("Can NOT continue to upload buffer.");}d&&d(p.responseText)}}.bind(this);n.onerror=function(){1>l?(l++,setTimeout(function(){m()},500)):g=a=null};n.send(g)}.bind(this);m()};this.cancel=function(a){this.K.fa(this.B,a)};this.C=function(){return this.o}}
function Ea(b,c){this.K=c;this.F=b;this.url="";this.name=null;this.I=this.m=this.h=this.size=0;this.V=!1;this.U=16E3;b.$&&(this.U=b.$);this.B=this.s=0;this.o=null;this.H=function(a,d){if(this.V){this.m&&(this.I=this.m,this.m=0);if(a){if(a>=this.g())throw console.log("offset:"+a+",size:"+this.g()),Error("offset can not be bigger than input size.");this.h=a}else this.h=0;d&&d()}else this.K.I(this.F,function(e,f){this.V=!0;if(e){this.size=e.T;this.url=e.l;this.name=e.u;this.B="1"==e.P?1:0;if(a){if(a>=
this.g())throw Error("offset can not be bigger than input size.");this.h=a}d&&d()}else throw Error(f.S+" ("+f.W+")");}.bind(this))};this.A=function(){return this.h};this.g=function(){return this.size};this.C=function(){return this.h>=this.g()};this.j=function(a){a||(a=this.U);this.M(a)};this.R=function(){};this.M=function(a){if(!a||!this.m){if(a)this.m=a;else if(this.m)a=this.m;else throw Error("size must be specified.");if(!this.I){var d=this.h+a-1,e=function(){var f=new XMLHttpRequest;10<=this.s?
(f.open("GET",xa(this.K),!0),f.setRequestHeader("Zb-Url",this.url)):f.open("GET",this.url,!0);this.K.sa(f,this.F.J);f.setRequestHeader("Range","bytes="+this.h+"-"+d);f.responseType="arraybuffer";f.onload=function(g){if(this.I)this.I=0,this.m&&this.M();else if(this.m=0,g=g.target,4==g.readyState)if(this.s=10>this.s?1:11,200==g.status||206==g.status){2==this.B&&(this.B=1);var k=parseInt(g.getResponseHeader("content-length"),10);k?this.h+=k:this.h=(k=ma(g.getResponseHeader("content-range")))?k+1:d+1;
200==g.status&&this.h<this.g()?this.h=this.g():this.h>this.g()&&(this.h=this.g());this.o&&this.o(g.response,this);g.response=null}else if(401==g.status&&1==this.B)console.log("Retry auth."),this.B=2,this.K.H(function(l){l?console.error(l):(this.F.J&&delete this.F.J,e())}.bind(this));else throw Error(g.responseText+" ("+g.status+")");}.bind(this);f.onerror=function(){if(0==this.s&&xa(this.K))this.s=10,e();else if(1==this.s||11==this.s)this.s++,setTimeout(function(){e()},500)}.bind(this);f.send()}.bind(this);
e()}}}};Ia("onedrive","Microsoft OneDrive",function(b,c){this.super(b,c);this.m=function(){return"onedrive"};this.V=function(a){H(this,"/me/drive",a,function(d){a&&a.i&&(d=JSON.parse(d).quota,a.i(!1,{Na:d.deleted,Ma:d.total,va:d.used}))})};this.o=function(a){var d="/me/drive/root/children";if(a){if(a.Z){var e=function(f){var g={ca:"",i:function(k,l){if(a&&a.i)k?a.i(k):(k=[],l&&k.push(l),a.i(!1,k));else if(k)throw Error(JSON.stringify(k));}};Ga(a,g);this.j(g,f)}.bind(this);a.D?(d={ca:a.D,i:function(f,g){if(f)if(a&&
a.i)a.i(f);else throw Error(JSON.stringify(f));else e(g.$a.concat("/").concat(g.u).concat("/").concat(a.Z))}},Ga(a,d),this.j(d)):e("/drive/root:/".concat(a.Z));return}a.D&&(d="/me/drive/items/"+a.D+"/children")}H(this,d.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),a,function(f){if(a&&a.i){var g=[];f&&JSON.parse(f).value.forEach(function(k){g.push(this.ea(k))},this);a.i(!1,g)}}.bind(this))};this.s=function(a){this.j(a)};this.C=function(a){if(!a||!a.N)throw Error("Name of new folder is not specified.");
var d="/me/drive/root/children";a.D&&(d="/me/drive/items/"+a.D+"/children");var e=JSON.stringify({name:a.N,folder:{},"@microsoft.graph.conflictBehavior":"fail"});G(this,d,"POST",201,a,{"Content-Type":"application/json;charset=UTF-8"},e,function(f){a&&a.i&&(f=this.ea(JSON.parse(f.S)),a.i(!1,f))}.bind(this))};this.delete=function(a){var d="/me/drive/items/".concat(a.G);G(this,d,"DELETE",204,a,null,null,function(){a&&a.i&&a.i(!1)})};this.R=function(a,d,e){d={aa:"/me",Ba:"POST",J:a.J,ta:{"Content-Type":"application/json;charset=UTF-8",
"Cache-Control":"no-cache",Pragma:"no-cache"},i:function(f){f=Fa(f);var g="";200<=f.W&&299>=f.W&&(g=JSON.parse(f.S).uploadUrl);e(g,f)}.bind(this)};d.aa=a.Y?"/me/drive/items/"+a.Y+":/":d.aa+"/drive/root:/";d.aa+=a.da;d.aa+=":/createUploadSession";d.Ia=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:a.da}});ya(this,d)};this.ga=function(a){if(0<=[200,201].indexOf(a.status))return Ja;if(0>[202].indexOf(a.status))return Ka;if((a=JSON.parse(a.responseText).nextExpectedRanges)&&
a.length){var d=a[0].indexOf("-");if(0<d)return parseInt(a[0].substring(0,d),10)}return La};this.fa=function(a,d){var e=new XMLHttpRequest;e.open("DELETE",a,!0);e.onload=function(f){f=f.target;if(4==f.readyState){var g={W:f.status,S:f.responseText};200<=f.status&&299>=f.status?d&&d(!1,g):(console.log(f.responseText+" ("+f.status+")"),d&&d(g))}}.bind(this);e.send()};this.I=function(a,d){var e="/me/drive/items/".concat(a.l),f={i:function(g,k){var l=null;k&&!g&&(k=JSON.parse(k),l={l:k["@microsoft.graph.downloadUrl"],
u:k.name,T:k.size});d(l,g)}};a.J&&(f.J=a.J);H(this,e.concat(x({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f,function(g){f.i(!1,g)})};this.B=function(){return"https://graph.microsoft.com/v1.0"};this.M=function(a){if(!a||!a.G)throw Error("fid is not specified.");var d="/me/drive/items/".concat(a.G),e={};a.ba&&(e.name=a.ba);a.D&&(e.parentReference={id:a.D});e=JSON.stringify(e);if("{}"==e)throw Error("No property to be updated.");G(this,d,"PATCH",200,a,{"Content-Type":"application/json;charset=UTF-8"},
e,function(){a&&a.i&&a.i(!1)})};this.j=function(a,d){var e="";e=d?d.startsWith("/me")?d:"/me".concat(d):"/me/drive/items/"+a.ca;G(this,e.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,a,null,null,function(f){if(a&&a.i)200==f.W?(f=this.ea(JSON.parse(f.S)),a.i(!1,f)):404==f.W&&d?a.i(!1):a.i(f);else if(200!=f.W)throw Error(JSON.stringify(f));}.bind(this))};this.ea=function(a){var d={l:a.id,u:a.name,T:a.size,ua:a.lastModifiedDateTime,$a:a.parentReference.path,
L:a.parentReference.id,P:"0"};a.folder?d.P="1":a.file&&(d.P="2");return d}});Ia("googledrive","Google Drive",function(b,c){this.super(b,c);this.m=function(){return"googledrive"};this.V=function(a){var d=this.j("/about").concat(x({fields:"storageQuota"}));H(this,d,a,function(e){a&&a.i&&(e=JSON.parse(e).storageQuota,a.i(!1,{Na:e.usageInDriveTrash,Ma:e.limit,va:e.usage}))})};this.o=function(a){var d=this.j("/files"),e="'"+(a.D?a.D:"root")+"' in parents";a.Z&&(e=e.concat(" and name = '"+a.Z+"'"));H(this,d.concat(x({fields:"files(id,name,mimeType,parents,modifiedTime,size)",q:e},
!0)),a,function(f){if(a&&a.i){var g=[];JSON.parse(f).files.forEach(function(k){g.push(this.ea(k))},this);a.i(!1,g)}}.bind(this))};this.s=function(a){var d=this.j("/files/").concat(a.ca);H(this,d.concat(x({fields:"id,name,mimeType,parents,modifiedTime,size"},!0)),a,function(e){a&&a.i&&(e=this.ea(JSON.parse(e)),a.i(!1,e))}.bind(this))};this.C=function(a){if(!a||!a.N)throw Error("Name of new folder is not specified.");var d=this.j("/files");G(this,d,"POST",200,a,{"Content-Type":"application/json;charset=UTF-8"},
JSON.stringify({mimeType:"application/vnd.google-apps.folder",name:a.N,parents:[a.D?a.D:"root"]}),function(e){a&&a.i&&(e=this.ea(JSON.parse(e.S)),a.i(!1,e))}.bind(this))};this.delete=function(a){var d=this.j("/files/").concat(a.G);G(this,d,"DELETE",204,a,null,null,function(){a&&a.i&&a.i(!1)})};this.R=function(a,d,e){var f=function(k){var l={},m="POST",n="/files?uploadType=resumable";k?(m="PATCH",n="/files/"+k+"?uploadType=resumable"):(l.name=a.da,a.Y&&(l.parents=[a.Y]));k={aa:"/upload".concat(this.j(n)),
Ba:m,J:a.J,ta:{"X-Upload-Content-Length":d,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"},Ia:JSON.stringify(l),i:function(p){var z=Fa(p),A="";200<=z.W&&299>=z.W&&(A=p.getResponseHeader("location"));e(A,z)}.bind(this)};ya(this,k)}.bind(this),g={i:function(k,l){k?e("",k):0<l.length?f(l[0].l):f()},Z:a.da,J:a.J};a.Y&&(g.D=a.Y);this.o(g)};this.ga=function(a){if(0<=[200,201].indexOf(a.status))return Ja;if(0>[308].indexOf(a.status))return Ka;if(a=a.getResponseHeader("range")){var d=
a.indexOf("-");if(0<d)return parseInt(a.slice(d+1),10)+1}return La};this.I=function(a,d){var e=this.j("/files/").concat(a.l),f={ca:a.l,i:function(g,k){var l=null;k&&!g&&(l=k,l.l=this.B().concat(encodeURI(e)).concat(x({alt:"media"})),this.g.o&&(l.P="1"));d(l,g)}.bind(this)};a.J&&(f.J=a.J);this.s(f)};this.sa=function(a,d){d?a.setRequestHeader("Authorization",d):a.setRequestHeader("Authorization",this.h?this.h:"")};this.B=function(){return"https://www.googleapis.com"};this.M=function(a){var d=!0,e=this.j("/files/").concat(a.G);
a.La&&a.D&&(e=e.concat(x({addParents:a.D,removeParents:a.La})),d=!1);var f={};a.ba&&(f.name=a.ba,d=!1);if(d)throw Error("No property to be updated.");G(this,e,"PATCH",200,a,{"Content-Type":"application/json;charset=UTF-8"},JSON.stringify(f),function(){a&&a.i&&a.i(!1)})};this.j=function(a){return"/drive/v3".concat(a)};this.ea=function(a){var d={l:a.id,u:a.name,T:a.size,ua:a.modifiedTime,P:"2"};a.parents&&0<a.parents.length&&(d.L=a.parents[0]);this.F(a.mimeType)&&(d.P="1");return d};this.F=function(a){return"application/vnd.google-apps.folder"==
a}});function Ma(b,c){this.K=c;this.M=b;this.h=null;this.m=this.size=0;this.s=null;this.F=this.B=0;this.I=1600;b.$&&(this.I=b.$);this.o=null;this.H=function(a,d){this.K.I(this.M,function(e,f){if(e)this.size=e.T,this.K.Ga(this.M.l,function(g){this.h=g;this.h.sort(function(k,l){return k.ia-l.ia});this.V(a);d&&d()}.bind(this));else throw Error(f.S+" ("+f.W+")");}.bind(this))};this.A=function(){return this.m};this.g=function(){return this.size};this.C=function(){return this.h?this.B>=this.h.length:!0};this.j=
function(a){this.s?this.U(a):this.K.Fa(this.h[this.B].l,function(d){d=CryptoJS.enc.Base64url.parse(d);this.s=oa(d);this.U(a)}.bind(this))};this.R=function(){this.s=this.h=null};this.V=function(a){if(a){if(a>=this.g())throw Error("offset can not be bigger than input size.");this.m=a;var d=0;for(a=0;a<this.h.length&&!(d+=this.h[a].T,this.m<d);a++)this.F=d;if(a<this.h.length)this.B=a;else throw Error("offset can not be bigger than input size.");}else this.B=this.F=this.m=0;this.s=null};this.U=function(a){var d=
this.m-this.F,e=this.s.length-d;a?a<e&&(e=a):this.I<e&&(e=this.I);a=new Uint8Array(this.s.slice(d,d+e));this.m+=e;this.s.length==d+e&&(this.s=null,this.B++,this.F=this.m);this.o&&this.o(a.buffer,this)}}
function Na(b,c){this.K=c;this.g=b;this.data={l:"",u:"",T:0,L:"",P:"2"};this.o=this.h=0;this.j=function(a,d){this.h=a;this.data.u=this.g.da;this.g.Y&&(this.data.L=this.g.Y);this.K.R(this.g,a,function(e,f){if(e)this.data.l=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(a,d){var e=null;e=Array.isArray(a)?new CryptoJS.lib.WordArray.init(new Uint8Array(a)):new CryptoJS.lib.WordArray.init(a);this.data.T+=e.sigBytes;a=e.toString(CryptoJS.enc.Base64url);
this.o++;this.K.saveData(this.data.l,this.o,e.sigBytes,a,function(){this.data.T>=this.h?this.K.ra(this.data,d):d&&d()}.bind(this))};this.cancel=function(a){this.K.delete({G:this.data.l,i:function(d){a&&a(d)}})};this.C=function(){return this.h}}
Ia("idxdb","Loacal Indexed DB",function(b,c){this.super(b,c);this.m=function(){return"idxdb"};this.H=function(a){this.za(a)};this.ha=function(){location.reload()};this.V=function(a){var d={Na:0,Ma:0,va:0};this.j(function(e){e.getAll().onsuccess=function(f){f.target.result.forEach(function(g){"2"==g.type&&(d.va+=parseInt(g.size,10))})}},function(){a&&a.i&&a.i(!1,d)})};this.o=function(a){a&&a.i&&this.oa(a.i,void 0,a.D,a.Z)};this.s=function(a){a&&a.i&&this.oa(function(d,e){e&&0<e.length?a.i(d,e[0]):
a.i(d)},a.ca)};this.C=function(a){if(!a||!a.N)throw Error("Name of new folder is not specified.");var d={l:"",u:a.N,T:0,L:"",P:"1"};a.D&&(d.L=a.D);this.qa(d.L,function(e){d.l=e;this.ra(d,function(){a.i&&a.i(!1,d)})}.bind(this))};this.delete=function(a){function d(l){var m=[];g.forEach(function(n){n.Ka&&"2"==n.P&&m.push(n.l)});0>m.indexOf(a.G)&&m.push(a.G);l.getAllKeys().onsuccess=function(n){n.target.result.forEach(function(p){var z=p.indexOf(":");0<=m.indexOf(p.substring(0,z))&&(l.delete(p),k+=parseInt(p.substring(p.indexOf("_",
z+1)+1),10))})}}function e(l){g.forEach(function(m){m.Ka&&l.delete(m.l)})}function f(l){var m;for(m=0;m<g.length;m++)g[m].l==l?g[m].Ka=!0:g[m].L==l&&("1"==g[m].P?f(g[m].l):g[m].Ka=!0)}var g=[],k=0;this.j(function(l){l.getAll().onsuccess=function(m){m.target.result.forEach(function(n){g.push({l:n.key,u:"",L:n.pid})})}},function(){f(a.G);this.j(e,function(){this.F(d,function(){a&&a.i&&a.i(!1,k)})}.bind(this))}.bind(this))};this.U=function(a){return new Na(a,this)};this.R=function(a,d,e){e&&(d="",a.Y&&
(d=a.Y),this.qa(d,function(f){e(f,{W:200,S:"nothing"})}))};this.ga=function(){return La};this.fa=function(){};this.A=function(a){return new Ma(a,this)};this.I=function(a,d){this.s({ca:a.l,i:function(e,f){d(f,e)}})};this.B=function(){return""};this.M=function(a){if(!a||!a.G)throw Error("fid is not specified.");this.j(function(d){d.get(a.G).onsuccess=function(e){if(e=e.target.result){var f=!1;a.ba&&e.name!=a.ba&&(e.name=a.ba,f=!0);a.D&&e.pid!=a.D&&(e.pid=a.D,f=!0);f&&d.put(e)}}},function(){a&&a.i&&
a.i(!1)})};this.ra=function(a,d){a.ua=this.Ha();var e={key:a.l,name:a.u,size:a.T,tms:a.ua,type:a.P};a.L&&(e.pid=a.L);this.j(function(f){f.put(e)},d)};this.saveData=function(a,d,e,f,g){this.F(function(k){k.put({key:a+":"+d+"_"+e,data:f})},g)};this.Ga=function(a,d){var e=[];this.F(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,l)==a){var m=k.substring(l+1);l=m.indexOf("_");e.push({l:k,ia:parseInt(m.substring(0,l),10),T:parseInt(m.substring(l+
1),10)})}})}},function(){d&&d(e)})};this.Fa=function(a,d){if(d){var e="";this.F(function(f){f.get(a).onsuccess=function(g){e=g.target.result.data}},function(){d(e)})}};this.za=function(a){if(window.indexedDB){var d=window.indexedDB.open("zgalocaldb");d.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");}.bind(this);d.onupgradeneeded=function(e){e=e.target.result;e.createObjectStore("items",{keyPath:"key"});
e.createObjectStore("datas",{keyPath:"key"})}.bind(this);d.onsuccess=function(e){e.target.result.close();a&&a()}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};this.j=function(a,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("items","readwrite");e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("items");a&&a(e)}.bind(this)};
this.F=function(a,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("datas","readwrite");e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("datas");a&&a(e)}.bind(this)};this.oa=function(a,d,e,f){if(a){var g=[];this.j(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var n=!0;d&&(n=d==m.key);n&&e&&(n=e==m.pid);n&&f&&(n=f==m.name);n&&g.push({l:m.key,u:m.name,T:m.size,ua:m.tms,P:m.type,L:m.pid})})}},function(){a(!1,
g)})}};this.Ha=function(){var a;a||(a=new Date);var d=[],e=[];d.push(a.getFullYear());d.push(a.getMonth()+1);d.push(a.getDate());e.push("0".concat(a.getHours()).slice(-2));e.push("0".concat(a.getMinutes()).slice(-2));e.push("0".concat(a.getSeconds()).slice(-2));return d.join("-")+" "+e.join(":")};this.qa=function(a,d){var e=-1;this.j(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf("_");a&&0<l?k.substring(l+1)==a&&(l=parseInt(k.substring(0,l),10),
l>e&&(e=l)):!a&&0>l&&(l=parseInt(k,10),l>e&&(e=l))})}},function(){e++;a?d(e+"_"+a):d(e.toString())})}});function Oa(b,c){var a=I;this.h=this.g=null;this.B=a;this.j=1;this.C=b;this.m=c;this.o=0;this.s=function(){this.m({type:0,wtype:this.j,size:this.g.g()});var d=new ra({Ja:1==this.j,ka:this.B,la:this.g,Oa:this.h});d.H=function(){var e={type:1,wtype:this.j,begin:this.o,spd:d.R(),posn:this.g.A(),size:this.g.g()};this.m(e);return this.C()?!1:!0}.bind(this);d.m=function(e,f){var g={type:2,wtype:this.j,begin:this.o,posn:this.g.A(),size:this.h.C()};e?g.errr=e.message||e.gb:f?g.type=3:this.h.A&&(g.blob=this.h.A());
this.m(g)}.bind(this);this.o=Date.now();d.start()};this.A=function(d){var e=F;this.j=1;this.g=e.A({l:d,$:16E5});this.h=new pa;this.s()};this.H=function(d,e,f){var g=F;this.j=2;this.g=new qa({Aa:e,$:16E5});this.h=g.U({da:d,Y:f});this.s()}};var J=null,F=null,K=[],L=0,I=null,M=[],N=0,O=[];function P(b,c){N&&(window.clearTimeout(N),N=0);var a=q("#divMessage");if(0==b)a.style.display||(a.style.opacity="0",N=window.setTimeout(function(){N=0;u(a)},150));else{var d=h("span",a);1==b?(a.className="zb-notice",d[0].innerText="Notice"):(a.className="zb-alert",d[0].innerText="Error");d[1].innerText=c?c:"";a.style.opacity&&(t(a),N=window.setTimeout(function(){N=0;a.style.opacity=""},50))}}
function Q(b){var c="";"string"===typeof b?window.msgs&&b&&window.msgs[b]?c=window.msgs[b]:c=b:b&&(c=JSON.stringify(b));P(2,c)}function R(b){var c=b;window.msgs&&b&&window.msgs[b]&&(c=window.msgs[b]);P(1,c)}function Pa(b){R(b);N=setTimeout(function(){N=0;P(0)},3E3)}
function Qa(b,c){function a(e){Ra--;"error"==e.type&&(Qa.Ta=!0);if(0==Ra){var f=Qa.Ta;delete Qa.Ta;c&&c(f)}e=e.target||e.srcElement;e.hasAttribute("temporary")&&e.remove()}Ra++;var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",b);d.setAttribute("temporary","1");d.addEventListener("load",a);d.addEventListener("error",a);document.body.appendChild(d)}var Ra=0;
function Sa(b){J.M()&&(q("#chkSaveKey").checked?Ta(function(c){var a="";c&&c.lsauth&&(a=na(!0,b,c.lsauth).toString(CryptoJS.enc.Base64url));J.H("key_words",a,!0)}):J.H("key_words",null,!0))}function Ua(){J.oa(function(){F.ha()})}
function Ta(b){var c=new FormData;c.append("drive_type","localstorage");var a=new XMLHttpRequest;a.open("POST","https://zgayard.f5.si/grantauth.php",!0);a.withCredentials=!0;a.onload=function(d){var e=d.target;4==e.readyState&&(d=null,200==e.status?(e=JSON.parse(e.responseText))?e.error?Q("["+e.error+"] "+e.error_description):e.lsauth?d=e:Q("lsFailed"):Q("lsFailed"):Q(e.responseText+" ("+e.status+")"),b&&b(d))};a.send(c)}
function Va(b){var c=q("#divSet"),a=q("#selDrive"),d=q("btnLogout",c,"button.iid");b?(a.disabled=!0,t(d),u(".zb-nav-tools"),u("#divMain")):(a.disabled=!1,u(d));t(c)}
function Wa(b){if(!window.msgs||window.msgs.lang!=b){var c=window.msgs;window.msgs=null;Qa("msg/"+b+".js",function(){window.msgs?(window.msgs.lang=b,J.U(b),Xa()):(console.log("Message file of '"+b+"' is missing."),c?window.msgs=c:Qa("msg/en.js",function(){window.msgs?(window.msgs.lang="en",J.U(window.msgs.lang),Xa()):Q("Message file is missing.")}))})}}
function Xa(){var b=window.msgs;b.lblConfNotice=b.lblConfNotice.replace("{0}","_zgayard_.conf");var c=h("*"),a;for(a=0;a<c.length;a++){var d=c[a],e=null;d.hasAttribute("iid")&&(e=b[d.getAttribute("iid")])&&(d.innerText=e);!e&&d.hasAttribute("vid")&&(e=b[d.getAttribute("vid")])&&(d.value=e);!e&&d.id&&(e=b[d.id]);e&&("button"==d.type?d.value=e:d.innerText=e);d.hasAttribute("tid")&&(e=b[d.getAttribute("tid")])&&(d.title=e)}c=q("#seLang");a="";for(a in aa)d=document.createElement("option"),d.value=a,
d.innerText=aa[a],a==b.lang&&(d.selected=!0),c.appendChild(d)}function Ya(b){R("loading");var c=va[b];c?(F=new c.g(J,"https://zgayard.f5.si/grantauth.php"),F.H(function(a){if(a)J.oa(function(){Q(window.msgs.loginFailed.replace("{0}",a))});else{J.ra();var d=q("img",r("div",q("#spanQuota")));d.src="img/"+b+".png";d.alt=c.u;F.o({i:function(e,f){e?Q(JSON.stringify(e)):0==f.length?S(!0):Za(f[0].l)},Z:"_zgayard_.conf"})}},!0)):Q("unkDrive")}
function $a(){if(q("#chkAgreeTos").checked){var b=q("#selDrive"),c=!1;b.disabled||(c=J.sa(b.value));J.za(q("#chkSkipLogin").checked);J.ga(q("#txtRelay").value);Wa(q("#seLang").value);c?(J.R(),Ya(b.value)):J.ra();ab()}else Q("noAgreeTos")}function ab(){var b=q("#selDrive");u("#divSet");b.disabled&&(t(".zb-nav-tools"),t("#divMain"))}
function bb(b,c){var a=q("#divPwd"),d=!1;b?(a.setAttribute("addroot","1"),d=!0):a.removeAttribute("addroot");b=h("*",a);for(a=0;a<b.length;a++){var e=b[a];e.classList.contains("addroot")?d?t(e):u(e):e.classList.contains("firstep")?d&&c?t(e):u(e):e.classList.contains("chgroot")&&(d?u(e):t(e));"password"==e.type&&(e.value="")}cb()}
function db(){if(window.confirm(window.msgs.delConfirm)){R("deleting");var b=q("#selRoot"),c=b.value,a=-1;K.forEach(function(f,g){f.root==c&&(a=g)});var d=function(){if(a==L)window.location.reload();else{var f=h("option",b),g;for(g=0;g<f.length;g++){var k=f[g];if(k.value==c){b.removeChild(k);break}}Pa("delrootDone")}};if(0<=a){var e=function(f){F.delete({i:function(g){g?Q(g.S):(K.splice(a,1),eb(d))},G:f})};F.o({i:function(f,g){f?console.error(f):0==g.length?(K.splice(a,1),eb(d)):e(g[0].l)},Z:K[a].root})}else d()}}
function S(b){b?"boolean"===typeof b?bb(!0,!0):(bb(),u(".zb-nav-tools"),u("#divMain")):bb();t("#divPwd");P(0)}function fb(b){u("#divPwd");b&&0<M.length&&(t(".zb-nav-tools"),t("#divMain"))}function gb(){var b=v(r("div")),c=b.children[0].cloneNode(!0);c.value="";b.appendChild(c)}function cb(){var b=q("#divfKey");b=h("file",b,"input.type");var c;for(c=b.length-1;0<c;c--)b[c].remove();b[0].value=""}
function hb(){R("loading");var b=q("#divPwd").hasAttribute("addroot"),c=q("#pwdKey").value,a=h("input",q("#divfKey")),d=[],e=0,f=0;for(e=0;e<a.length;e++){var g=a[e].files;for(f=0;f<g.length;f++)d.push(g[f])}if(c||0<d.length){if(b){a=q("#pwdKeyRe").value;if((c||a)&&c!=a){Q("diffPwd");return}if(!q("#txtRoot").value){Q("noRoot");return}}var k=null;c&&(k=CryptoJS.enc.Utf8.parse(c));if(0<d.length){var l=new FileReader,m=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA512,"zb12");e=0;l.g=function(){l.readAsArrayBuffer(d[e].slice(0,
1023));e++};l.onload=function(n){m.update(new CryptoJS.lib.WordArray.init(n.target.result));e<d.length?l.g():(k?k.concat(m.finalize()):k=m.finalize(),k.clamp(),ib(k,b))};l.g()}else ib(k,b)}else Q("noPwd")}
function ib(b,c){var a=CryptoJS.HmacMD5(b,"zgayard").toString(CryptoJS.enc.Base64url).slice(0,8),d=null;if(c){var e={root:q("#txtRoot").value};q("#chkEncryFname").checked&&(e.encfname=!0);var f=!1;K.forEach(function(l){l.root==e.root&&(f=!0)});f?Q("dupRoot"):(J.H("root",e.root),Sa(b),d=CryptoJS.lib.WordArray.random(1024),I=C(d),e.iv=a.concat(jb(!0,d,b)),L=K.length,K.push(e),kb(e,!0),eb())}else{var g=q("#selRoot").value,k=-1;K.forEach(function(l,m){l.root==g&&(k=m)});0<=k&&K[k].iv&&a==K[k].iv.slice(0,
a.length)?(L=k,J.H("root",g),Sa(b),d=jb(!1,K[L].iv.slice(a.length),b),I=C(d),lb()):fa(q("#divPwd"))?Q("pwdError"):S()}}function jb(b,c,a){a=C(a);var d=null;b?d=c:d=CryptoJS.enc.Base64url.parse(c);c=na(b,d,a);return b?c.toString(CryptoJS.enc.Base64url):c}function eb(b){var c=CryptoJS.enc.Utf8.parse(JSON.stringify(K));c=new Blob([new Uint8Array(oa(c))],{type:"application/octet-binary"});c=new qa({Aa:c,$:262144});var a=F.U({da:"_zgayard_.conf"});ta(c,a,b||lb)}
function Za(b){var c=new pa;ta(F.A({l:b}),c,function(){var a=new CryptoJS.lib.WordArray.init(c.s());a=JSON.parse(a.toString(CryptoJS.enc.Utf8));Array.isArray(a)?K=a:K.push(a);var d=-1,e=J.C("root"),f=q("#selRoot");f.innerHTML="";K.forEach(function(k,l){var m=!1;e&&k.root==e&&(m=!0);kb(k,m,f);m&&(d=l)});if(0<=d){L=d;var g=J.C("key_words");g?Ta(function(k){k&&k.lsauth&&!k.newkey?(k=na(!1,CryptoJS.enc.Base64url.parse(g),k.lsauth),ib(k)):S()}):S()}else L=0,S()})}
function kb(b,c,a){a=a||q("#selRoot");var d=document.createElement("option");d.value=b.root;d.innerText=b.root;c&&(d.selected=!0);a.appendChild(d)}function mb(){window.confirm(window.msgs.dropConfirm)&&J.Ha(function(b){b?Q(b):F.ha()})};var nb=3;function ob(b,c){switch(b){case "new":var a="spanNew";break;case "upload":a="spanUpload";break;case "selfldr":a="spanSelFldr";break;default:return}var d=q("#divModal"),e=q("#spanModal");e.innerText=window.msgs[a];a=h("div",v(e));var f;for(f=0;f<a.length;f++)e=a[f],e.hasAttribute("type")&&(e.getAttribute("type")==b?t(e):u(e));c&&(d.h=c);t(d)}function pb(b){if(b=r("zb-modal",q(b),"div.class"))b.h&&(b.h(),delete b.h),u(b)}
function qb(b){function c(g){g&&pb(b)}var a="",d=h("div",v(q("#spanModal"))),e=0;for(e=0;e<d.length;e++){var f=d[e];if(f.hasAttribute("type")&&fa(f)){a=f.getAttribute("type");break}}switch(a){case "new":sb(c);break;case "upload":a=[];d=q("#upfiles").files;for(e=0;e<d.length;e++)a.push(d[e]);d=q("#upfolder").files;for(e=0;e<d.length;e++)a.push(d[e]);0>=a.length?Q("noFiles"):(c(!0),tb(a));break;case "selfldr":ub(c)}}function vb(b){return q(".zb-main-header",b).children[0]}
function wb(b){return q("zb-main-list",b,"ul.class")}function xb(b){return q("fnm",b,"span.name")}function yb(b){if(K[L].encfname){var c=I;b=CryptoJS.enc.Utf8.parse(b);c=na(!0,b,c).toString(CryptoJS.enc.Base64url)}else c=b;return c}function zb(b){if(K[L].encfname)try{var c=I,a=CryptoJS.enc.Base64url.parse(b);return na(!1,a,c).toString(CryptoJS.enc.Utf8)}catch(d){console.error(d)}return b}
function Ab(){J=new ua;J.Wa(function(b){b&&Q("IndexedDB is not supported in your browser settings.");b=J.pa();b||(J.qa(),b=J.pa(!0));if(!b){b=navigator.language;var c=b.indexOf("-");0<c&&(b=b.substring(0,c))}Wa(b);q("#txtRelay").value=J.fa();b=J.Fa();c=q("#selDrive");var a=ka(),d;for(d in va){var e=document.createElement("option");e.value=d;e.innerText=va[d].u;b?b==d&&(e.selected=!0):a&&a.state==va[d].l&&(b=d,e.selected=!0);c.appendChild(e)}J.M()?(J.o&&(q("#chkSkipLogin").checked=!0),J.C("key_words")&&
(q("#chkSaveKey").checked=!0)):(u("#divSkipLogin"),u("#divSaveKey"));b?Ya(b):Va()})}function lb(){[vb("#divMain"),q("ul","#divHistory")].forEach(function(b){var c=h("li",b);for(b=0;b<c.length;b++)c[b].classList.contains("template")||c[b].remove()});Bb(!1);fb();t(".zb-nav-tools");t("#divMain");Cb(function(){var b=K[L].root;F.o({Z:b,i:function(c,a){c?Q(JSON.stringify(c)):a&&0<a.length?(M=[],M.push(a[0]),T(),Db()):F.C({N:b,i:function(d,e){d?Q(JSON.stringify(d)):(M=[],M.push(e),T())}})}})})}
function Eb(b,c){var a=q("#spanQuota");"string"==typeof b&&(b=parseInt(b,10));var d=w(a,"total"),e=w(a,"trash"),f=0;a.hasAttribute("used")&&(f=w(a,"used"));if(c){if(f-=b,a.setAttribute("used",f),0<d){a.setAttribute("trash",e+b);return}}else f+=b,a.setAttribute("used",f);a.innerText=0<d?window.msgs.quotaInfo.replace("{0}",B(d-f-e)):window.msgs.quotaInfoU.replace("{0}",B(f))}
function Cb(b){F.V({i:function(c,a){c?Q(c):(c=q("#spanQuota"),c.setAttribute("total",a.Ma),c.setAttribute("trash",a.Na),Eb(a.va),b&&b())}})}function Bb(b){function c(d,e){d=q(d,a,"div.class");e=q("menuHistory",d,e.concat(".iid"));e=r("li",e);b?t(e):u(e)}var a=q("nav");c("zb-nav-tools","span");c("zb-nav-menu","label")}
function Db(){if(O=J.Va()){var b=q("ul","#divHistory"),c=function(a){if(a>=O.length)0<O.length&&Bb(!0);else{var d=O[a];F.s({ca:d.G,i:function(e,f){e||(f.L&&(d.N=f.L),Fb(a,zb(f.u),b),c(a+1))}})}};c(0)}}
function Fb(b,c,a){a||(a=q("ul","#divHistory"));b=O[b];var d=null,e=q(b.N,a,"li.parentId");if(null==e){e=q("template",a,"li.class").cloneNode(!0);e.classList.remove("template");var f=h("span",e),g;for(g=0;g<f.length;g++){var k=f[g];switch(k.getAttribute("name")){case "delete":k.addEventListener("click",Gb);break;case "file":k.addEventListener("click",Hb);d=k;break;case "next":k.addEventListener("click",Ib)}}e.setAttribute("parentId",b.N);a.appendChild(e)}else d=q("file",e,"span.name");d.innerText=
c;b.na&&(c=d,a=d.innerText.concat(" ["),d=a.concat,b=Math.floor(b.na),e=Math.floor(b/3600),b-=3600*e,f=Math.floor(b/60),b-=60*f,g=[],0<e?(g.push(e.toString()),g.push("0".concat(f).slice(-2))):g.push(f.toString()),g.push("0".concat(b).slice(-2)),c.innerText=d.call(a,g.join(":")).concat("]"))}
function T(b,c,a,d){var e=0;if(!a){if(0>=M.length)return;e=M.length-1;a=M[e]}var f="#divMain";c&&(f="#divModal");var g=0;g=q(f);f=vb(g);var k=wb(g);R("loading");var l=U(k);for(g=0;g<l.length;g++)k.removeChild(l[g]);(g=ha(f,void 0,!0))&&g.classList.contains("template")&&(g=null);b?g&&g.classList.remove("normal"):(g&&(0!=e||c)&&g.classList.add("normal"),Jb(f,a,e));F.o({i:function(m,n){if(m)Q(m);else{var p=[],z=0;n.forEach(function(D){var W=0,rb=p.length;D.u=zb(D.u);for(V(D)?rb=z++:W=z;W<rb&&!(D.u<p[W].u);)W++;
W<p.length?p.splice(W,0,D):p.push(D)});p.forEach(function(D){c&&!V(D)||Kb(k,D)});if(!c){m=q("#chkAll");var A=r("li",m);q("checkbox",A,"input.type").checked=!1;u(q("chkbox",A,"span.name"));0<n.length?t(m):u(m)}d?d(p):P(0)}},D:a.l})}
function Jb(b,c,a,d){var e=q("template",b,"li.class").cloneNode(!0);q("span",e).innerText=c.u;e.setAttribute("name","folder");e.setAttribute("uid",c.l);e.setAttribute("idx",a);e.addEventListener("click",Lb);e.classList.remove("template");d&&e.classList.add("normal");t(e);b.appendChild(e)}
function Kb(b,c){var a=c.u,d="",e="",f=q("template",b,"li.class").cloneNode(!0);f.classList.remove("template");f.setAttribute("uid",c.l);f.setAttribute("utype",c.P);var g=h("span",f),k;for(k=0;k<g.length;k++){var l=g[k];switch(l.getAttribute("name")){case "fnm":l.innerText=a;l.addEventListener("click",X);break;case "icon":if(V(c))y(l,"folder","#FFD679");else{var m=Mb(a);ba[m]?y(l,"image","#E7FFE7"):ca[m]?y(l,"video","#FFE7F3"):y(l,"file","#FFFFB0")}l.addEventListener("click",Nb);break;case "chkbox":l.addEventListener("click",
Nb);u(l);break;case "edit":l.addEventListener("click",Ob);break;case "size":d||(d=B(c.T));l.innerText=d;break;case "tms":if(!e)if(e=c.ua){e=new Date(e);m=[];var n=[];m.push(e.getFullYear());m.push(e.getMonth()+1);m.push(e.getDate());n.push("0".concat(e.getHours()).slice(-2));n.push("0".concat(e.getMinutes()).slice(-2));n.push("0".concat(e.getSeconds()).slice(-2));e=m.join("-")+" "+n.join(":")}else e="";l.innerText=e}}t(f);b.appendChild(f)}
function Pb(b,c){var a=q("checkbox",b,"input.type");1==c?a.checked=!0:-1==c?a.checked=!1:(a.checked=!a.checked,c=a.checked?1:-1);0<c?t(q("chkbox",b,"span.name")):u(q("chkbox",b,"span.name"))}function Nb(){Pb(r("li"))}function X(b,c,a){var d=null,e=!1;"string"!=typeof b&&(d=r("li"),b=d.getAttribute("uid"),e="selfldr"==r("div",d).getAttribute("type"));if(c||!d)d=Qb(b,c,a),b=d.getAttribute("uid");c={l:b,u:xb(d).innerText,P:d.getAttribute("utype")};V(d)?e?T(!1,!0,c):(M.push(c),T()):Rb(c.l,c.u)}
function Lb(){for(var b=r("li"),c=r("ul",b),a="selfldr"==r("div",c).getAttribute("type"),d=0,e=v(b);e;)e.tagName==b.tagName&&d++,e=v(e);if(0<d)for(e=0;e<d;e++)c.removeChild(c.lastElementChild);a?T(!0,!0,{u:q("span",b).innerText,l:b.getAttribute("uid")}):(d=w(b,"idx"),d<M.length-1&&M.splice(d+1),T(!0))}function V(b){return"1"==(b instanceof HTMLElement?b.getAttribute("utype"):"string"==typeof b?b:b.P)}function Mb(b){var c=b.lastIndexOf("."),a="";0<=c&&(a=b.slice(c+1));return a.toLowerCase()}
function Sb(){var b=r("li"),c=q("checkbox",b,"input.type");Pb(b);var a=-1;c.checked&&(a=1);b=h("li",r("ul",b));for(c=0;c<b.length;c++)b[c].classList.contains("header")||b[c].classList.contains("template")||Pb(b[c],a)}
function Ob(b){var c=r("span"),a=c.getBoundingClientRect();c=r("li",c);var d=q("#ulIteMenu");if(d.hasAttribute("ofwid"))var e=parseInt(d.getAttribute("ofwid"),10);else d.style.display="block",e=d.offsetWidth,d.setAttribute("ofwid",e);d.style.left=a.right+e>document.body.offsetWidth?a.left-e+"px":a.right+"px";d.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+a.top+"px";d.setAttribute("uid",c.getAttribute("uid"));d.setAttribute("utype",c.getAttribute("utype"));b.xa=nb}
function Qb(b,c,a){if(!b)return null;var d=wb("#divMain");d=U(d);var e;for(e=0;e<d.length&&d[e].getAttribute("uid")!=b;e++);if(e>=d.length)return null;switch(c){case 1:for(;0<=e;){e--;if(0>e){if(a)return null;a=!0;e=d.length-1}if(!V(d[e]))break}break;case 2:for(;e<d.length;){e++;if(e>=d.length){if(a)return null;a=!0;e=0}if(!V(d[e]))break}}return d[e]}
function Tb(b){var c=r("li"),a=r("ul",c),d=a.getAttribute("uid");if(d)switch(q("label",c).getAttribute("iid")){case "menuDownload":V(a)?Q("noDownFolder"):Ub(d);break;case "menuRename":c=q("#divInpName");a=q("input",c);var e=Qb(d);d=xb(e);var f=d.getBoundingClientRect();e=q("edit",e,"span.name").getBoundingClientRect();a.value=d.innerText;c.style.left=f.left+"px";c.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+f.top-2+"px";a.style.width=e.left-f.left+"px";a.style.height=f.height+
2+"px";t(c);a.focus();b.xa=4;break;case "menuMove":Vb(d);break;case "menuDelete":Wb(d)}}function Ub(b){var c=Qb(b);b={u:xb(c).innerText,l:b};Xb([b])}function Vb(b){var c=void 0,a=q("#divModal");if("string"==typeof b)a.setAttribute("uid",b);else if(Yb())a.removeAttribute("uid"),c=b;else return;b=vb(a);a=U(b);var d;for(d=0;d<a.length;d++)b.removeChild(a[d]);T(!1,!0,M[0]);ob("selfldr",c)}
function Zb(b){if(13===b.keyCode){if(b.shiftKey||b.ctrlKey||b.altKey)return!0}else return 27===b.keyCode?(u(r("div")),!1):!0;$b();return!1}function $b(){var b=r("div"),c=q("input",b);if(c.value){var a=q("#ulIteMenu").getAttribute("uid"),d=Qb(a);if(d){var e=xb(d);c.value!=e.innerText&&(d=yb(c.value),Ba({i:function(f){f?Q(f.S):(e.innerText=c.value,Pa("renDone"))},G:a,ba:d}))}u(b)}else Q("noNewName")}
function ub(b){var c=q("#divModal"),a=vb(c);a=ha(a,"li",!0).getAttribute("uid");if(a==M[M.length-1].l)b&&b(!1);else{b&&b(!0);var d=[];(b=c.getAttribute("uid"))?d.push({l:b,u:""}):d=Yb();if(0!=d.length){R("moving");var e=0,f={i:function(g){g?Q(g.S):(e++,e<d.length?(f.G=d[e].l,Ca(f)):T(!0,!1,void 0,function(){Pa("moveDone")}))},G:d[e].l,D:a,La:M[M.length-1].l};Ca(f)}}}
function Wb(b){var c=null;b?c=[{l:b,u:""}]:c=Yb();if(c&&confirm(window.msgs.delConfirm)){R("deleting");var a=0,d={i:function(e,f){e?Q(e.S):(f&&Eb(f,!0),a++,a<c.length?(d.G=c[a].l,F.delete(d)):T(!0,!1,void 0,function(){Pa("delDone")}))},G:c[a].l};F.delete(d)}}
function sb(b){var c=q("#fldnm").value;if(c){var a=q("#chkFInto").checked,d={i:function(e,f){e?(Q(e.S),b&&b(!1)):(f.u=c,a?(e=void 0,b&&(e=function(){b(!0);P(0)}),M.push(f),T(!1,!1,void 0,e)):b&&(Kb(wb("#divMain"),f),b(!0),Pa("flDone")))},N:yb(c)};0<M.length&&(d.D=M[M.length-1].l);F.C(d)}else Q("noFldName"),b&&b(!1)}
function Yb(b){var c=[],a=U(wb("#divMain")),d;for(d=0;d<a.length;d++)if(q("checkbox",a[d],"input.type").checked){if(b&&V(a[d]))return Q("noDownFolder"),null;c.push({u:xb(a[d]).innerText,l:a[d].getAttribute("uid")})}return 0>=c.length?(Q("noChecks"),null):c}
function Rb(b,c){var a=q("#diViewer"),d=r("zb-viewer",a,"div.class"),e=q("title",d,"span.name"),f=q("span",a),g=q("img",a),k=ac(a);f.innerText=window.msgs.loading;t(f);u(v(f));u(g);e.innerText=c;g.src="";a.setAttribute("uid",b);t(r("zb-modal",d,"div.class"));a=Mb(c);var l=ba[a];if(ca[a])bc(k,b,c),t(k),u(f);else if(l){var m=new pa;b=new ra({Ja:!0,ka:I,la:F.A({l:b,$:16E4}),Oa:m});b.m=function(n,p){n||p?console.log(n||p):(n=m.s(),n instanceof Uint8Array||(n=new Uint8Array(n)),l&&(g.src=window.URL.createObjectURL(new Blob([n],
{type:l})),t(g),u(f)))};b.start()}else f.innerText=window.msgs.cantView,t(v(f))}function cc(b){var c=q(b?b:"#diViewer");c=v(c,"div");var a="";if(b){if(c.style.opacity)return;a="1"}for(;c;)c.style.opacity=a,c=v(c,"div");b&&window.setTimeout(cc,5E3)}function dc(){var b=q("#diViewer").getAttribute("uid");b&&X(b,1)}function ec(){var b=q("#diViewer").getAttribute("uid");b&&X(b,2)}function fc(b){ac(q("#diViewer"));pb(b)}function hc(){var b=q();b&&b.src&&window.URL.revokeObjectURL(b.src)}
function bc(b,c,a){const d=zb_require("videostream");b.g=c;b.m=a;b.o=new sa({Ja:!0,ka:I,la:function(){return F.A({l:c})}});b.j=new d(b.o,b)}function ac(b){b=q("video",b);if(b.g){var c=M[M.length-1].l,a=b.m,d;O||(O=[]);for(d=0;d<O.length;d++)if(O[d].N==c){O[d].G=b.g;O[d].na=b.currentTime;break}d==O.length&&O.push({G:b.g,N:c,na:b.currentTime});delete b.g;delete b.m;J.Ya(O[d],d);Fb(d,a);Bb(!0)}u(b);b.j&&(b.j.destroy(),b.o.Sa(),delete b.j,delete b.o);return b}
function ic(b){if((b=b.getAttribute("parentId"))&&O){var c;for(c=0;c<O.length;c++)if(O[c].N==b)return c}return-1}
function Hb(b,c){q("close","#divHistory","span.name").click();b=q(b);b=r("li",b);b=ic(b);if(!(0>b)){b=O[b];var a=b.G,d=b.N,e=b.na;R("loading");var f=[],g=function(){d?d==M[0].l?(f.unshift(M[0]),k()):F.s({ca:d,i:function(l,m){l||(m.u=zb(m.u),f.unshift(m),m.L==M[0].L?d=void 0:d=m.L,g())}}):R("cantPlayRecent")},k=function(){var l=vb("#divMain"),m=0,n=h("li",l);for(m=0;m<n.length;m++)n[m].classList.contains("template")||n[m].remove();for(m=0;m<f.length;m++)Jb(l,f[m],m,!0);M=f;T(!0,!1,void 0,function(p){P(0);
var z;for(z=0;z<p.length&&p[z].l!=a;z++);z<p.length&&(c?X(a,2):(e&&q("video","#diViewer").setAttribute("ctime",e),X(a)))})};g()}}function Ib(b){Hb(b,!0)}function jc(b){b=q(b);var c=b.getAttribute("ctime");c&&(b.removeAttribute("ctime"),b.currentTime=c)}function Gb(b){b=q(b);b=r("li",b);var c=ic(b);0>c||(b.remove(),O.splice(c,1),J.Xa(c),0==O.length&&Bb(!1))};const kc=window.Worker?!0:!1;var Y=null;function lc(b){this.h=b;this.g=[];this.m=function(c){return this.h.l==c.l};this.s=function(c){return this.h.u==c};this.o=function(c){var a;for(a=0;a<this.g.length;a++)if(this.g[a].s(c))return this.g[a];return null};this.j=function(c){var a;for(a=0;a<this.g.length;a++)if(this.g[a].m(c))return this.g[a];c=new lc(c);this.g.push(c);return c}}var mc=null;
function U(b,c){var a=[],d=b.getElementsByTagName("li");for(b=0;b<d.length;b++){var e=d[b];if(!e.classList.contains("header")&&!e.classList.contains("template"))if(c){var f=c(e);2!=f&&-2!=f||a.push(e);if(0>f)break}else a.push(e)}return a}function nc(b){b=q(b);u(b);Y?(b=r("li",b),b={type:9,rowIdx:w(b,"rowIdx")},Y.postMessage(b)):b.setAttribute("canceled","1")}
function oc(b,c,a){var d=0,e=0;c||(c=q(".zb-qbutton"));!a&&c.hasAttribute("count")&&(a=w(c,"count"));c.hasAttribute("fincount")&&(d=w(c,"fincount"));c.hasAttribute("stopcount")&&(e=w(c,"stopcount"));switch(b){case 1:d++;c.setAttribute("fincount",d);break;case 3:c.setAttribute("haserr","1");case 2:e++,c.setAttribute("stopcount",e)}0<a?q("div",c).style.width=Math.floor(100*d/a)+"%":q("div",c).style.width="0%";a==d+e&&(c.hasAttribute("haserr")?c.classList.add("error"):c.classList.add("done"))}
function pc(b){var c=q(".zb-qbutton"),a=0;c.hasAttribute("count")&&(a=w(c,"count"));a+=b;c.setAttribute("count",a);oc(0,c,a);c.classList.contains("error")&&c.classList.remove("error");c.classList.contains("done")&&c.classList.remove("done");t(c)}
function qc(b){b=r(".zb-queue",q(b));var c=q(".zb-qbutton");b.style.top="100%";if(c.classList.contains("done")||c.classList.contains("error")){u(c);c.removeAttribute("count");c.removeAttribute("fincount");c.removeAttribute("stopcount");c.removeAttribute("haserr");b=q("ul",b);c=U(b);var a;for(a=c.length-1;0<=a;a--)b.removeChild(c[a]);b.removeAttribute("rowCount")}}
function rc(b,c,a){var d=0;b.hasAttribute("rowCount")&&(d=w(b,"rowCount"));var e=q("template",b,"li.class").cloneNode(!0);e.classList.remove("template");e.setAttribute("rowIdx",d);a&&e.setAttribute("downFl",1);b.setAttribute("rowCount",d+1);d=h("span",e);var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "cancel":g.addEventListener("click",nc);break;case "icon":q("label",g).innerText=c;a?y(g,"download"):y(g,"upload");break;case "elTime":ha(g,"label").innerText=window.msgs.elTime;
break;case "esTime":ha(g,"label").innerText=window.msgs.esTime;break;case "speed":g.innerText=window.msgs.waiting}}b.appendChild(e);return e}function sc(b,c){c||(c=q("ul","#divQueue"));c=U(c,function(a){return a.getAttribute("rowIdx")==b?-2:1});return 0<c.length?c[0]:null}function tc(b,c){var a=0;if(1==b)a=1;else if(2!=b)return;b=h("svg",".zb-qbutton")[a];c?b.classList.add("pulse"):b.classList.remove("pulse")}
function uc(b,c){var a=null,d=h("span",b),e="";switch(c.type){case 0:e="0%";tc(c.wtype,!0);break;case 1:e=Math.round(100*c.posn/c.size)+"%";break;case 2:e="100%";case 3:tc(c.wtype)}var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "icon":a=g;break;case "percent":switch(c.type){case 0:case 1:g.innerText=e;break;case 2:c.errr||(g.innerText=e)}break;case "elTime":switch(c.type){case 1:case 2:case 3:g.innerText=la(Math.floor((Date.now()-c.begin)/1E3))}break;case "esTime":switch(c.type){case 1:g.innerText=
la(Math.round((c.size-c.posn)/c.spd))}break;case "speed":switch(c.type){case 1:g.innerText=B(c.spd)+"/s";break;case 2:case 3:c.errr||(b.classList.add("done"),g.innerText=window.msgs.avspeed.replace("{0}",B(1E3*c.posn/(Date.now()-c.begin))))}break;case "cancel":switch(c.type){case 0:t(g);break;case 2:case 3:var k=q("svg",g);k.removeChild(k.firstElementChild);c.errr||3==c.type?(y(g,"multi"),oc(c.errr?3:2)):(y(g,"chkbox",void 0,"#10B981"),oc(1));t(g)}break;default:if((k=r("div",g))&&k.classList.contains("zb-progressbar"))switch(c.type){case 0:case 1:g.style.width=
e;break;case 2:c.errr?(b.classList.add("error"),k.innerText=c.errr):g.style.width=e}}}return a}function vc(b,c){c=sc(b.rowIdx,c);wc(c,b)}function wc(b,c){var a=!1;switch(c.type){case 0:case 1:uc(b,c);break;case 2:c.fined&&Y&&xc();b=uc(b,c);c.errr||(2==c.wtype?Eb(c.size):1==c.wtype&&c.blob&&(b=q("label",b).innerText,ia(c.blob,b,q("#lnkDown"))));window.gc&&window.gc();a=!0;break;case 3:c.fined&&Y&&xc(),uc(b,c),window.gc&&window.gc(),a=!0}return a}
function xc(){var b=Y;mc=Y=null;b.terminate();b.g&&T(!0)}function yc(b){Y||(Y=new Worker("worker.js"),Y.h={gtoken:F.h?F.h:"",iv:I.iv.toString(CryptoJS.enc.Base64url),key:I.key.toString(CryptoJS.enc.Base64url),drvid:F.m()},Y.addEventListener("message",function(c){vc(c.data)}));b.cominf=Y.h;2!=b.type||Y.g||(Y.g=!0);Y.postMessage(b)}
function zc(b,c){var a=w(b,"rowIdx"),d=q("cancel",b,"span.name");return new Oa(function(){return d.getAttribute("canceled")?!0:!1},function(e){e.rowIdx=a;wc(b,e)&&c()})}function Xb(b){var c=q("ul","#divQueue"),a=0;pc(b.length);for(a=0;a<b.length;a++){var d=rc(c,b[a].u,!0);kc?yc({type:1,rowIdx:w(d,"rowIdx"),downinf:{targetId:b[a].l}}):b[a].L=d.getAttribute("rowIdx")}if(!kc){var e=function(f){var g=sc(parseInt(b[f].L,10),c);zc(g,function(){f++;f<b.length&&e(f)}).A(b[f].l)};e(0)}}
function tb(b){function c(l){var m=d[l];Ac(k,m.Za,function(n,p,z){n?vc({type:2,wtype:2,rowIdx:m.ia,size:0,errr:JSON.stringify(n)},a):kc?(yc({type:2,rowIdx:m.ia,upinf:{fname:p,file:m.Ra,ptid:z}}),l++,l<d.length&&c(l)):(n=sc(m.ia,a),zc(n,function(){l++;l<b.length?c(l):T(!0)}).H(p,m.Ra,z))})}var a=q("ul","#divQueue"),d=[],e=0;pc(b.length);for(e=0;e<b.length;e++){var f="";f=b[e].webkitRelativePath?b[e].webkitRelativePath:b[e].name;var g=rc(a,f);d.push({Za:f,Ra:b[e],ia:w(g,"rowIdx")})}mc||(mc=new lc(M[0]));
var k=mc;for(e=1;e<M.length;e++)k=k.j(M[e]);c(0)}function Ac(b,c,a){var d=c.split("/"),e=yb(d.pop()),f=b;if(0==d.length)a(!1,e,f.h.l);else{var g=!1,k=function(l){function m(A){f=A;l++;l<d.length?k(l):a(!1,e,f.h.l)}var n=d[l],p=yb(n);if(g)F.C({N:p,D:f.h.l,i:function(A,D){A?a(A,e):(D.u=n,m(f.j(D)))}});else{var z=f.o(n);z?m(z):F.o({Z:p,D:f.h.l,i:function(A,D){A?a(A,e):0==D.length?(g=!0,k(l)):(D[0].u=n,m(f.j(D[0])))}})}};k(0)}};var Z=null;function Bc(b){switch(b){case 1:b=q(".zb-nav-tools");b={X:q("button",b),O:v(b)};break;case 2:b=q("button",q(".zb-main-header","#divMain"));b={X:b,O:v(b)};break;case nb:b={O:q("#ulIteMenu")};break;default:return null}return b}function Cc(b){var c=Bc(b);c&&(c.O.style.display="none",c.O.style.maxHeight="0px",c.X&&c.X.addEventListener("click",function(a){a.xa=b}))}
function Dc(b,c){var a=Bc(c);a&&(a.O.style.display?a.O.style.maxHeight&&b.xa==c&&(t(a.O),a.X&&(u(a.X.children[0]),t(a.X.children[1])),window.setTimeout(function(){a.O.style.maxHeight="";a.O.style.paddingTop="";a.O.style.paddingBottom=""},50)):a.O.style.maxHeight||b.xa==c&&!a.X||(a.O.style.paddingBottom="0px",a.O.style.maxHeight="0px",window.setTimeout(function(){a.X&&(t(a.X.children[0]),u(a.X.children[1]));a.O.style.paddingTop="0px";u(a.O)},500)))}
function Ec(b){Dc(b,1);Dc(b,2);Dc(b,nb);4!=b.xa&&u("#divInpName")}function Fc(b){b=b.target||b.srcElement;"INPUT"!=b.tagName&&(b=q("input",r("div",b)),b.focus(),b.click())}function Gc(b){var c=r("li",b);switch(b.getAttribute("iid")){case "menuGeneral":c.addEventListener("click",Va);break;case "menuDrive":c.addEventListener("click",S);break;case "menuHistory":c.addEventListener("click",function(){q("#divHistory").style.top=""})}}
function Hc(){var b=q("label",r("li")),c=b.getAttribute("iid"),a=void 0;(b=v(b))&&(a=function(){b.classList.remove("rotate-90")});switch(c){case "menuNewFldr":b&&b.classList.add("rotate-90");ob("new",a);break;case "menuUpload":b&&b.classList.add("rotate-90");ob("upload",function(){q("#upfiles").value=null;q("#upfolder").value=null;a&&a()});break;case "menuMovefs":b&&b.classList.add("rotate-90");Vb(a);break;case "menuDownfs":(c=Yb(!0))&&Xb(c);break;case "menuDelfs":Wb()}}
window.addEventListener("load",function(){var b=RegExp("android","i").test(navigator.userAgent),c=q("#divMessage"),a=h("span",c);a[a.length-1].children[0].addEventListener("click",function(){P(0)});document.addEventListener("click",Ec);Cc(1);Cc(2);Cc(nb);var d=0;c=0;a=h("span",q(".zb-nav-tools"));for(d=0;d<a.length;d++)Gc(a[d]);a=h("label",q(".zb-nav-menu"));for(d=0;d<a.length;d++)Gc(a[d]);a=h(".zb-settings");for(d=0;d<a.length;d++){var e=h(".checkbox",a[d]);for(c=0;c<e.length;c++)e[c].addEventListener("click",
Fc)}c=q("#divSet");a=h("button",c);for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("iid")){case "btnLogout":c.addEventListener("click",Ua);break;case "btnCancel":c.addEventListener("click",ab);break;case "btnOk":c.addEventListener("click",$a)}a=h("span",q("#divPwd"));for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("tid")){case "spanAddRoot":c.addEventListener("click",bb);break;case "spanDeleteRoot":c.addEventListener("click",db);break;case "spanMoreKey":b?c.addEventListener("click",gb):c.style.display=
"none";break;case "spanClearKey":b?c.addEventListener("click",cb):c.style.display="none"}a=h("button",q("#divPwd"));for(d=0;d<a.length;d++)switch(c=a[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",fb);break;case "btnOk":c.addEventListener("click",hb);break;case "btnDropDb":c.addEventListener("click",mb)}c=q("#divModal");c.addEventListener("click",pb);c.children[0].addEventListener("click",function(f){f.stopPropagation()});a=h("button",c);for(d=0;d<a.length;d++)switch(c=a[d],
c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",pb);break;case "btnOk":c.addEventListener("click",qb)}a=h(".zb-main-menu");for(d=0;d<a.length;d++)for(b=h("li",a[d]),c=0;c<b.length;c++)b[c].addEventListener("click",Hc);c=q("#chkAll");c.addEventListener("click",Sb);v(c).addEventListener("click",Sb);a=h("li","#ulIteMenu");for(d=0;d<a.length;d++)a[d].addEventListener("click",Tb);c=q("#divInpName");c.addEventListener("click",function(f){f.stopPropagation()});q("input",c).addEventListener("keyup",
Zb);q("span",c).addEventListener("click",$b);c=q("#diViewer");c.addEventListener("click",cc);c.addEventListener("touchstart",function(f){Z||1!=f.changedTouches.length||(f=f.changedTouches[0],Z={l:f.identifier,bb:f.screenX,cb:f.screenY})});c.addEventListener("touchend",function(f){if(Z){var g=null,k;for(k=0;k<f.changedTouches.length;k++)if(f.changedTouches[k].identifier==Z.l){g=f.changedTouches[k];break}g&&(f=g.screenX-Z.bb,g=g.screenY-Z.cb,10>g&&-10<g&&(50<f?dc():-50>f&&ec()));Z=null}});q("button",
c).addEventListener("click",function(){Ub(r("div").getAttribute("uid"))});q("img",c).addEventListener("load",hc);c=q("video",c);c.addEventListener("canplay",jc);c.addEventListener("ended",function(){X(r("div").getAttribute("uid"),2,!0)});document.addEventListener("fullscreenchange",function(){document.fullscreen?q("#diViewer").classList.add("full"):q("#diViewer").classList.remove("full")});c=r("zb-viewer",c,"div.class");a=h("span",c);for(d=0;d<a.length;d++)switch(a[d].getAttribute("name")){case "close":a[d].addEventListener("click",
fc);break;case "previous":a[d].addEventListener("click",dc);break;case "next":a[d].addEventListener("click",ec);break;case "fullscreen":a[d].addEventListener("click",function(){r("div","#diViewer",void 0,!0).requestFullscreen()})}c=r("zb-modal",c,"div.class");c.addEventListener("click",fc);c.children[0].addEventListener("click",function(f){f.stopPropagation()});q(".zb-qbutton").addEventListener("click",function(){q("#divQueue").style.top=""});q("close","#divQueue","span.name").addEventListener("click",
qc);q("close","#divHistory","span.name").addEventListener("click",function(){q("#divHistory").style.top="100%"});Ab()});
