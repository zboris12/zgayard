const aa={en:"English",ja:"日本語"},ba={bmp:"image/bmp",gif:"image/gif",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png"},ca={avi:"video/x-msvideo",mp4:"video/mp4",mpeg:"video/mpeg"};function da(a,c){var b="",d="";if(c){d=c.indexOf(".");0<=d&&(b=c.substring(0,d).toUpperCase(),c=c.slice(d+1));switch(c.toLowerCase()){case "id":c="#";break;case "class":c="."}d=a}else c=a.charAt(0),"#"==c||"."==c?d=a.slice(1):(c="",b=a.toUpperCase());return{na:b,u:c,xa:d}}function ea(a,c){return"#"==c.u?a.id==c.xa:"."==c.u?a.classList.contains(c.xa):c.u?a.getAttribute(c.u)==c.xa:!0}
function h(a,c,b){var d=[],e=document;c&&("string"==typeof c?(c=h(c),0<c.length&&(e=c[0])):e=c);b=da(a,b);if(!b.na)if("#"==b.u)d.push(document.getElementById(b.xa));else if("."==b.u)for(c=e.getElementsByClassName(b.xa),a=0;a<c.length;a++)d.push(c[a]);else b.na="*";if(b.na)for(e=e.getElementsByTagName(b.na.toLowerCase()),a=0;a<e.length;a++)ea(e[a],b)&&d.push(e[a]);return d}
function q(a,c,b){var d=null;a?"string"==typeof a?(a=h(a,c,b),0<a.length&&(d=a[0])):a instanceof Event?d=a.currentTarget||a.srcElement||a.target:d=a:d=window.event.currentTarget||window.event.srcElement||window.event.target;return d}function r(a,c,b,d){var e=null;c?"string"==typeof c?e=q(c):e=c:e=q();d&&(e=e.parentElement);for(a=da(a,b);e&&(e.tagName!=a.na&&a.na||!ea(e,a));)e=e.parentElement;return e}function fa(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)}
function t(a){(a=q(a))&&a.style.display&&(a.style.display="")}function u(a){if(a=q(a))a.style.display="none"}function v(a,c){if((a=a.nextElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);a&&a.id!=c;)a=a.nextElementSibling;break;default:for(c=c.toUpperCase();a&&a.tagName!=c;)a=a.nextElementSibling}return a}
function ha(a,c,b){if((a=b?a.lastElementChild:a.previousElementSibling)&&c)switch(c.charAt(0)){case "#":for(c=c.slice(1);a&&a.id!=c;)a=a.previousElementSibling;break;default:for(c=c.toUpperCase();a&&a.tagName!=c;)a=a.previousElementSibling}return a}function w(a,c){return parseInt(a.getAttribute(c),10)}
function ia(a,c,b){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,c);else if(b)b.download=c,b.href=window.URL.createObjectURL(a),b.click();else throw Error("Element for download is not specified.");}function ja(a){if(!a)return null;var c=a.charAt(0);if("?"==c||"#"==c)a=a.substring(1);var b={};a.split("&").forEach(function(d){var e=d.indexOf("=");0>e?b[decodeURIComponent(d)]="":b[decodeURIComponent(d.substring(0,e))]=decodeURIComponent(d.substring(e+1))});return b}
function ka(){var a=ja(window.location.search),c=ja(window.location.hash);c&&(a=a?Object.assign(a,c):c);return a}function x(a,c){var b=[],d;for(d in a)c?b.push(d.concat("=").concat(a[d])):b.push(encodeURIComponent(d).concat("=").concat(encodeURIComponent(a[d])));return 0<b.length?"?".concat(b.join("&")):""}
function y(a,c,b,d){var e=q("svg",a),f=document.createElementNS("http://www.w3.org/2000/svg","use");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#".concat(c));e||(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.appendChild(e));e.appendChild(f);b&&(e.style.fill=b);d&&(e.style.stroke=d)}
function B(a){if(a)if(1024>a)var c="B";else 1048576>a?(c="KB",a=Math.round(a/102.4)/10):1073741824>a?(c="MB",a=Math.round(a/104857.6)/10):(c="GB",a=Math.round(a/1.073741824E8)/10);else c="B",a=0;var b=a.toString();a=b.indexOf(".");var d=b.split(""),e=[];0<=a?e.push(b.slice(a)):a=d.length;for(b=0;0<a;)3==b++&&(e.unshift(","),b=1),e.unshift(d[--a]);return e.join("").concat(c)}
function la(a){var c=a%60;a=(a-c)/60;var b=a%60;a=(a-b)/60;var d=[];0<a&&d.push(a.toString(10));d.push("0".concat(b).slice(-2));d.push("0".concat(c).slice(-2));return d.join(":")}function ma(a){if(!a)return 0;var c=a.indexOf("-");if(0>c)return 0;c++;var b=a.indexOf("/",c);return b<=c?0:parseInt(a.slice(c,b),10)};function C(a){var c=CryptoJS.MD5(a);a=CryptoJS.kdf.OpenSSL.execute(a,8,4,c);a.iv.clamp();a.key.clamp();return a}
function na(a,c,b){var d=b;"string"==typeof b&&(d=C(b));if(!(d&&d.iv&&d.key))throw Error("Need iv and key. They can be generated by CryptoJS.kdf.OpenSSL.execute from password and salt.");b={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};Object.assign(b,d);a=a?CryptoJS.algo.AES.createEncryptor(b.key,b):CryptoJS.algo.AES.createDecryptor(b.key,b);c=a.process(c);c.concat(a.finalize());c.clamp();return c}
function oa(a){var c=Array(a.sigBytes);a=a.words;for(var b=0,d=0;d<a.length;d++){for(var e=a[d],f=b+4-1;f>=b;f--)f<c.length&&(c[f]=e&255),e>>=8;b+=4;if(b>=c.length)break}return c}
function pa(){this.h=0;this.g=null;this.j=function(a,c){this.h=a;c&&c()};this.write=function(a,c){Array.isArray(a)?this.g=this.g?this.g.concat(a):a.concat():(this.g||(this.g=[]),this.g.push(a));c&&c()};this.cancel=function(a){a&&a(!1,!0)};this.s=function(){if(this.g&&0<this.g.length&&(this.g[0]instanceof ArrayBuffer||this.g[0]instanceof Uint8Array)){for(var a=0,c=0;c<this.g.length;c++)a+=this.g[c].byteLength;a=new Uint8Array(a);var b=0;for(c=0;c<this.g.length;++c){var d=this.g[c];d instanceof ArrayBuffer&&
(d=new Uint8Array(d));a.set(d,b);b+=d.byteLength}return a}return this.g};this.A=function(){var a=this.s();a instanceof Uint8Array||(a=new Uint8Array(a));return new Blob([a],{type:"application/octet-binary"})};this.download=function(a){var c=this.A();ia(c,a,null)};this.C=function(){return this.h}}
function qa(a){this.blob=null;if(a.Da)if(a.Da instanceof Blob)this.blob=a.Da;else throw Error("blob is not a Blob.");else throw Error("blob must be specified.");this.s=1600;a.$&&(this.s=a.$);this.h=0;this.o=this.m=null;this.H=function(c,b){if(c){if(c>=this.g())throw Error("offset can not be bigger than input size.");this.h=c}this.m=new FileReader;this.m.onload=function(d){d=d.target.result;this.o&&this.o(d,this)}.bind(this);b&&b()};this.A=function(){return this.h};this.g=function(){return this.blob.size};
this.C=function(){return this.h>=this.g()};this.j=function(c){if(1!=this.m.readyState){var b=this.h;this.h=c?this.h+c:this.h+this.s;this.m.readAsArrayBuffer(this.blob.slice(b,this.h))}};this.O=function(){this.blob=this.m=null}}
function ra(a,c){if(!a.Qa)if(this.getSuperClass&&"Readable"==this.getSuperClass().name)this.super(c),this.h=1,c&&c.objectMode&&(this.M=!0);else throw Error("writer must be specified in no stream mode.");this.m=this.H=null;this.C=!0;this.g=null;this.o=a.Qa;this.iv=this.key=null;this.j=0;this.A=null;this.speed=this.B=this.s=0;a.La&&(this.C=!1);if(a.ma)"function"==typeof a.ma?this.g=a.ma():this.g=a.ma;else throw Error("reader must be specified.");if(a.la)c=null,c="string"==typeof a.la?C(a.la):a.la,this.key=
c.key,this.iv=c.iv;else throw Error("keycfg must be specified.");this.start=function(b){if(b){if(this.C)throw Error("Can NOT set offset for encryption.");this.j=b;b-=b%16+16;0>b&&(b=0)}this.g.o=this.I.bind(this);this.g.H(b,function(){var d=16*Math.ceil((this.g.g()+1)/16);this.h||!this.o?this.F():this.o.j(d,this.F.bind(this))}.bind(this))};this.O=function(){Date.now()>this.s&&(this.speed=1E3*(this.g.A()-this.B)/(Date.now()-this.s+1E3),this.s=Date.now()+1E3,this.B=this.g.A());return this.speed};this._read=
function(b){1==this.h?this.h=2:3==this.h&&(this.g.C()?this.push(null):this.g.j(b))};this.push=function(b){return this.readable?(b&&!this.M?this.superCall("push",new Uint8Array(b)):this.superCall("push",b),!0):!1};this.F=function(){this.s=Date.now()+1E3;(this.B=this.j)?this.g.j(16):1==this.h?this.h=3:2==this.h?(this.h=3,this.push([])):this.g.j()};this.I=function(b){try{var d=new CryptoJS.lib.WordArray.init(b);if(!this.A){var e={iv:this.iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7};this.j&&
(e.iv=d,d=null);this.A=this.C?CryptoJS.algo.AES.createEncryptor(this.key,e):CryptoJS.algo.AES.createDecryptor(this.key,e)}if(d){var f=oa(this.A.process(d));this.g.C()&&(f=f.concat(oa(this.A.finalize())));if(this.j<this.g.A()){var g=this.j-(this.g.A()-b.byteLength);0<g&&(f=f.slice(g))}else f=null;this.h?this.push(f):f?this.o&&this.o.write(f,function(){this.g.C()?this.Ra():this.H?this.H()?this.g.j():this.o.cancel(function(k,l){this.Ra(k,l)}.bind(this)):this.g.j()}.bind(this)):this.g.j();f=null}else this.h?
2==this.h?(this.h=3,this.push([])):this.h=3:this.g.j()}catch(k){if(this.h)throw k;this.Ra(k)}};this.Ra=function(b,d){this.g&&(this.g.O(),this.g=null);this.m&&(b?this.m(b):this.m(!1,d))}}
function sa(a){const c=zb_require("readable-stream");ra.super_!==c.Readable&&zb_inherits(ra,c.Readable);this.h={highWaterMark:8E5};Object.assign(this.h,void 0);this.info=a;this.g=null;this.createReadStream=function(b){this.Va();this.g=new ra(this.info,this.h);var d=0;b&&b.start&&(d=b.start);this.g.start(d);return this.g};this.Va=function(){this.g&&(this.g.destroy(),this.g=null)}}
function ta(a,c,b){a.o=function(d){c.write(d,function(){a.C()?b&&b():a.j()})};a.H(0,function(){c.j(a.g(),function(){a.j()})})};function ua(){this.s=!0;this.g=this.v=null;this.o=this.H=!1;this.j=-1;this.U=function(){return null!=this.v};this.M=function(a){if(this.s)try{var c=window.sessionStorage.getItem("language"),b=window.sessionStorage.getItem("relay_url"),d=window.sessionStorage.getItem("drive"),e=window.sessionStorage.getItem("drive_extra"),f=window.sessionStorage.getItem("skipLogin");window.sessionStorage.clear();c&&window.sessionStorage.setItem("language",c);b&&!a&&window.sessionStorage.setItem("relay_url",b);d&&!a&&
window.sessionStorage.setItem("drive",d);e&&!a&&window.sessionStorage.setItem("drive_extra",e);f&&!a&&window.sessionStorage.setItem("skipLogin",f)}catch(g){this.s=!1,console.error(g)}};this.m=function(a){var c=null;if(this.s)try{c=window.sessionStorage.getItem(a)}catch(b){this.s=!1,console.error(b)}return c};this.pa=function(a){var c=this.m("login_state");return c&&a==c?!0:!1};this.A=function(a,c){if(this.s)try{return window.sessionStorage.setItem(a,c.toString()),!0}catch(b){this.s=!1,console.error(b)}return!1};
this.F=function(a){if(this.s)try{window.sessionStorage.removeItem(a)}catch(c){this.s=!1,console.error(c)}};this.ta=function(){var a=this.m("language"),c=this.m("relay_url"),b=this.m("drive"),d=this.m("drive_extra"),e=this.m("skipLogin");this.g={};a&&(this.g.language=a,this.V(a));c&&(this.g.za=c,this.ha(c));b&&(this.g.K=b,this.Ba(b));d&&(this.g.Wa=d,this.O(d));e&&this.Ca(e)};this.Ja=function(){var a=this.h("drive");a||(this.g||this.ta(),a=this.g.K);return a};this.Ba=function(a){return this.da("drive",
a)?(this.v[a]||(this.v[a]={}),!0):this.v?!1:!0};this.Ca=function(a){a?this.o=this.U():(this.o=!1,this.Za()&&(this.H=!0));this.A("skipLogin",this.o)};this.sa=function(a){var c=this.h("language");!c&&a&&this.g&&(c=this.g.language);return c};this.V=function(a){this.da("language",a)};this.ga=function(){var a=this.h("relay_url");!a&&this.g&&(a=this.g.za);return a?a:""};this.ha=function(a){this.da("relay_url",a)};this.ra=function(){var a=null,c=this.C("extra_info");!c&&this.g&&this.g.Wa&&(c=this.g.Wa);
c&&(a=JSON.parse(c));return a&&2==a.length?{Ea:a[0],ia:a[1]}:null};this.O=function(a){a?(a="string"===typeof a?a:JSON.stringify([a.Ea,a.ia]),this.A("drive_extra",a),this.B("extra_info",a)):(this.F("drive_extra"),this.B("extra_info",null))};this.bb=function(a){if(window.indexedDB){var c=window.indexedDB.open("zgayard1946");c.onerror=function(){if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};c.onupgradeneeded=
function(b){b.target.result.createObjectStore("settings",{keyPath:"key"})};c.onsuccess=function(b){var d=b.target.result;b=d.transaction("settings","readwrite");b.oncomplete=function(){d.close();a&&a()};b.objectStore("settings").getAll().onsuccess=function(e){this.v={};e.target.result.forEach(function(f){this.v[f.key]=f.value}.bind(this));this.o=(e=this.v.drive)&&this.v[e]&&this.v[e].refresh_token?!0:!1}.bind(this)}.bind(this)}else if(a)a("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");
};this.$a=function(a){var c=window.indexedDB.deleteDatabase("zgayard1946");c.onerror=function(){if(a)a("Failed to dropt IndexedDB.");else throw Error("Failed to dropt IndexedDB.");};c.onsuccess=function(){this.M(!0);this.v=null;this.o=!1;a?a():console.log("IndexedDB has been dropped.")}.bind(this)};this.Aa=function(){this.H&&this.v&&(this.I(function(a){a.clear().onsuccess=function(){for(var c in this.v)a.put({key:c,value:this.v[c]})}.bind(this)}.bind(this)),this.H=!1)};this.C=function(a){var c=this.h("drive");
return c&&(c=this.v[c])?c[a]:null};this.Za=function(){var a=this.h("drive");return a&&(a=this.v[a])&&a.refresh_token?(delete a.refresh_token,!0):!1};this.B=function(a,c,b){if(this.v){var d=this.h("drive");if(c)this.v[d]||(this.v[d]={}),this.v[d][a]=c;else if(this.v[d]&&this.v[d][a])delete this.v[d][a];else{b&&b instanceof Function&&b();return}b?(a=void 0,b instanceof Function&&(a=b),this.I(function(e){e.put({key:d,value:this.v[d]})}.bind(this),a)):this.H=!0}else b&&b instanceof Function&&b()};this.qa=
function(a){this.M(!0);if(this.v){var c=this.h("drive");delete this.v[c].refresh_token;delete this.v.drive;this.I(function(b){b.put({key:c,value:this.v[c]});b.delete("drive")}.bind(this),a)}else a&&a()};this.eb=function(a,c){var b=this.h("recent");b||(b=[]);0>this.j&&(b.push({drive:this.h("drive"),root:this.C("root"),played:[]}),this.j=b.length-1);var d=b[this.j];a={fid:a.G,time:a.oa};0<=c&&c<d.played.length?d.played[c]=a:d.played.push(a);this.saveData("recent",b,void 0)};this.ab=function(){var a=
this.h("recent");this.j=-1;if(a){var c=0;for(c=0;c<a.length;c++){var b=a[c];if(b.drive==this.h("drive")&&b.root==this.C("root")){this.j=c;break}}}if(0<=this.j){var d=[];a[this.j].played.forEach(function(e){d.push({G:e.fid,N:"",oa:e.time})});return d}return null};this.cb=function(a){var c=this.h("recent");if(c&&!(0>this.j)){var b=c[this.j].played;a<b.length&&(b.splice(a,1),this.saveData("recent",c,void 0))}};this.I=function(a,c){window.indexedDB.open("zgayard1946").onsuccess=function(b){var d=b.target.result;
b=d.transaction("settings","readwrite");b.oncomplete=function(){d.close();c&&c()};b=b.objectStore("settings");a&&a(b)}};this.da=function(a,c){if(c){if(this.A(a,c),this.v&&this.v[a]!=c)return this.v[a]=c,this.H=!0}else if(this.F(a),this.v&&this.v[a])return delete this.v[a],this.H=!0;return!1};this.h=function(a){return this.v&&this.v[a]?this.v[a]:null};this.saveData=function(a,c,b){this.v&&(this.v[a]=c);this.I(function(d){d.put({key:a,value:c})}.bind(this),b)}};var va={};function wa(a,c,b){this.l=a;this.u=c;this.g=b}function E(a,c){this.za=null;this.qa=c;this.h=null;this.g=a;this.super||(this.super=function(){})}function xa(a){null==a.za&&(a.za=a.g.ga());return a.za}
function ya(a,c){var b="POST",d=a.B().concat(encodeURI(c.aa)),e=new XMLHttpRequest;c&&c.Fa&&(b=c.Fa);e.open(b,d,!0);c&&c.J?e.setRequestHeader("Authorization",c.J):c&&c.Ga?(b="Bearer",c&&c.Ha&&(b=c.Ha),e.setRequestHeader("Authorization",b+" "+c.Ga)):e.setRequestHeader("Authorization",a.h);if(c&&c.ua)for(var f in c.ua)e.setRequestHeader(f,c.ua[f]);c&&c.i&&(e.onload=function(g){g=g.target;4==g.readyState&&(401==g.status&&this.g.o&&!c.hb?za(this,c):c.i(g))}.bind(a));e.send(c.Ka)}
E.prototype.H=function(a,c){if(c&&(this.h=this.g.m("access_token"))){a();return}var b=this.g.o,d={};if((c=ka())&&c.token_type&&c.access_token){this.h=c.token_type+" "+c.access_token;this.g.A("access_token",this.h);if(c&&c.state)if(this.g.pa(c.state))this.g.F("login_state");else{a("Unauthorized access to this url.");return}a()}else{c&&c.code?d.code=c.code:b&&(d.Sa=this.g.C("refresh_token"));var e=this.g.ra();e&&(d.clientId=e.Ea,d.Ua=e.ia);if(d.code||d.Sa){if(c&&c.state)if(this.g.pa(c.state))this.g.F("login_state");
else{a("Unauthorized access to this url.");return}Aa(this,d,function(f){f&&f.token_type&&f.access_token?(e&&f.client_secret_enc&&(e.ia=f.client_secret_enc,this.g.O(e)),this.h=f.token_type+" "+f.access_token,this.g.A("access_token",this.h),b&&d.code&&f.refresh_token&&this.g.B("refresh_token",f.refresh_token),f.logout&&this.g.A("logout_url",f.logout),a()):f&&f.error?a("["+f.error+"] "+f.error_description):a("Unknown error occured when doing authorization.")}.bind(this))}else b&&(d.Ya=!0),Aa(this,d,
function(f){f&&f.url?(e&&f.client_secret_enc&&(e.ia=f.client_secret_enc,this.g.O(e)),f.state&&(this.g.A("login_state",f.state)||(f.state=this.m())),f.logout&&this.g.A("logout_url",f.logout),window.location.href=f.url.concat("&state=".concat(encodeURIComponent(f.state)))):f&&f.error?a("["+f.error+"] "+f.error_description):a("Unknown error occured when doing authorization.")}.bind(this))}};
E.prototype.ha=function(){this.h=null;this.g.F("access_token");var a=this.g.m("logout_url");if(a)window.location.href=a;else{a=new FormData;a.append("drive_type",this.m());a.append("action","logout");var c=new XMLHttpRequest;c.open("POST",this.qa,!0);c.withCredentials=!0;c.onload=function(b){b=b.target;4==b.readyState&&200==b.status&&(b=JSON.parse(b.responseText))&&b.logout&&(window.location.href=b.logout)};c.send(a)}};
function Ba(a){var c=F;if(!a||!a.ba)throw Error("newname is not specified.");c.M(a)}function Ca(a){var c=F;if(!a||!a.D)throw Error("parentid is not specified.");if(!a||!a.Na)throw Error("oldparentid is not specified.");c.M(a)}E.prototype.da=function(a,c){c&&c(!1)};E.prototype.U=function(a){return new Da(a,this)};E.prototype.ta=function(){};E.prototype.A=function(a){return new Ea(a,this)};function Fa(a){return{W:a.status,S:a.responseText}}
function G(a,c,b,d,e,f,g,k){c={aa:c,Fa:b,i:function(l){var m=Fa(l),n=!1;d&&l.status!=d&&(n=!0);if(n)if(e&&e.i)e.i(m);else throw Error(JSON.stringify(m));else k(m)}.bind(a)};Ga(e,c);f&&(c.ua=f);g&&(c.Ka=g);ya(a,c)}function H(a,c,b,d){G(a,c,"GET",200,b,null,null,function(e){d(e.S)})}function Ga(a,c){a.Ha&&(c.Ha=a.Ha);a.Ga&&(c.Ga=a.Ga);a.J&&(c.J=a.J)}
function Aa(a,c,b){if(!c)throw Error("Options are not specified when auth onedrive.");var d=new FormData;d.append("drive_type",a.m());c.clientId&&d.append("client_id",c.clientId);c.kb&&d.append("redirect_uri",c.kb);c.Ua&&d.append("client_secret",c.Ua);c.code?d.append("code",c.code):c.Sa?d.append("refresh_token",c.Sa):c.Ya&&d.append("need_code",c.Ya);c=new XMLHttpRequest;c.open("POST",a.qa,!0);c.withCredentials=!0;c.onload=function(e){e=e.target;if(4==e.readyState)if(200==e.status)b&&b(JSON.parse(e.responseText));
else throw Error(e.responseText+" ("+e.status+")");};c.send(d)}function za(a,c){console.log("Retry to send ajax.");c&&(c.hb=!0,a.H(function(b){b?console.error(b):(c.J=this.h,ya(this,c))}.bind(a)))}
function Ha(a){a.Ia=E;if("function"===typeof Object.create)a.prototype=Object.create(E.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});else{var c=function(){};c.prototype=E.prototype;a.prototype=new c;a.prototype.constructor=a}a.prototype.getSuperClass||(a.prototype.getSuperClass=function(){return this.constructor.Ia});a.prototype.super||(a.prototype.super=function(...b){return this.constructor.Ia.call(this,...b)});a.prototype.superCall||(a.prototype.superCall=function(b,
...d){return b?this.constructor.Ia.prototype[b].call(this,...d):this.constructor.Ia.call(this,...d)})}function Ia(a,c,b){Ha(b);va[a]=new wa(a,c,b)}var Ja=-1,Ka=-9,La=0;
function Da(a,c){this.K=c;this.m=a;this.B="";this.g=this.o=0;this.h=null;if(!this.m||!this.m.ea)throw Error("fnm is not specified.");this.j=function(b,d){this.o=b;this.K.O(this.m,b,function(e,f){if(e)this.B=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(b,d){var e=null;if(this.h){if(this.h instanceof ArrayBuffer){var f=this.h.byteLength;0<f?(e=new Uint8Array(f+b.byteLength),e.set(new Uint8Array(this.h),0),e.set(new Uint8Array(b),f)):e=new Uint8Array(b)}else e=
0<this.h.length?new Uint8Array(this.h.concat(b)):new Uint8Array(b);this.h=null}else e=new Uint8Array(b);var g=new Blob([e],{type:"application/octet-binary"}),k="bytes "+this.g+"-";this.g+=g.size;k+=this.g-1+"/"+this.o;var l=0,m=function(){var n=new XMLHttpRequest;n.open("PUT",this.B,!0);n.setRequestHeader("Content-Range",k);n.onload=function(p){g=null;p=p.target;if(4==p.readyState){var z=this.K.ga(p);if(z==Ka)throw b=null,Error(p.responseText+" ("+p.status+")");if(z!=Ja&&z!=La&&z<this.g){var A=b instanceof
ArrayBuffer?b.byteLength:b.length;A-=this.g-z;if(0<A){A=b.slice(A);b=null;if(this.g>=this.o){this.write(A,d);return}this.h=A;this.g=z}else throw b=null,Error("Can NOT continue to upload buffer.");}d&&d(p.responseText)}}.bind(this);n.onerror=function(){1>l?(l++,setTimeout(function(){m()},500)):g=b=null};n.send(g)}.bind(this);m()};this.cancel=function(b){this.K.da(this.B,b)};this.C=function(){return this.o}}
function Ea(a,c){this.K=c;this.F=a;this.url="";this.name=null;this.I=this.m=this.h=this.size=0;this.V=!1;this.U=16E3;a.$&&(this.U=a.$);this.B=this.s=0;this.o=null;this.H=function(b,d){if(this.V){this.m&&(this.I=this.m,this.m=0);if(b){if(b>=this.g())throw console.log("offset:"+b+",size:"+this.g()),Error("offset can not be bigger than input size.");this.h=b}else this.h=0;d&&d()}else this.K.I(this.F,function(e,f){this.V=!0;if(e){this.size=e.T;this.url=e.l;this.name=e.u;this.B="1"==e.R?1:0;if(b){if(b>=
this.g())throw Error("offset can not be bigger than input size.");this.h=b}d&&d()}else throw Error(f.S+" ("+f.W+")");}.bind(this))};this.A=function(){return this.h};this.g=function(){return this.size};this.C=function(){return this.h>=this.g()};this.j=function(b){b||(b=this.U);this.M(b)};this.O=function(){};this.M=function(b){if(!b||!this.m){if(b)this.m=b;else if(this.m)b=this.m;else throw Error("size must be specified.");if(!this.I){var d=this.h+b-1,e=function(){var f=new XMLHttpRequest;10<=this.s?
(f.open("GET",xa(this.K),!0),f.setRequestHeader("Zb-Url",this.url)):f.open("GET",this.url,!0);this.K.ta(f,this.F.J);f.setRequestHeader("Range","bytes="+this.h+"-"+d);f.responseType="arraybuffer";f.onload=function(g){if(this.I)this.I=0,this.m&&this.M();else if(this.m=0,g=g.target,4==g.readyState)if(this.s=10>this.s?1:11,200==g.status||206==g.status){2==this.B&&(this.B=1);var k=parseInt(g.getResponseHeader("content-length"),10);k?this.h+=k:this.h=(k=ma(g.getResponseHeader("content-range")))?k+1:d+1;
200==g.status&&this.h<this.g()?this.h=this.g():this.h>this.g()&&(this.h=this.g());this.o&&this.o(g.response,this);g.response=null}else if(401==g.status&&1==this.B)console.log("Retry auth."),this.B=2,this.K.H(function(l){l?console.error(l):(this.F.J&&delete this.F.J,e())}.bind(this));else throw Error(g.responseText+" ("+g.status+")");}.bind(this);f.onerror=function(){if(0==this.s&&xa(this.K))this.s=10,e();else if(1==this.s||11==this.s)this.s++,setTimeout(function(){e()},500)}.bind(this);f.send()}.bind(this);
e()}}}};Ia("onedrive","Microsoft OneDrive",function(a,c){this.super(a,c);this.m=function(){return"onedrive"};this.V=function(b){H(this,"/me/drive",b,function(d){b&&b.i&&(d=JSON.parse(d).quota,b.i(!1,{Pa:d.deleted,Oa:d.total,wa:d.used}))})};this.o=function(b){var d="/me/drive/root/children";if(b){if(b.Z){var e=function(f){var g={ca:"",i:function(k,l){if(b&&b.i)k?b.i(k):(k=[],l&&k.push(l),b.i(!1,k));else if(k)throw Error(JSON.stringify(k));}};Ga(b,g);this.j(g,f)}.bind(this);b.D?(d={ca:b.D,i:function(f,g){if(f)if(b&&
b.i)b.i(f);else throw Error(JSON.stringify(f));else e(g.gb.concat("/").concat(g.u).concat("/").concat(b.Z))}},Ga(b,d),this.j(d)):e("/drive/root:/".concat(b.Z));return}b.D&&(d="/me/drive/items/"+b.D+"/children")}H(this,d.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),b,function(f){if(b&&b.i){var g=[];f&&JSON.parse(f).value.forEach(function(k){g.push(this.fa(k))},this);b.i(!1,g)}}.bind(this))};this.s=function(b){this.j(b)};this.C=function(b){if(!b||!b.N)throw Error("Name of new folder is not specified.");
var d="/me/drive/root/children";b.D&&(d="/me/drive/items/"+b.D+"/children");var e=JSON.stringify({name:b.N,folder:{},"@microsoft.graph.conflictBehavior":"fail"});G(this,d,"POST",201,b,{"Content-Type":"application/json;charset=UTF-8"},e,function(f){b&&b.i&&(f=this.fa(JSON.parse(f.S)),b.i(!1,f))}.bind(this))};this.delete=function(b){var d="/me/drive/items/".concat(b.G);G(this,d,"DELETE",204,b,null,null,function(){b&&b.i&&b.i(!1)})};this.O=function(b,d,e){d={aa:"/me",Fa:"POST",J:b.J,ua:{"Content-Type":"application/json;charset=UTF-8",
"Cache-Control":"no-cache",Pragma:"no-cache"},i:function(f){f=Fa(f);var g="";200<=f.W&&299>=f.W&&(g=JSON.parse(f.S).uploadUrl);e(g,f)}.bind(this)};d.aa=b.Y?"/me/drive/items/"+b.Y+":/":d.aa+"/drive/root:/";d.aa+=b.ea;d.aa+=":/createUploadSession";d.Ka=JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"replace",name:b.ea}});ya(this,d)};this.ga=function(b){if(0<=[200,201].indexOf(b.status))return Ja;if(0>[202].indexOf(b.status))return Ka;if((b=JSON.parse(b.responseText).nextExpectedRanges)&&
b.length){var d=b[0].indexOf("-");if(0<d)return parseInt(b[0].substring(0,d),10)}return La};this.da=function(b,d){var e=new XMLHttpRequest;e.open("DELETE",b,!0);e.onload=function(f){f=f.target;if(4==f.readyState){var g={W:f.status,S:f.responseText};200<=f.status&&299>=f.status?d&&d(!1,g):(console.log(f.responseText+" ("+f.status+")"),d&&d(g))}}.bind(this);e.send()};this.I=function(b,d){var e="/me/drive/items/".concat(b.l),f={i:function(g,k){var l=null;k&&!g&&(k=JSON.parse(k),l={l:k["@microsoft.graph.downloadUrl"],
u:k.name,T:k.size});d(l,g)}};b.J&&(f.J=b.J);H(this,e.concat(x({select:"name,size,@microsoft.graph.downloadUrl"},!0)),f,function(g){f.i(!1,g)})};this.B=function(){return"https://graph.microsoft.com/v1.0"};this.M=function(b){if(!b||!b.G)throw Error("fid is not specified.");var d="/me/drive/items/".concat(b.G),e={};b.ba&&(e.name=b.ba);b.D&&(e.parentReference={id:b.D});e=JSON.stringify(e);if("{}"==e)throw Error("No property to be updated.");G(this,d,"PATCH",200,b,{"Content-Type":"application/json;charset=UTF-8"},
e,function(){b&&b.i&&b.i(!1)})};this.j=function(b,d){var e="";e=d?d.startsWith("/me")?d:"/me".concat(d):"/me/drive/items/"+b.ca;G(this,e.concat(x({select:"id,name,parentReference,lastModifiedDateTime,size,folder,file"},!0)),"GET",0,b,null,null,function(f){if(b&&b.i)200==f.W?(f=this.fa(JSON.parse(f.S)),b.i(!1,f)):404==f.W&&d?b.i(!1):b.i(f);else if(200!=f.W)throw Error(JSON.stringify(f));}.bind(this))};this.fa=function(b){var d={l:b.id,u:b.name,T:b.size,va:b.lastModifiedDateTime,gb:b.parentReference.path,
L:b.parentReference.id,R:"0"};b.folder?d.R="1":b.file&&(d.R="2");return d}});Ia("googledrive","Google Drive",function(a,c){this.super(a,c);this.m=function(){return"googledrive"};this.V=function(b){var d=this.j("/about").concat(x({fields:"storageQuota"}));H(this,d,b,function(e){b&&b.i&&(e=JSON.parse(e).storageQuota,b.i(!1,{Pa:e.usageInDriveTrash,Oa:e.limit,wa:e.usage}))})};this.o=function(b){var d=this.j("/files"),e="'"+(b.D?b.D:"root")+"' in parents";b.Z&&(e=e.concat(" and name = '"+b.Z+"'"));H(this,d.concat(x({fields:"files(id,name,mimeType,parents,modifiedTime,size)",q:e},
!0)),b,function(f){if(b&&b.i){var g=[];JSON.parse(f).files.forEach(function(k){g.push(this.fa(k))},this);b.i(!1,g)}}.bind(this))};this.s=function(b){var d=this.j("/files/").concat(b.ca);H(this,d.concat(x({fields:"id,name,mimeType,parents,modifiedTime,size"},!0)),b,function(e){b&&b.i&&(e=this.fa(JSON.parse(e)),b.i(!1,e))}.bind(this))};this.C=function(b){if(!b||!b.N)throw Error("Name of new folder is not specified.");var d=this.j("/files");G(this,d,"POST",200,b,{"Content-Type":"application/json;charset=UTF-8"},
JSON.stringify({mimeType:"application/vnd.google-apps.folder",name:b.N,parents:[b.D?b.D:"root"]}),function(e){b&&b.i&&(e=this.fa(JSON.parse(e.S)),b.i(!1,e))}.bind(this))};this.delete=function(b){var d=this.j("/files/").concat(b.G);G(this,d,"DELETE",204,b,null,null,function(){b&&b.i&&b.i(!1)})};this.O=function(b,d,e){var f=function(k){var l={},m="POST",n="/files?uploadType=resumable";k?(m="PATCH",n="/files/"+k+"?uploadType=resumable"):(l.name=b.ea,b.Y&&(l.parents=[b.Y]));k={aa:"/upload".concat(this.j(n)),
Fa:m,J:b.J,ua:{"X-Upload-Content-Length":d,"X-Upload-Content-Type":"application/octet-stream","Content-Type":"application/json; charset=UTF-8"},Ka:JSON.stringify(l),i:function(p){var z=Fa(p),A="";200<=z.W&&299>=z.W&&(A=p.getResponseHeader("location"));e(A,z)}.bind(this)};ya(this,k)}.bind(this),g={i:function(k,l){k?e("",k):0<l.length?f(l[0].l):f()},Z:b.ea,J:b.J};b.Y&&(g.D=b.Y);this.o(g)};this.ga=function(b){if(0<=[200,201].indexOf(b.status))return Ja;if(0>[308].indexOf(b.status))return Ka;if(b=b.getResponseHeader("range")){var d=
b.indexOf("-");if(0<d)return parseInt(b.slice(d+1),10)+1}return La};this.I=function(b,d){var e=this.j("/files/").concat(b.l),f={ca:b.l,i:function(g,k){var l=null;k&&!g&&(l=k,l.l=this.B().concat(encodeURI(e)).concat(x({alt:"media"})),this.g.o&&(l.R="1"));d(l,g)}.bind(this)};b.J&&(f.J=b.J);this.s(f)};this.ta=function(b,d){d?b.setRequestHeader("Authorization",d):b.setRequestHeader("Authorization",this.h?this.h:"")};this.B=function(){return"https://www.googleapis.com"};this.M=function(b){var d=!0,e=this.j("/files/").concat(b.G);
b.Na&&b.D&&(e=e.concat(x({addParents:b.D,removeParents:b.Na})),d=!1);var f={};b.ba&&(f.name=b.ba,d=!1);if(d)throw Error("No property to be updated.");G(this,e,"PATCH",200,b,{"Content-Type":"application/json;charset=UTF-8"},JSON.stringify(f),function(){b&&b.i&&b.i(!1)})};this.j=function(b){return"/drive/v3".concat(b)};this.fa=function(b){var d={l:b.id,u:b.name,T:b.size,va:b.modifiedTime,R:"2"};b.parents&&0<b.parents.length&&(d.L=b.parents[0]);this.F(b.mimeType)&&(d.R="1");return d};this.F=function(b){return"application/vnd.google-apps.folder"==
b}});function Ma(a,c){this.K=c;this.M=a;this.h=null;this.m=this.size=0;this.s=null;this.F=this.B=0;this.I=1600;a.$&&(this.I=a.$);this.o=null;this.H=function(b,d){this.K.I(this.M,function(e,f){if(e)this.size=e.T,this.K.Ca(this.M.l,function(g){this.h=g;this.h.sort(function(k,l){return k.ka-l.ka});this.V(b);d&&d()}.bind(this));else throw Error(f.S+" ("+f.W+")");}.bind(this))};this.A=function(){return this.m};this.g=function(){return this.size};this.C=function(){return this.h?this.B>=this.h.length:!0};this.j=
function(b){this.s?this.U(b):this.K.Ba(this.h[this.B].l,function(d){d=CryptoJS.enc.Base64url.parse(d);this.s=oa(d);this.U(b)}.bind(this))};this.O=function(){this.s=this.h=null};this.V=function(b){if(b){if(b>=this.g())throw Error("offset can not be bigger than input size.");this.m=b;var d=0;for(b=0;b<this.h.length&&!(d+=this.h[b].T,this.m<d);b++)this.F=d;if(b<this.h.length)this.B=b;else throw Error("offset can not be bigger than input size.");}else this.B=this.F=this.m=0;this.s=null};this.U=function(b){var d=
this.m-this.F,e=this.s.length-d;b?b<e&&(e=b):this.I<e&&(e=this.I);b=new Uint8Array(this.s.slice(d,d+e));this.m+=e;this.s.length==d+e&&(this.s=null,this.B++,this.F=this.m);this.o&&this.o(b.buffer,this)}}
function Na(a,c){this.K=c;this.g=a;this.data={l:"",u:"",T:0,L:"",R:"2"};this.o=this.h=0;this.j=function(b,d){this.h=b;this.data.u=this.g.ea;this.g.Y&&(this.data.L=this.g.Y);this.K.O(this.g,b,function(e,f){if(e)this.data.l=e,d&&d(f);else throw console.error(f),Error(JSON.stringify(f));}.bind(this))};this.write=function(b,d){var e=null;e=Array.isArray(b)?new CryptoJS.lib.WordArray.init(new Uint8Array(b)):new CryptoJS.lib.WordArray.init(b);this.data.T+=e.sigBytes;b=e.toString(CryptoJS.enc.Base64url);
this.o++;this.K.saveData(this.data.l,this.o,e.sigBytes,b,function(){this.data.T>=this.h?this.K.sa(this.data,d):d&&d()}.bind(this))};this.cancel=function(b){this.K.delete({G:this.data.l,i:function(d){b&&b(d)}})};this.C=function(){return this.h}}
Ia("idxdb","Loacal Indexed DB",function(a,c){this.super(a,c);this.m=function(){return"idxdb"};this.H=function(b){this.Aa(b)};this.ha=function(){location.reload()};this.V=function(b){var d={Pa:0,Oa:0,wa:0};this.j(function(e){e.getAll().onsuccess=function(f){f.target.result.forEach(function(g){"2"==g.type&&(d.wa+=parseInt(g.size,10))})}},function(){b&&b.i&&b.i(!1,d)})};this.o=function(b){b&&b.i&&this.pa(b.i,void 0,b.D,b.Z)};this.s=function(b){b&&b.i&&this.pa(function(d,e){e&&0<e.length?b.i(d,e[0]):
b.i(d)},b.ca)};this.C=function(b){if(!b||!b.N)throw Error("Name of new folder is not specified.");var d={l:"",u:b.N,T:0,L:"",R:"1"};b.D&&(d.L=b.D);this.ra(d.L,function(e){d.l=e;this.sa(d,function(){b.i&&b.i(!1,d)})}.bind(this))};this.delete=function(b){function d(l){var m=[];g.forEach(function(n){n.Ma&&"2"==n.R&&m.push(n.l)});0>m.indexOf(b.G)&&m.push(b.G);l.getAllKeys().onsuccess=function(n){n.target.result.forEach(function(p){var z=p.indexOf(":");0<=m.indexOf(p.substring(0,z))&&(l.delete(p),k+=parseInt(p.substring(p.indexOf("_",
z+1)+1),10))})}}function e(l){g.forEach(function(m){m.Ma&&l.delete(m.l)})}function f(l){var m;for(m=0;m<g.length;m++)g[m].l==l?g[m].Ma=!0:g[m].L==l&&("1"==g[m].R?f(g[m].l):g[m].Ma=!0)}var g=[],k=0;this.j(function(l){l.getAll().onsuccess=function(m){m.target.result.forEach(function(n){g.push({l:n.key,u:"",L:n.pid})})}},function(){f(b.G);this.j(e,function(){this.F(d,function(){b&&b.i&&b.i(!1,k)})}.bind(this))}.bind(this))};this.U=function(b){return new Na(b,this)};this.O=function(b,d,e){e&&(d="",b.Y&&
(d=b.Y),this.ra(d,function(f){e(f,{W:200,S:"nothing"})}))};this.ga=function(){return La};this.da=function(){};this.A=function(b){return new Ma(b,this)};this.I=function(b,d){this.s({ca:b.l,i:function(e,f){d(f,e)}})};this.B=function(){return""};this.M=function(b){if(!b||!b.G)throw Error("fid is not specified.");this.j(function(d){d.get(b.G).onsuccess=function(e){if(e=e.target.result){var f=!1;b.ba&&e.name!=b.ba&&(e.name=b.ba,f=!0);b.D&&e.pid!=b.D&&(e.pid=b.D,f=!0);f&&d.put(e)}}},function(){b&&b.i&&
b.i(!1)})};this.sa=function(b,d){b.va=this.Ja();var e={key:b.l,name:b.u,size:b.T,tms:b.va,type:b.R};b.L&&(e.pid=b.L);this.j(function(f){f.put(e)},d)};this.saveData=function(b,d,e,f,g){this.F(function(k){k.put({key:b+":"+d+"_"+e,data:f})},g)};this.Ca=function(b,d){var e=[];this.F(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf(":");if(k.substring(0,l)==b){var m=k.substring(l+1);l=m.indexOf("_");e.push({l:k,ka:parseInt(m.substring(0,l),10),T:parseInt(m.substring(l+
1),10)})}})}},function(){d&&d(e)})};this.Ba=function(b,d){if(d){var e="";this.F(function(f){f.get(b).onsuccess=function(g){e=g.target.result.data}},function(){d(e)})}};this.Aa=function(b){if(window.indexedDB){var d=window.indexedDB.open("zgalocaldb");d.onerror=function(){if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");}.bind(this);d.onupgradeneeded=function(e){e=e.target.result;e.createObjectStore("items",{keyPath:"key"});
e.createObjectStore("datas",{keyPath:"key"})}.bind(this);d.onsuccess=function(e){e.target.result.close();b&&b()}.bind(this)}else if(b)b("IndexedDB is not supported in your browser settings.");else throw Error("IndexedDB is not supported in your browser settings.");};this.j=function(b,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("items","readwrite");e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("items");b&&b(e)}.bind(this)};
this.F=function(b,d){window.indexedDB.open("zgalocaldb").onsuccess=function(e){var f=e.target.result;e=f.transaction("datas","readwrite");e.oncomplete=function(){f.close();d&&d()}.bind(this);e=e.objectStore("datas");b&&b(e)}.bind(this)};this.pa=function(b,d,e,f){if(b){var g=[];this.j(function(k){k.getAll().onsuccess=function(l){l.target.result.forEach(function(m){var n=!0;d&&(n=d==m.key);n&&e&&(n=e==m.pid);n&&f&&(n=f==m.name);n&&g.push({l:m.key,u:m.name,T:m.size,va:m.tms,R:m.type,L:m.pid})})}},function(){b(!1,
g)})}};this.Ja=function(){var b;b||(b=new Date);var d=[],e=[];d.push(b.getFullYear());d.push(b.getMonth()+1);d.push(b.getDate());e.push("0".concat(b.getHours()).slice(-2));e.push("0".concat(b.getMinutes()).slice(-2));e.push("0".concat(b.getSeconds()).slice(-2));return d.join("-")+" "+e.join(":")};this.ra=function(b,d){var e=-1;this.j(function(f){f.getAllKeys().onsuccess=function(g){g.target.result.forEach(function(k){var l=k.indexOf("_");b&&0<l?k.substring(l+1)==b&&(l=parseInt(k.substring(0,l),10),
l>e&&(e=l)):!b&&0>l&&(l=parseInt(k,10),l>e&&(e=l))})}},function(){e++;b?d(e+"_"+b):d(e.toString())})}});function Oa(a,c){var b=I;this.h=this.g=null;this.B=b;this.j=1;this.C=a;this.m=c;this.o=0;this.s=function(){this.m({type:0,wtype:this.j,size:this.g.g()});var d=new ra({La:1==this.j,la:this.B,ma:this.g,Qa:this.h});d.H=function(){var e={type:1,wtype:this.j,begin:this.o,spd:d.O(),posn:this.g.A(),size:this.g.g()};this.m(e);return this.C()?!1:!0}.bind(this);d.m=function(e,f){var g={type:2,wtype:this.j,begin:this.o,posn:this.g.A(),size:this.h.C()};e?g.errr=e.message||e.lb:f?g.type=3:this.h.A&&(g.blob=this.h.A());
this.m(g)}.bind(this);this.o=Date.now();d.start()};this.A=function(d){var e=F;this.j=1;this.g=e.A({l:d,$:16E5});this.h=new pa;this.s()};this.H=function(d,e,f){var g=F;this.j=2;this.g=new qa({Da:e,$:16E5});this.h=g.U({ea:d,Y:f});this.s()}};var J=null,F=null,K=[],L=0,I=null,M=[],N=0,O=[];function P(a,c){N&&(window.clearTimeout(N),N=0);var b=q("#divMessage");if(0==a)b.style.display||(b.style.opacity="0",N=window.setTimeout(function(){N=0;u(b)},150));else{var d=h("span",b);1==a?(b.className="zb-notice",d[0].innerText="Notice"):(b.className="zb-alert",d[0].innerText="Error");d[1].innerText=c?c:"";b.style.opacity&&(t(b),N=window.setTimeout(function(){N=0;b.style.opacity=""},50))}}
function Q(a){var c="";"string"===typeof a?window.msgs&&a&&window.msgs[a]?c=window.msgs[a]:c=a:a&&(c=JSON.stringify(a));P(2,c)}function R(a){var c=a;window.msgs&&a&&window.msgs[a]&&(c=window.msgs[a]);P(1,c)}function Pa(a){R(a);N=setTimeout(function(){N=0;P(0)},3E3)}
function Qa(a,c){function b(e){Ra--;"error"==e.type&&(Qa.Xa=!0);if(0==Ra){var f=Qa.Xa;delete Qa.Xa;c&&c(f)}e=e.target||e.srcElement;e.hasAttribute("temporary")&&e.remove()}Ra++;var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",a);d.setAttribute("temporary","1");d.addEventListener("load",b);d.addEventListener("error",b);document.body.appendChild(d)}var Ra=0;
function Sa(a){J.U()&&(q("#chkSaveKey").checked?Ta(function(c){var b="";c&&c.lsauth&&(b=na(!0,a,c.lsauth).toString(CryptoJS.enc.Base64url));J.B("key_words",b,!0)}):J.B("key_words",null,!0))}function Ua(){J.qa(function(){F.ha()})}
function Ta(a){var c=new FormData;c.append("drive_type","localstorage");var b=new XMLHttpRequest;b.open("POST","https://zgayard.f5.si/grantauth.php",!0);b.withCredentials=!0;b.onload=function(d){var e=d.target;4==e.readyState&&(d=null,200==e.status?(e=JSON.parse(e.responseText))?e.error?Q("["+e.error+"] "+e.error_description):e.lsauth?d=e:Q("lsFailed"):Q("lsFailed"):Q(e.responseText+" ("+e.status+")"),a&&a(d))};b.send(c)}
function Va(a){var c=q("#divSet"),b=q("#selDrive"),d=q("btnLogout",c,"button.iid");a?(b.disabled=!0,t(d),u(".zb-nav-tools"),u("#divMain")):(b.disabled=!1,u(d));t(c)}
function Wa(a){if(!window.msgs||window.msgs.lang!=a){var c=window.msgs;window.msgs=null;Qa("msg/"+a+".js",function(){window.msgs?(window.msgs.lang=a,J.V(a),Xa()):(console.log("Message file of '"+a+"' is missing."),c?window.msgs=c:Qa("msg/en.js",function(){window.msgs?(window.msgs.lang="en",J.V(window.msgs.lang),Xa()):Q("Message file is missing.")}))})}}
function Xa(){var a=window.msgs;a.lblConfNotice=a.lblConfNotice.replace("{0}","_zgayard_.conf");var c=h("*"),b;for(b=0;b<c.length;b++){var d=c[b],e=null;d.hasAttribute("iid")&&(e=a[d.getAttribute("iid")])&&(d.innerText=e);!e&&d.hasAttribute("vid")&&(e=a[d.getAttribute("vid")])&&(d.value=e);!e&&d.id&&(e=a[d.id]);e&&("button"==d.type?d.value=e:d.innerText=e);d.hasAttribute("tid")&&(e=a[d.getAttribute("tid")])&&(d.title=e)}c=q("#seLang");b="";for(b in aa)d=document.createElement("option"),d.value=b,
d.innerText=aa[b],b==a.lang&&(d.selected=!0),c.appendChild(d)}function Ya(a){R("loading");var c=va[a];c?(F=new c.g(J,"https://zgayard.f5.si/grantauth.php"),F.H(function(b){if(b)J.qa(function(){Q(window.msgs.loginFailed.replace("{0}",b))});else{J.Aa();var d=q("img",r("div",q("#spanQuota")));d.src="img/"+a+".png";d.alt=c.u;F.o({i:function(e,f){e?Q(JSON.stringify(e)):0==f.length?S(!0):Za(f[0].l)},Z:"_zgayard_.conf"})}},!0)):Q("unkDrive")}
function $a(){if(q("#chkAgreeTos").checked){var a="",c="";if(q("#chkOwnSecret").checked&&(a=q("#txtClientId").value,c=q("#txtClientSecret").value,!a||!c)){Q("noClientIdS");return}var b=q("#selDrive"),d=!1;b.disabled||(d=J.Ba(b.value));var e=null;q("#chkOwnSecret").checked&&(e={Ea:a,ia:c});J.O(e);J.Ca(q("#chkSkipLogin").checked);J.ha(q("#txtRelay").value);Wa(q("#seLang").value);d?(J.M(),Ya(b.value)):J.Aa();ab()}else Q("noAgreeTos")}
function ab(){var a=q("#selDrive");u("#divSet");a.disabled&&(t(".zb-nav-tools"),t("#divMain"))}function bb(a,c){var b=q("#divPwd"),d=!1;a?(b.setAttribute("addroot","1"),d=!0):b.removeAttribute("addroot");a=h("*",b);for(b=0;b<a.length;b++){var e=a[b];e.classList.contains("addroot")?d?t(e):u(e):e.classList.contains("firstep")?d&&c?t(e):u(e):e.classList.contains("chgroot")&&(d?u(e):t(e));"password"==e.type&&(e.value="")}cb()}
function db(){if(window.confirm(window.msgs.delConfirm)){R("deleting");var a=q("#selRoot"),c=a.value,b=-1;K.forEach(function(f,g){f.root==c&&(b=g)});var d=function(){if(b==L)window.location.reload();else{var f=h("option",a),g;for(g=0;g<f.length;g++){var k=f[g];if(k.value==c){a.removeChild(k);break}}Pa("delrootDone")}};if(0<=b){var e=function(f){F.delete({i:function(g){g?Q(g.S):(K.splice(b,1),eb(d))},G:f})};F.o({i:function(f,g){f?console.error(f):0==g.length?(K.splice(b,1),eb(d)):e(g[0].l)},Z:K[b].root})}else d()}}
function S(a){a?"boolean"===typeof a?bb(!0,!0):(bb(),u(".zb-nav-tools"),u("#divMain")):bb();t("#divPwd");P(0)}function fb(a){u("#divPwd");a&&0<M.length&&(t(".zb-nav-tools"),t("#divMain"))}function gb(){var a=v(r("div")),c=a.children[0].cloneNode(!0);c.value="";a.appendChild(c)}function cb(){var a=q("#divfKey");a=h("file",a,"input.type");var c;for(c=a.length-1;0<c;c--)a[c].remove();a[0].value=""}
function hb(){R("loading");var a=q("#divPwd").hasAttribute("addroot"),c=q("#pwdKey").value,b=h("input",q("#divfKey")),d=[],e=0,f=0;for(e=0;e<b.length;e++){var g=b[e].files;for(f=0;f<g.length;f++)d.push(g[f])}if(c||0<d.length){if(a){b=q("#pwdKeyRe").value;if((c||b)&&c!=b){Q("diffPwd");return}if(!q("#txtRoot").value){Q("noRoot");return}}var k=null;c&&(k=CryptoJS.enc.Utf8.parse(c));if(0<d.length){var l=new FileReader,m=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA512,"zb12");e=0;l.g=function(){l.readAsArrayBuffer(d[e].slice(0,
1023));e++};l.onload=function(n){m.update(new CryptoJS.lib.WordArray.init(n.target.result));e<d.length?l.g():(k?k.concat(m.finalize()):k=m.finalize(),k.clamp(),ib(k,a))};l.g()}else ib(k,a)}else Q("noPwd")}
function ib(a,c){var b=CryptoJS.HmacMD5(a,"zgayard").toString(CryptoJS.enc.Base64url).slice(0,8),d=null;if(c){var e={root:q("#txtRoot").value};q("#chkEncryFname").checked&&(e.encfname=!0);var f=!1;K.forEach(function(l){l.root==e.root&&(f=!0)});f?Q("dupRoot"):(J.B("root",e.root),Sa(a),d=CryptoJS.lib.WordArray.random(1024),I=C(d),e.iv=b.concat(jb(!0,d,a)),L=K.length,K.push(e),kb(e,!0),eb())}else{var g=q("#selRoot").value,k=-1;K.forEach(function(l,m){l.root==g&&(k=m)});0<=k&&K[k].iv&&b==K[k].iv.slice(0,
b.length)?(L=k,J.B("root",g),Sa(a),d=jb(!1,K[L].iv.slice(b.length),a),I=C(d),lb()):fa(q("#divPwd"))?Q("pwdError"):S()}}function jb(a,c,b){b=C(b);var d=null;a?d=c:d=CryptoJS.enc.Base64url.parse(c);c=na(a,d,b);return a?c.toString(CryptoJS.enc.Base64url):c}function eb(a){var c=CryptoJS.enc.Utf8.parse(JSON.stringify(K));c=new Blob([new Uint8Array(oa(c))],{type:"application/octet-binary"});c=new qa({Da:c,$:262144});var b=F.U({ea:"_zgayard_.conf"});ta(c,b,a||lb)}
function Za(a){var c=new pa;ta(F.A({l:a}),c,function(){var b=new CryptoJS.lib.WordArray.init(c.s());b=JSON.parse(b.toString(CryptoJS.enc.Utf8));Array.isArray(b)?K=b:K.push(b);var d=-1,e=J.C("root"),f=q("#selRoot");f.innerHTML="";K.forEach(function(k,l){var m=!1;e&&k.root==e&&(m=!0);kb(k,m,f);m&&(d=l)});if(0<=d){L=d;var g=J.C("key_words");g?Ta(function(k){k&&k.lsauth&&!k.newkey?(k=na(!1,CryptoJS.enc.Base64url.parse(g),k.lsauth),ib(k)):S()}):S()}else L=0,S()})}
function kb(a,c,b){b=b||q("#selRoot");var d=document.createElement("option");d.value=a.root;d.innerText=a.root;c&&(d.selected=!0);b.appendChild(d)}function mb(){window.confirm(window.msgs.dropConfirm)&&J.$a(function(a){a?Q(a):F.ha()})};var nb=3;function ob(a,c){switch(a){case "new":var b="spanNew";break;case "upload":b="spanUpload";break;case "selfldr":b="spanSelFldr";break;default:return}var d=q("#divModal"),e=q("#spanModal");e.innerText=window.msgs[b];b=h("div",v(e));var f;for(f=0;f<b.length;f++)e=b[f],e.hasAttribute("type")&&(e.getAttribute("type")==a?t(e):u(e));c&&(d.h=c);t(d)}function pb(a){if(a=r("zb-modal",q(a),"div.class"))a.h&&(a.h(),delete a.h),u(a)}
function qb(a){function c(g){g&&pb(a)}var b="",d=h("div",v(q("#spanModal"))),e=0;for(e=0;e<d.length;e++){var f=d[e];if(f.hasAttribute("type")&&fa(f)){b=f.getAttribute("type");break}}switch(b){case "new":sb(c);break;case "upload":b=[];d=q("#upfiles").files;for(e=0;e<d.length;e++)b.push(d[e]);d=q("#upfolder").files;for(e=0;e<d.length;e++)b.push(d[e]);0>=b.length?Q("noFiles"):(c(!0),tb(b));break;case "selfldr":ub(c)}}function vb(a){return q(".zb-main-header",a).children[0]}
function wb(a){return q("zb-main-list",a,"ul.class")}function xb(a){return q("fnm",a,"span.name")}function yb(a){if(K[L].encfname){var c=I;a=CryptoJS.enc.Utf8.parse(a);c=na(!0,a,c).toString(CryptoJS.enc.Base64url)}else c=a;return c}function zb(a){if(K[L].encfname)try{var c=I,b=CryptoJS.enc.Base64url.parse(a);return na(!1,b,c).toString(CryptoJS.enc.Utf8)}catch(d){console.error(d)}return a}
function Ab(){J=new ua;J.bb(function(a){a&&Q("IndexedDB is not supported in your browser settings.");a=J.sa();a||(J.ta(),a=J.sa(!0));if(!a){a=navigator.language;var c=a.indexOf("-");0<c&&(a=a.substring(0,c))}Wa(a);q("#txtRelay").value=J.ga();a=J.Ja();if(c=J.ra())q("#chkOwnSecret").click(),q("#txtClientId").value=c.Ea,q("#txtClientSecret").value=c.ia;c=q("#selDrive");var b=ka(),d;for(d in va){var e=document.createElement("option");e.value=d;e.innerText=va[d].u;a?a==d&&(e.selected=!0):b&&b.state==va[d].l&&
(a=d,e.selected=!0);c.appendChild(e)}J.U()?(J.o&&(q("#chkSkipLogin").checked=!0),J.C("key_words")&&(q("#chkSaveKey").checked=!0)):(u("#divSkipLogin"),u("#divSaveKey"));a?Ya(a):Va()})}
function lb(){[vb("#divMain"),q("ul","#divHistory")].forEach(function(a){var c=h("li",a);for(a=0;a<c.length;a++)c[a].classList.contains("template")||c[a].remove()});Bb(!1);fb();t(".zb-nav-tools");t("#divMain");Cb(function(){var a=K[L].root;F.o({Z:a,i:function(c,b){c?Q(JSON.stringify(c)):b&&0<b.length?(M=[],M.push(b[0]),T(),Db()):F.C({N:a,i:function(d,e){d?Q(JSON.stringify(d)):(M=[],M.push(e),T())}})}})})}
function Eb(a,c){var b=q("#spanQuota");"string"==typeof a&&(a=parseInt(a,10));var d=w(b,"total"),e=w(b,"trash"),f=0;b.hasAttribute("used")&&(f=w(b,"used"));if(c){if(f-=a,b.setAttribute("used",f),0<d){b.setAttribute("trash",e+a);return}}else f+=a,b.setAttribute("used",f);b.innerText=0<d?window.msgs.quotaInfo.replace("{0}",B(d-f-e)):window.msgs.quotaInfoU.replace("{0}",B(f))}
function Cb(a){F.V({i:function(c,b){c?Q(c):(c=q("#spanQuota"),c.setAttribute("total",b.Oa),c.setAttribute("trash",b.Pa),Eb(b.wa),a&&a())}})}function Bb(a){function c(d,e){d=q(d,b,"div.class");e=q("menuHistory",d,e.concat(".iid"));e=r("li",e);a?t(e):u(e)}var b=q("nav");c("zb-nav-tools","span");c("zb-nav-menu","label")}
function Db(){if(O=J.ab()){var a=q("ul","#divHistory"),c=function(b){if(b>=O.length)0<O.length&&Bb(!0);else{var d=O[b];F.s({ca:d.G,i:function(e,f){e||(f.L&&(d.N=f.L),Fb(b,zb(f.u),a),c(b+1))}})}};c(0)}}
function Fb(a,c,b){b||(b=q("ul","#divHistory"));a=O[a];var d=null,e=q(a.N,b,"li.parentId");if(null==e){e=q("template",b,"li.class").cloneNode(!0);e.classList.remove("template");var f=h("span",e),g;for(g=0;g<f.length;g++){var k=f[g];switch(k.getAttribute("name")){case "delete":k.addEventListener("click",Gb);break;case "file":k.addEventListener("click",Hb);d=k;break;case "next":k.addEventListener("click",Ib)}}e.setAttribute("parentId",a.N);b.appendChild(e)}else d=q("file",e,"span.name");d.innerText=
c;a.oa&&(c=d,b=d.innerText.concat(" ["),d=b.concat,a=Math.floor(a.oa),e=Math.floor(a/3600),a-=3600*e,f=Math.floor(a/60),a-=60*f,g=[],0<e?(g.push(e.toString()),g.push("0".concat(f).slice(-2))):g.push(f.toString()),g.push("0".concat(a).slice(-2)),c.innerText=d.call(b,g.join(":")).concat("]"))}
function T(a,c,b,d){var e=0;if(!b){if(0>=M.length)return;e=M.length-1;b=M[e]}var f="#divMain";c&&(f="#divModal");var g=0;g=q(f);f=vb(g);var k=wb(g);R("loading");var l=U(k);for(g=0;g<l.length;g++)k.removeChild(l[g]);(g=ha(f,void 0,!0))&&g.classList.contains("template")&&(g=null);a?g&&g.classList.remove("normal"):(g&&(0!=e||c)&&g.classList.add("normal"),Jb(f,b,e));F.o({i:function(m,n){if(m)Q(m);else{var p=[],z=0;n.forEach(function(D){var W=0,rb=p.length;D.u=zb(D.u);for(V(D)?rb=z++:W=z;W<rb&&!(D.u<p[W].u);)W++;
W<p.length?p.splice(W,0,D):p.push(D)});p.forEach(function(D){c&&!V(D)||Kb(k,D)});if(!c){m=q("#chkAll");var A=r("li",m);q("checkbox",A,"input.type").checked=!1;u(q("chkbox",A,"span.name"));0<n.length?t(m):u(m)}d?d(p):P(0)}},D:b.l})}
function Jb(a,c,b,d){var e=q("template",a,"li.class").cloneNode(!0);q("span",e).innerText=c.u;e.setAttribute("name","folder");e.setAttribute("uid",c.l);e.setAttribute("idx",b);e.addEventListener("click",Lb);e.classList.remove("template");d&&e.classList.add("normal");t(e);a.appendChild(e)}
function Kb(a,c){var b=c.u,d="",e="",f=q("template",a,"li.class").cloneNode(!0);f.classList.remove("template");f.setAttribute("uid",c.l);f.setAttribute("utype",c.R);var g=h("span",f),k;for(k=0;k<g.length;k++){var l=g[k];switch(l.getAttribute("name")){case "fnm":l.innerText=b;l.addEventListener("click",X);break;case "icon":if(V(c))y(l,"folder","#FFD679");else{var m=Mb(b);ba[m]?y(l,"image","#E7FFE7"):ca[m]?y(l,"video","#FFE7F3"):y(l,"file","#FFFFB0")}l.addEventListener("click",Nb);break;case "chkbox":l.addEventListener("click",
Nb);u(l);break;case "edit":l.addEventListener("click",Ob);break;case "size":d||(d=B(c.T));l.innerText=d;break;case "tms":if(!e)if(e=c.va){e=new Date(e);m=[];var n=[];m.push(e.getFullYear());m.push(e.getMonth()+1);m.push(e.getDate());n.push("0".concat(e.getHours()).slice(-2));n.push("0".concat(e.getMinutes()).slice(-2));n.push("0".concat(e.getSeconds()).slice(-2));e=m.join("-")+" "+n.join(":")}else e="";l.innerText=e}}t(f);a.appendChild(f)}
function Pb(a,c){var b=q("checkbox",a,"input.type");1==c?b.checked=!0:-1==c?b.checked=!1:(b.checked=!b.checked,c=b.checked?1:-1);0<c?t(q("chkbox",a,"span.name")):u(q("chkbox",a,"span.name"))}function Nb(){Pb(r("li"))}function X(a,c,b){var d=null,e=!1;"string"!=typeof a&&(d=r("li"),a=d.getAttribute("uid"),e="selfldr"==r("div",d).getAttribute("type"));if(c||!d)d=Qb(a,c,b),a=d.getAttribute("uid");c={l:a,u:xb(d).innerText,R:d.getAttribute("utype")};V(d)?e?T(!1,!0,c):(M.push(c),T()):Rb(c.l,c.u)}
function Lb(){for(var a=r("li"),c=r("ul",a),b="selfldr"==r("div",c).getAttribute("type"),d=0,e=v(a);e;)e.tagName==a.tagName&&d++,e=v(e);if(0<d)for(e=0;e<d;e++)c.removeChild(c.lastElementChild);b?T(!0,!0,{u:q("span",a).innerText,l:a.getAttribute("uid")}):(d=w(a,"idx"),d<M.length-1&&M.splice(d+1),T(!0))}function V(a){return"1"==(a instanceof HTMLElement?a.getAttribute("utype"):"string"==typeof a?a:a.R)}function Mb(a){var c=a.lastIndexOf("."),b="";0<=c&&(b=a.slice(c+1));return b.toLowerCase()}
function Sb(){var a=r("li"),c=q("checkbox",a,"input.type");Pb(a);var b=-1;c.checked&&(b=1);a=h("li",r("ul",a));for(c=0;c<a.length;c++)a[c].classList.contains("header")||a[c].classList.contains("template")||Pb(a[c],b)}
function Ob(a){var c=r("span"),b=c.getBoundingClientRect();c=r("li",c);var d=q("#ulIteMenu");if(d.hasAttribute("ofwid"))var e=parseInt(d.getAttribute("ofwid"),10);else d.style.display="block",e=d.offsetWidth,d.setAttribute("ofwid",e);d.style.left=b.right+e>document.body.offsetWidth?b.left-e+"px":b.right+"px";d.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+b.top+"px";d.setAttribute("uid",c.getAttribute("uid"));d.setAttribute("utype",c.getAttribute("utype"));a.ya=nb}
function Qb(a,c,b){if(!a)return null;var d=wb("#divMain");d=U(d);var e;for(e=0;e<d.length&&d[e].getAttribute("uid")!=a;e++);if(e>=d.length)return null;switch(c){case 1:for(;0<=e;){e--;if(0>e){if(b)return null;b=!0;e=d.length-1}if(!V(d[e]))break}break;case 2:for(;e<d.length;){e++;if(e>=d.length){if(b)return null;b=!0;e=0}if(!V(d[e]))break}}return d[e]}
function Tb(a){var c=r("li"),b=r("ul",c),d=b.getAttribute("uid");if(d)switch(q("label",c).getAttribute("iid")){case "menuDownload":V(b)?Q("noDownFolder"):Ub(d);break;case "menuRename":c=q("#divInpName");b=q("input",c);var e=Qb(d);d=xb(e);var f=d.getBoundingClientRect();e=q("edit",e,"span.name").getBoundingClientRect();b.value=d.innerText;c.style.left=f.left+"px";c.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+f.top-2+"px";b.style.width=e.left-f.left+"px";b.style.height=f.height+
2+"px";t(c);b.focus();a.ya=4;break;case "menuMove":Vb(d);break;case "menuDelete":Wb(d)}}function Ub(a){var c=Qb(a);a={u:xb(c).innerText,l:a};Xb([a])}function Vb(a){var c=void 0,b=q("#divModal");if("string"==typeof a)b.setAttribute("uid",a);else if(Yb())b.removeAttribute("uid"),c=a;else return;a=vb(b);b=U(a);var d;for(d=0;d<b.length;d++)a.removeChild(b[d]);T(!1,!0,M[0]);ob("selfldr",c)}
function Zb(a){if(13===a.keyCode){if(a.shiftKey||a.ctrlKey||a.altKey)return!0}else return 27===a.keyCode?(u(r("div")),!1):!0;$b();return!1}function $b(){var a=r("div"),c=q("input",a);if(c.value){var b=q("#ulIteMenu").getAttribute("uid"),d=Qb(b);if(d){var e=xb(d);c.value!=e.innerText&&(d=yb(c.value),Ba({i:function(f){f?Q(f.S):(e.innerText=c.value,Pa("renDone"))},G:b,ba:d}))}u(a)}else Q("noNewName")}
function ub(a){var c=q("#divModal"),b=vb(c);b=ha(b,"li",!0).getAttribute("uid");if(b==M[M.length-1].l)a&&a(!1);else{a&&a(!0);var d=[];(a=c.getAttribute("uid"))?d.push({l:a,u:""}):d=Yb();if(0!=d.length){R("moving");var e=0,f={i:function(g){g?Q(g.S):(e++,e<d.length?(f.G=d[e].l,Ca(f)):T(!0,!1,void 0,function(){Pa("moveDone")}))},G:d[e].l,D:b,Na:M[M.length-1].l};Ca(f)}}}
function Wb(a){var c=null;a?c=[{l:a,u:""}]:c=Yb();if(c&&confirm(window.msgs.delConfirm)){R("deleting");var b=0,d={i:function(e,f){e?Q(e.S):(f&&Eb(f,!0),b++,b<c.length?(d.G=c[b].l,F.delete(d)):T(!0,!1,void 0,function(){Pa("delDone")}))},G:c[b].l};F.delete(d)}}
function sb(a){var c=q("#fldnm").value;if(c){var b=q("#chkFInto").checked,d={i:function(e,f){e?(Q(e.S),a&&a(!1)):(f.u=c,b?(e=void 0,a&&(e=function(){a(!0);P(0)}),M.push(f),T(!1,!1,void 0,e)):a&&(Kb(wb("#divMain"),f),a(!0),Pa("flDone")))},N:yb(c)};0<M.length&&(d.D=M[M.length-1].l);F.C(d)}else Q("noFldName"),a&&a(!1)}
function Yb(a){var c=[],b=U(wb("#divMain")),d;for(d=0;d<b.length;d++)if(q("checkbox",b[d],"input.type").checked){if(a&&V(b[d]))return Q("noDownFolder"),null;c.push({u:xb(b[d]).innerText,l:b[d].getAttribute("uid")})}return 0>=c.length?(Q("noChecks"),null):c}
function Rb(a,c){var b=q("#diViewer"),d=r("zb-viewer",b,"div.class"),e=q("title",d,"span.name"),f=q("span",b),g=q("img",b),k=ac(b);f.innerText=window.msgs.loading;t(f);u(v(f));u(g);e.innerText=c;g.src="";b.setAttribute("uid",a);t(r("zb-modal",d,"div.class"));b=Mb(c);var l=ba[b];if(ca[b])bc(k,a,c),t(k),u(f);else if(l){var m=new pa;a=new ra({La:!0,la:I,ma:F.A({l:a,$:16E4}),Qa:m});a.m=function(n,p){n||p?console.log(n||p):(n=m.s(),n instanceof Uint8Array||(n=new Uint8Array(n)),l&&(g.src=window.URL.createObjectURL(new Blob([n],
{type:l})),t(g),u(f)))};a.start()}else f.innerText=window.msgs.cantView,t(v(f))}function cc(a){var c=q(a?a:"#diViewer");c=v(c,"div");var b="";if(a){if(c.style.opacity)return;b="1"}for(;c;)c.style.opacity=b,c=v(c,"div");a&&window.setTimeout(cc,5E3)}function dc(){var a=q("#diViewer").getAttribute("uid");a&&X(a,1)}function ec(){var a=q("#diViewer").getAttribute("uid");a&&X(a,2)}function fc(a){ac(q("#diViewer"));pb(a)}function hc(){var a=q();a&&a.src&&window.URL.revokeObjectURL(a.src)}
function bc(a,c,b){const d=zb_require("videostream");a.g=c;a.m=b;a.o=new sa({La:!0,la:I,ma:function(){return F.A({l:c})}});a.j=new d(a.o,a)}function ac(a){a=q("video",a);if(a.g){var c=M[M.length-1].l,b=a.m,d;O||(O=[]);for(d=0;d<O.length;d++)if(O[d].N==c){O[d].G=a.g;O[d].oa=a.currentTime;break}d==O.length&&O.push({G:a.g,N:c,oa:a.currentTime});delete a.g;delete a.m;J.eb(O[d],d);Fb(d,b);Bb(!0)}u(a);a.j&&(a.j.destroy(),a.o.Va(),delete a.j,delete a.o);return a}
function ic(a){if((a=a.getAttribute("parentId"))&&O){var c;for(c=0;c<O.length;c++)if(O[c].N==a)return c}return-1}
function Hb(a,c){q("close","#divHistory","span.name").click();a=q(a);a=r("li",a);a=ic(a);if(!(0>a)){a=O[a];var b=a.G,d=a.N,e=a.oa;R("loading");var f=[],g=function(){d?d==M[0].l?(f.unshift(M[0]),k()):F.s({ca:d,i:function(l,m){l||(m.u=zb(m.u),f.unshift(m),m.L==M[0].L?d=void 0:d=m.L,g())}}):R("cantPlayRecent")},k=function(){var l=vb("#divMain"),m=0,n=h("li",l);for(m=0;m<n.length;m++)n[m].classList.contains("template")||n[m].remove();for(m=0;m<f.length;m++)Jb(l,f[m],m,!0);M=f;T(!0,!1,void 0,function(p){P(0);
var z;for(z=0;z<p.length&&p[z].l!=b;z++);z<p.length&&(c?X(b,2):(e&&q("video","#diViewer").setAttribute("ctime",e),X(b)))})};g()}}function Ib(a){Hb(a,!0)}function jc(a){a=q(a);var c=a.getAttribute("ctime");c&&(a.removeAttribute("ctime"),a.currentTime=c)}function Gb(a){a=q(a);a=r("li",a);var c=ic(a);0>c||(a.remove(),O.splice(c,1),J.cb(c),0==O.length&&Bb(!1))};const kc=window.Worker?!0:!1;var Y=null;function lc(a){this.h=a;this.g=[];this.m=function(c){return this.h.l==c.l};this.s=function(c){return this.h.u==c};this.o=function(c){var b;for(b=0;b<this.g.length;b++)if(this.g[b].s(c))return this.g[b];return null};this.j=function(c){var b;for(b=0;b<this.g.length;b++)if(this.g[b].m(c))return this.g[b];c=new lc(c);this.g.push(c);return c}}var mc=null;
function U(a,c){var b=[],d=a.getElementsByTagName("li");for(a=0;a<d.length;a++){var e=d[a];if(!e.classList.contains("header")&&!e.classList.contains("template"))if(c){var f=c(e);2!=f&&-2!=f||b.push(e);if(0>f)break}else b.push(e)}return b}function nc(a){a=q(a);u(a);Y?(a=r("li",a),a={type:9,rowIdx:w(a,"rowIdx")},Y.postMessage(a)):a.setAttribute("canceled","1")}
function oc(a,c,b){var d=0,e=0;c||(c=q(".zb-qbutton"));!b&&c.hasAttribute("count")&&(b=w(c,"count"));c.hasAttribute("fincount")&&(d=w(c,"fincount"));c.hasAttribute("stopcount")&&(e=w(c,"stopcount"));switch(a){case 1:d++;c.setAttribute("fincount",d);break;case 3:c.setAttribute("haserr","1");case 2:e++,c.setAttribute("stopcount",e)}0<b?q("div",c).style.width=Math.floor(100*d/b)+"%":q("div",c).style.width="0%";b==d+e&&(c.hasAttribute("haserr")?c.classList.add("error"):c.classList.add("done"))}
function pc(a){var c=q(".zb-qbutton"),b=0;c.hasAttribute("count")&&(b=w(c,"count"));b+=a;c.setAttribute("count",b);oc(0,c,b);c.classList.contains("error")&&c.classList.remove("error");c.classList.contains("done")&&c.classList.remove("done");t(c)}
function qc(a){a=r(".zb-queue",q(a));var c=q(".zb-qbutton");a.style.top="100%";if(c.classList.contains("done")||c.classList.contains("error")){u(c);c.removeAttribute("count");c.removeAttribute("fincount");c.removeAttribute("stopcount");c.removeAttribute("haserr");a=q("ul",a);c=U(a);var b;for(b=c.length-1;0<=b;b--)a.removeChild(c[b]);a.removeAttribute("rowCount")}}
function rc(a,c,b){var d=0;a.hasAttribute("rowCount")&&(d=w(a,"rowCount"));var e=q("template",a,"li.class").cloneNode(!0);e.classList.remove("template");e.setAttribute("rowIdx",d);b&&e.setAttribute("downFl",1);a.setAttribute("rowCount",d+1);d=h("span",e);var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "cancel":g.addEventListener("click",nc);break;case "icon":q("label",g).innerText=c;b?y(g,"download"):y(g,"upload");break;case "elTime":ha(g,"label").innerText=window.msgs.elTime;
break;case "esTime":ha(g,"label").innerText=window.msgs.esTime;break;case "speed":g.innerText=window.msgs.waiting}}a.appendChild(e);return e}function sc(a,c){c||(c=q("ul","#divQueue"));c=U(c,function(b){return b.getAttribute("rowIdx")==a?-2:1});return 0<c.length?c[0]:null}function tc(a,c){var b=0;if(1==a)b=1;else if(2!=a)return;a=h("svg",".zb-qbutton")[b];c?a.classList.add("pulse"):a.classList.remove("pulse")}
function uc(a,c){var b=null,d=h("span",a),e="";switch(c.type){case 0:e="0%";tc(c.wtype,!0);break;case 1:e=Math.round(100*c.posn/c.size)+"%";break;case 2:e="100%";case 3:tc(c.wtype)}var f;for(f=0;f<d.length;f++){var g=d[f];switch(g.getAttribute("name")){case "icon":b=g;break;case "percent":switch(c.type){case 0:case 1:g.innerText=e;break;case 2:c.errr||(g.innerText=e)}break;case "elTime":switch(c.type){case 1:case 2:case 3:g.innerText=la(Math.floor((Date.now()-c.begin)/1E3))}break;case "esTime":switch(c.type){case 1:g.innerText=
la(Math.round((c.size-c.posn)/c.spd))}break;case "speed":switch(c.type){case 1:g.innerText=B(c.spd)+"/s";break;case 2:case 3:c.errr||(a.classList.add("done"),g.innerText=window.msgs.avspeed.replace("{0}",B(1E3*c.posn/(Date.now()-c.begin))))}break;case "cancel":switch(c.type){case 0:t(g);break;case 2:case 3:var k=q("svg",g);k.removeChild(k.firstElementChild);c.errr||3==c.type?(y(g,"multi"),oc(c.errr?3:2)):(y(g,"chkbox",void 0,"#10B981"),oc(1));t(g)}break;default:if((k=r("div",g))&&k.classList.contains("zb-progressbar"))switch(c.type){case 0:case 1:g.style.width=
e;break;case 2:c.errr?(a.classList.add("error"),k.innerText=c.errr):g.style.width=e}}}return b}function vc(a,c){c=sc(a.rowIdx,c);wc(c,a)}function wc(a,c){var b=!1;switch(c.type){case 0:case 1:uc(a,c);break;case 2:c.fined&&Y&&xc();a=uc(a,c);c.errr||(2==c.wtype?Eb(c.size):1==c.wtype&&c.blob&&(a=q("label",a).innerText,ia(c.blob,a,q("#lnkDown"))));window.gc&&window.gc();b=!0;break;case 3:c.fined&&Y&&xc(),uc(a,c),window.gc&&window.gc(),b=!0}return b}
function xc(){var a=Y;mc=Y=null;a.terminate();a.g&&T(!0)}function yc(a){Y||(Y=new Worker("worker.js"),Y.h={gtoken:F.h?F.h:"",iv:I.iv.toString(CryptoJS.enc.Base64url),key:I.key.toString(CryptoJS.enc.Base64url),drvid:F.m()},Y.addEventListener("message",function(c){vc(c.data)}));a.cominf=Y.h;2!=a.type||Y.g||(Y.g=!0);Y.postMessage(a)}
function zc(a,c){var b=w(a,"rowIdx"),d=q("cancel",a,"span.name");return new Oa(function(){return d.getAttribute("canceled")?!0:!1},function(e){e.rowIdx=b;wc(a,e)&&c()})}function Xb(a){var c=q("ul","#divQueue"),b=0;pc(a.length);for(b=0;b<a.length;b++){var d=rc(c,a[b].u,!0);kc?yc({type:1,rowIdx:w(d,"rowIdx"),downinf:{targetId:a[b].l}}):a[b].L=d.getAttribute("rowIdx")}if(!kc){var e=function(f){var g=sc(parseInt(a[f].L,10),c);zc(g,function(){f++;f<a.length&&e(f)}).A(a[f].l)};e(0)}}
function tb(a){function c(l){var m=d[l];Ac(k,m.fb,function(n,p,z){n?vc({type:2,wtype:2,rowIdx:m.ka,size:0,errr:JSON.stringify(n)},b):kc?(yc({type:2,rowIdx:m.ka,upinf:{fname:p,file:m.Ta,ptid:z}}),l++,l<d.length&&c(l)):(n=sc(m.ka,b),zc(n,function(){l++;l<a.length?c(l):T(!0)}).H(p,m.Ta,z))})}var b=q("ul","#divQueue"),d=[],e=0;pc(a.length);for(e=0;e<a.length;e++){var f="";f=a[e].webkitRelativePath?a[e].webkitRelativePath:a[e].name;var g=rc(b,f);d.push({fb:f,Ta:a[e],ka:w(g,"rowIdx")})}mc||(mc=new lc(M[0]));
var k=mc;for(e=1;e<M.length;e++)k=k.j(M[e]);c(0)}function Ac(a,c,b){var d=c.split("/"),e=yb(d.pop()),f=a;if(0==d.length)b(!1,e,f.h.l);else{var g=!1,k=function(l){function m(A){f=A;l++;l<d.length?k(l):b(!1,e,f.h.l)}var n=d[l],p=yb(n);if(g)F.C({N:p,D:f.h.l,i:function(A,D){A?b(A,e):(D.u=n,m(f.j(D)))}});else{var z=f.o(n);z?m(z):F.o({Z:p,D:f.h.l,i:function(A,D){A?b(A,e):0==D.length?(g=!0,k(l)):(D[0].u=n,m(f.j(D[0])))}})}};k(0)}};var Z=null;function Bc(a){switch(a){case 1:a=q(".zb-nav-tools");a={X:q("button",a),P:v(a)};break;case 2:a=q("button",q(".zb-main-header","#divMain"));a={X:a,P:v(a)};break;case nb:a={P:q("#ulIteMenu")};break;default:return null}return a}function Cc(a){var c=Bc(a);c&&(c.P.style.display="none",c.P.style.maxHeight="0px",c.X&&c.X.addEventListener("click",function(b){b.ya=a}))}
function Dc(a,c){var b=Bc(c);b&&(b.P.style.display?b.P.style.maxHeight&&a.ya==c&&(t(b.P),b.X&&(u(b.X.children[0]),t(b.X.children[1])),window.setTimeout(function(){b.P.style.maxHeight="";b.P.style.paddingTop="";b.P.style.paddingBottom=""},50)):b.P.style.maxHeight||a.ya==c&&!b.X||(b.P.style.paddingBottom="0px",b.P.style.maxHeight="0px",window.setTimeout(function(){b.X&&(t(b.X.children[0]),u(b.X.children[1]));b.P.style.paddingTop="0px";u(b.P)},500)))}
function Ec(a){Dc(a,1);Dc(a,2);Dc(a,nb);4!=a.ya&&u("#divInpName")}function Fc(a){a=a.target||a.srcElement;"INPUT"!=a.tagName&&(a=q("input",r("div",a)),a.focus(),a.click())}function Gc(a){var c=r("li",a);switch(a.getAttribute("iid")){case "menuGeneral":c.addEventListener("click",Va);break;case "menuDrive":c.addEventListener("click",S);break;case "menuHistory":c.addEventListener("click",function(){q("#divHistory").style.top=""})}}
function Hc(){var a=q("label",r("li")),c=a.getAttribute("iid"),b=void 0;(a=v(a))&&(b=function(){a.classList.remove("rotate-90")});switch(c){case "menuNewFldr":a&&a.classList.add("rotate-90");ob("new",b);break;case "menuUpload":a&&a.classList.add("rotate-90");ob("upload",function(){q("#upfiles").value=null;q("#upfolder").value=null;b&&b()});break;case "menuMovefs":a&&a.classList.add("rotate-90");Vb(b);break;case "menuDownfs":(c=Yb(!0))&&Xb(c);break;case "menuDelfs":Wb()}}
window.addEventListener("load",function(){var a=RegExp("android","i").test(navigator.userAgent),c=q("#divMessage"),b=h("span",c);b[b.length-1].children[0].addEventListener("click",function(){P(0)});document.addEventListener("click",Ec);Cc(1);Cc(2);Cc(nb);var d=0;c=0;b=h("span",q(".zb-nav-tools"));for(d=0;d<b.length;d++)Gc(b[d]);b=h("label",q(".zb-nav-menu"));for(d=0;d<b.length;d++)Gc(b[d]);b=h(".zb-settings");for(d=0;d<b.length;d++){var e=h(".checkbox",b[d]);for(c=0;c<e.length;c++)e[c].addEventListener("click",
Fc)}q("#chkOwnSecret").addEventListener("click",function(f){f=f.target||f.srcElement;var g=h(".ownsecret","#divSet"),k;for(k=0;k<g.length;k++)f.checked?t(g[k]):u(g[k])});c=q("#divSet");b=h("button",c);for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnLogout":c.addEventListener("click",Ua);break;case "btnCancel":c.addEventListener("click",ab);break;case "btnOk":c.addEventListener("click",$a)}b=h("span",q("#divPwd"));for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("tid")){case "spanAddRoot":c.addEventListener("click",
bb);break;case "spanDeleteRoot":c.addEventListener("click",db);break;case "spanMoreKey":a?c.addEventListener("click",gb):c.style.display="none";break;case "spanClearKey":a?c.addEventListener("click",cb):c.style.display="none"}b=h("button",q("#divPwd"));for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",fb);break;case "btnOk":c.addEventListener("click",hb);break;case "btnDropDb":c.addEventListener("click",mb)}c=q("#divModal");c.addEventListener("click",
pb);c.children[0].addEventListener("click",function(f){f.stopPropagation()});b=h("button",c);for(d=0;d<b.length;d++)switch(c=b[d],c.getAttribute("iid")){case "btnCancel":c.addEventListener("click",pb);break;case "btnOk":c.addEventListener("click",qb)}b=h(".zb-main-menu");for(d=0;d<b.length;d++)for(a=h("li",b[d]),c=0;c<a.length;c++)a[c].addEventListener("click",Hc);c=q("#chkAll");c.addEventListener("click",Sb);v(c).addEventListener("click",Sb);b=h("li","#ulIteMenu");for(d=0;d<b.length;d++)b[d].addEventListener("click",
Tb);c=q("#divInpName");c.addEventListener("click",function(f){f.stopPropagation()});q("input",c).addEventListener("keyup",Zb);q("span",c).addEventListener("click",$b);c=q("#diViewer");c.addEventListener("click",cc);c.addEventListener("touchstart",function(f){Z||1!=f.changedTouches.length||(f=f.changedTouches[0],Z={l:f.identifier,ib:f.screenX,jb:f.screenY})});c.addEventListener("touchend",function(f){if(Z){var g=null,k;for(k=0;k<f.changedTouches.length;k++)if(f.changedTouches[k].identifier==Z.l){g=
f.changedTouches[k];break}g&&(f=g.screenX-Z.ib,g=g.screenY-Z.jb,10>g&&-10<g&&(50<f?dc():-50>f&&ec()));Z=null}});q("button",c).addEventListener("click",function(){Ub(r("div").getAttribute("uid"))});q("img",c).addEventListener("load",hc);c=q("video",c);c.addEventListener("canplay",jc);c.addEventListener("ended",function(){X(r("div").getAttribute("uid"),2,!0)});document.addEventListener("fullscreenchange",function(){document.fullscreen?q("#diViewer").classList.add("full"):q("#diViewer").classList.remove("full")});
c=r("zb-viewer",c,"div.class");b=h("span",c);for(d=0;d<b.length;d++)switch(b[d].getAttribute("name")){case "close":b[d].addEventListener("click",fc);break;case "previous":b[d].addEventListener("click",dc);break;case "next":b[d].addEventListener("click",ec);break;case "fullscreen":b[d].addEventListener("click",function(){r("div","#diViewer",void 0,!0).requestFullscreen()})}c=r("zb-modal",c,"div.class");c.addEventListener("click",fc);c.children[0].addEventListener("click",function(f){f.stopPropagation()});
q(".zb-qbutton").addEventListener("click",function(){q("#divQueue").style.top=""});q("close","#divQueue","span.name").addEventListener("click",qc);q("close","#divHistory","span.name").addEventListener("click",function(){q("#divHistory").style.top="100%"});Ab()});
